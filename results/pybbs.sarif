{
  "$schema" : "https://json.schemastore.org/sarif-2.1.0.json",
  "version" : "2.1.0",
  "runs" : [ {
    "tool" : {
      "driver" : {
        "name" : "CodeQL",
        "organization" : "GitHub",
        "semanticVersion" : "2.15.1",
        "notifications" : [ {
          "id" : "java/diagnostics/successfully-extracted-files",
          "name" : "java/diagnostics/successfully-extracted-files",
          "shortDescription" : {
            "text" : "Successfully extracted files"
          },
          "fullDescription" : {
            "text" : "A list of all files in the source code directory that were extracted without encountering an error in the file."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "successfully-extracted-files" ],
            "description" : "A list of all files in the source code directory that\n              were extracted without encountering an error in the file.",
            "id" : "java/diagnostics/successfully-extracted-files",
            "kind" : "diagnostic",
            "name" : "Successfully extracted files"
          }
        }, {
          "id" : "java/diagnostics/extraction-errors",
          "name" : "java/diagnostics/extraction-errors",
          "shortDescription" : {
            "text" : "Extraction errors"
          },
          "fullDescription" : {
            "text" : "A list of extraction errors for files in the source code directory."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "description" : "A list of extraction errors for files in the source code directory.",
            "id" : "java/diagnostics/extraction-errors",
            "kind" : "diagnostic",
            "name" : "Extraction errors"
          }
        }, {
          "id" : "java/diagnostics/extraction-warnings",
          "name" : "java/diagnostics/extraction-warnings",
          "shortDescription" : {
            "text" : "Extraction warnings"
          },
          "fullDescription" : {
            "text" : "A list of extraction warnings for files in the source code directory."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "description" : "A list of extraction warnings for files in the source code directory.",
            "id" : "java/diagnostics/extraction-warnings",
            "kind" : "diagnostic",
            "name" : "Extraction warnings"
          }
        }, {
          "id" : "java/baseline/expected-extracted-files",
          "name" : "java/baseline/expected-extracted-files",
          "shortDescription" : {
            "text" : "Expected extracted files"
          },
          "fullDescription" : {
            "text" : "Files appearing in the source archive that are expected to be extracted."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "expected-extracted-files", "telemetry" ]
          }
        }, {
          "id" : "js/baseline/expected-extracted-files",
          "name" : "js/baseline/expected-extracted-files",
          "shortDescription" : {
            "text" : "Expected extracted files"
          },
          "fullDescription" : {
            "text" : "Files appearing in the source archive that are expected to be extracted."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "expected-extracted-files", "telemetry" ]
          }
        } ],
        "rules" : [ {
          "id" : "java/stack-trace-exposure",
          "name" : "java/stack-trace-exposure",
          "shortDescription" : {
            "text" : "Information exposure through a stack trace"
          },
          "fullDescription" : {
            "text" : "Information from a stack trace propagates to an external user. Stack traces can unintentionally reveal implementation details that are useful to an attacker for developing a subsequent exploit."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-209", "external/cwe/cwe-497" ],
            "description" : "Information from a stack trace propagates to an external user.\n              Stack traces can unintentionally reveal implementation details\n              that are useful to an attacker for developing a subsequent exploit.",
            "id" : "java/stack-trace-exposure",
            "kind" : "problem",
            "name" : "Information exposure through a stack trace",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "5.4"
          }
        }, {
          "id" : "java/insecure-cookie",
          "name" : "java/insecure-cookie",
          "shortDescription" : {
            "text" : "Failure to use secure cookies"
          },
          "fullDescription" : {
            "text" : "Insecure cookies may be sent in cleartext, which makes them vulnerable to interception."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-614" ],
            "description" : "Insecure cookies may be sent in cleartext, which makes them vulnerable to\n              interception.",
            "id" : "java/insecure-cookie",
            "kind" : "problem",
            "name" : "Failure to use secure cookies",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "5.0"
          }
        }, {
          "id" : "java/android/unsafe-content-uri-resolution",
          "name" : "java/android/unsafe-content-uri-resolution",
          "shortDescription" : {
            "text" : "Uncontrolled data used in content resolution"
          },
          "fullDescription" : {
            "text" : "Resolving externally-provided content URIs without validation can allow an attacker to access unexpected resources."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-441", "external/cwe/cwe-610" ],
            "description" : "Resolving externally-provided content URIs without validation can allow an attacker\n              to access unexpected resources.",
            "id" : "java/android/unsafe-content-uri-resolution",
            "kind" : "path-problem",
            "name" : "Uncontrolled data used in content resolution",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/android/implicitly-exported-component",
          "name" : "java/android/implicitly-exported-component",
          "shortDescription" : {
            "text" : "Implicitly exported Android component"
          },
          "fullDescription" : {
            "text" : "Android components with an '<intent-filter>' and no 'android:exported' attribute are implicitly exported, which can allow for improper access to the components themselves and to their data."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-926" ],
            "description" : "Android components with an '<intent-filter>' and no 'android:exported' attribute are implicitly exported, which can allow for improper access to the components themselves and to their data.",
            "id" : "java/android/implicitly-exported-component",
            "kind" : "problem",
            "name" : "Implicitly exported Android component",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "8.2"
          }
        }, {
          "id" : "java/world-writable-file-read",
          "name" : "java/world-writable-file-read",
          "shortDescription" : {
            "text" : "Reading from a world writable file"
          },
          "fullDescription" : {
            "text" : "Reading from a file which is set as world writable is dangerous because the file may be modified or removed by external actors."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-732" ],
            "description" : "Reading from a file which is set as world writable is dangerous because\n              the file may be modified or removed by external actors.",
            "id" : "java/world-writable-file-read",
            "kind" : "problem",
            "name" : "Reading from a world writable file",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "java/improper-intent-verification",
          "name" : "java/improper-intent-verification",
          "shortDescription" : {
            "text" : "Improper verification of intent by broadcast receiver"
          },
          "fullDescription" : {
            "text" : "A broadcast receiver that does not verify intents it receives may be susceptible to unintended behavior by third party applications sending it explicit intents."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-925" ],
            "description" : "A broadcast receiver that does not verify intents it receives may be susceptible to unintended behavior by third party applications sending it explicit intents.",
            "id" : "java/improper-intent-verification",
            "kind" : "problem",
            "name" : "Improper verification of intent by broadcast receiver",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "8.2"
          }
        }, {
          "id" : "java/predictable-seed",
          "name" : "java/predictable-seed",
          "shortDescription" : {
            "text" : "Use of a predictable seed in a secure random number generator"
          },
          "fullDescription" : {
            "text" : "Using a predictable seed in a pseudo-random number generator can lead to predictability of the numbers generated by it."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-335", "external/cwe/cwe-337" ],
            "description" : "Using a predictable seed in a pseudo-random number generator can lead to predictability of the numbers generated by it.",
            "id" : "java/predictable-seed",
            "kind" : "problem",
            "name" : "Use of a predictable seed in a secure random number generator",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/xslt-injection",
          "name" : "java/xslt-injection",
          "shortDescription" : {
            "text" : "XSLT transformation with user-controlled stylesheet"
          },
          "fullDescription" : {
            "text" : "Performing an XSLT transformation with user-controlled stylesheets can lead to information disclosure or execution of arbitrary code."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-074" ],
            "description" : "Performing an XSLT transformation with user-controlled stylesheets can lead to\n              information disclosure or execution of arbitrary code.",
            "id" : "java/xslt-injection",
            "kind" : "path-problem",
            "name" : "XSLT transformation with user-controlled stylesheet",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/jndi-injection",
          "name" : "java/jndi-injection",
          "shortDescription" : {
            "text" : "JNDI lookup with user-controlled name"
          },
          "fullDescription" : {
            "text" : "Performing a JNDI lookup with a user-controlled name can lead to the download of an untrusted object and to execution of arbitrary code."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-074" ],
            "description" : "Performing a JNDI lookup with a user-controlled name can lead to the download of an untrusted\n              object and to execution of arbitrary code.",
            "id" : "java/jndi-injection",
            "kind" : "path-problem",
            "name" : "JNDI lookup with user-controlled name",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/overly-large-range",
          "name" : "java/overly-large-range",
          "shortDescription" : {
            "text" : "Overly permissive regular expression range"
          },
          "fullDescription" : {
            "text" : "Overly permissive regular expression ranges match a wider range of characters than intended. This may allow an attacker to bypass a filter or sanitizer."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "correctness", "security", "external/cwe/cwe-020" ],
            "description" : "Overly permissive regular expression ranges match a wider range of characters than intended.\n              This may allow an attacker to bypass a filter or sanitizer.",
            "id" : "java/overly-large-range",
            "kind" : "problem",
            "name" : "Overly permissive regular expression range",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "5.0"
          }
        }, {
          "id" : "java/tainted-permissions-check",
          "name" : "java/tainted-permissions-check",
          "shortDescription" : {
            "text" : "User-controlled data used in permissions check"
          },
          "fullDescription" : {
            "text" : "Using user-controlled data in a permissions check may result in inappropriate permissions being granted."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-807", "external/cwe/cwe-290" ],
            "description" : "Using user-controlled data in a permissions check may result in inappropriate\n              permissions being granted.",
            "id" : "java/tainted-permissions-check",
            "kind" : "path-problem",
            "name" : "User-controlled data used in permissions check",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "java/zipslip",
          "name" : "java/zipslip",
          "shortDescription" : {
            "text" : "Arbitrary file access during archive extraction (\"Zip Slip\")"
          },
          "fullDescription" : {
            "text" : "Extracting files from a malicious ZIP file, or similar type of archive, without validating that the destination file path is within the destination directory can allow an attacker to unexpectedly gain access to resources."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-022" ],
            "description" : "Extracting files from a malicious ZIP file, or similar type of archive, without\n              validating that the destination file path is within the destination directory\n              can allow an attacker to unexpectedly gain access to resources.",
            "id" : "java/zipslip",
            "kind" : "path-problem",
            "name" : "Arbitrary file access during archive extraction (\"Zip Slip\")",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/path-injection",
          "name" : "java/path-injection",
          "shortDescription" : {
            "text" : "Uncontrolled data used in path expression"
          },
          "fullDescription" : {
            "text" : "Accessing paths influenced by users can allow an attacker to access unexpected resources."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-022", "external/cwe/cwe-023", "external/cwe/cwe-036", "external/cwe/cwe-073" ],
            "description" : "Accessing paths influenced by users can allow an attacker to access unexpected resources.",
            "id" : "java/path-injection",
            "kind" : "path-problem",
            "name" : "Uncontrolled data used in path expression",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/tainted-format-string",
          "name" : "java/tainted-format-string",
          "shortDescription" : {
            "text" : "Use of externally-controlled format string"
          },
          "fullDescription" : {
            "text" : "Using external input in format strings can lead to exceptions or information leaks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-134" ],
            "description" : "Using external input in format strings can lead to exceptions or information leaks.",
            "id" : "java/tainted-format-string",
            "kind" : "path-problem",
            "name" : "Use of externally-controlled format string",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/unvalidated-url-redirection",
          "name" : "java/unvalidated-url-redirection",
          "shortDescription" : {
            "text" : "URL redirection from remote source"
          },
          "fullDescription" : {
            "text" : "URL redirection based on unvalidated user-input may cause redirection to malicious web sites."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-601" ],
            "description" : "URL redirection based on unvalidated user-input\n              may cause redirection to malicious web sites.",
            "id" : "java/unvalidated-url-redirection",
            "kind" : "path-problem",
            "name" : "URL redirection from remote source",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "java/maven/dependency-upon-bintray",
          "name" : "java/maven/dependency-upon-bintray",
          "shortDescription" : {
            "text" : "Depending upon JCenter/Bintray as an artifact repository"
          },
          "fullDescription" : {
            "text" : "Using a deprecated artifact repository may eventually give attackers access for a supply chain attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-1104" ],
            "description" : "Using a deprecated artifact repository may eventually give attackers access for a supply chain attack.",
            "id" : "java/maven/dependency-upon-bintray",
            "kind" : "problem",
            "name" : "Depending upon JCenter/Bintray as an artifact repository",
            "precision" : "very-high",
            "problem.severity" : "error",
            "security-severity" : "6.5"
          }
        }, {
          "id" : "java/cleartext-storage-in-cookie",
          "name" : "java/cleartext-storage-in-cookie",
          "shortDescription" : {
            "text" : "Cleartext storage of sensitive information in cookie"
          },
          "fullDescription" : {
            "text" : "Storing sensitive information in cleartext can expose it to an attacker."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-315" ],
            "description" : "Storing sensitive information in cleartext can expose it to an attacker.",
            "id" : "java/cleartext-storage-in-cookie",
            "kind" : "problem",
            "name" : "Cleartext storage of sensitive information in cookie",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "5.0"
          }
        }, {
          "id" : "java/android/backup-enabled",
          "name" : "java/android/backup-enabled",
          "shortDescription" : {
            "text" : "Application backup allowed"
          },
          "fullDescription" : {
            "text" : "Allowing application backups may allow an attacker to extract sensitive data."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "note"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-312" ],
            "description" : "Allowing application backups may allow an attacker to extract sensitive data.",
            "id" : "java/android/backup-enabled",
            "kind" : "problem",
            "name" : "Application backup allowed",
            "precision" : "very-high",
            "problem.severity" : "recommendation",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/improper-webview-certificate-validation",
          "name" : "java/improper-webview-certificate-validation",
          "shortDescription" : {
            "text" : "Android `WebView` that accepts all certificates"
          },
          "fullDescription" : {
            "text" : "Trusting all certificates allows an attacker to perform a machine-in-the-middle attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-295" ],
            "description" : "Trusting all certificates allows an attacker to perform a machine-in-the-middle attack.",
            "id" : "java/improper-webview-certificate-validation",
            "kind" : "problem",
            "name" : "Android `WebView` that accepts all certificates",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/insecure-trustmanager",
          "name" : "java/insecure-trustmanager",
          "shortDescription" : {
            "text" : "`TrustManager` that accepts all certificates"
          },
          "fullDescription" : {
            "text" : "Trusting all certificates allows an attacker to perform a machine-in-the-middle attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-295" ],
            "description" : "Trusting all certificates allows an attacker to perform a machine-in-the-middle attack.",
            "id" : "java/insecure-trustmanager",
            "kind" : "path-problem",
            "name" : "`TrustManager` that accepts all certificates",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/partial-path-traversal-from-remote",
          "name" : "java/partial-path-traversal-from-remote",
          "shortDescription" : {
            "text" : "Partial path traversal vulnerability from remote"
          },
          "fullDescription" : {
            "text" : "A prefix used to check that a canonicalised path falls within another must be slash-terminated."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-023" ],
            "description" : "A prefix used to check that a canonicalised path falls within another must be slash-terminated.",
            "id" : "java/partial-path-traversal-from-remote",
            "kind" : "path-problem",
            "name" : "Partial path traversal vulnerability from remote",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/weak-cryptographic-algorithm",
          "name" : "java/weak-cryptographic-algorithm",
          "shortDescription" : {
            "text" : "Use of a broken or risky cryptographic algorithm"
          },
          "fullDescription" : {
            "text" : "Using broken or weak cryptographic algorithms can allow an attacker to compromise security."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-327", "external/cwe/cwe-328" ],
            "description" : "Using broken or weak cryptographic algorithms can allow an attacker to compromise security.",
            "id" : "java/weak-cryptographic-algorithm",
            "kind" : "path-problem",
            "name" : "Use of a broken or risky cryptographic algorithm",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/ognl-injection",
          "name" : "java/ognl-injection",
          "shortDescription" : {
            "text" : "OGNL Expression Language statement with user-controlled input"
          },
          "fullDescription" : {
            "text" : "Evaluation of OGNL Expression Language statement with user-controlled input can lead to execution of arbitrary code."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-917" ],
            "description" : "Evaluation of OGNL Expression Language statement with user-controlled input can\n                lead to execution of arbitrary code.",
            "id" : "java/ognl-injection",
            "kind" : "path-problem",
            "name" : "OGNL Expression Language statement with user-controlled input",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/unsafe-deserialization",
          "name" : "java/unsafe-deserialization",
          "shortDescription" : {
            "text" : "Deserialization of user-controlled data"
          },
          "fullDescription" : {
            "text" : "Deserializing user-controlled data may allow attackers to execute arbitrary code."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-502" ],
            "description" : "Deserializing user-controlled data may allow attackers to\n              execute arbitrary code.",
            "id" : "java/unsafe-deserialization",
            "kind" : "path-problem",
            "name" : "Deserialization of user-controlled data",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/jhipster-prng",
          "name" : "java/jhipster-prng",
          "shortDescription" : {
            "text" : "Detect JHipster Generator Vulnerability CVE-2019-16303"
          },
          "fullDescription" : {
            "text" : "Using a vulnerable version of JHipster to generate random numbers makes it easier for attackers to take over accounts."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-338" ],
            "description" : "Using a vulnerable version of JHipster to generate random numbers makes it easier for attackers to take over accounts.",
            "id" : "java/jhipster-prng",
            "kind" : "problem",
            "name" : "Detect JHipster Generator Vulnerability CVE-2019-16303",
            "precision" : "very-high",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "java/android/fragment-injection-preference-activity",
          "name" : "java/android/fragment-injection-preference-activity",
          "shortDescription" : {
            "text" : "Android fragment injection in PreferenceActivity"
          },
          "fullDescription" : {
            "text" : "An insecure implementation of the 'isValidFragment' method of the 'PreferenceActivity' class may allow a malicious application to bypass access controls, exposing the application to unintended effects."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-470" ],
            "description" : "An insecure implementation of the 'isValidFragment' method\n              of the 'PreferenceActivity' class may allow a malicious application to bypass access controls,\n              exposing the application to unintended effects.",
            "id" : "java/android/fragment-injection-preference-activity",
            "kind" : "problem",
            "name" : "Android fragment injection in PreferenceActivity",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/android/fragment-injection",
          "name" : "java/android/fragment-injection",
          "shortDescription" : {
            "text" : "Android fragment injection"
          },
          "fullDescription" : {
            "text" : "Instantiating an Android fragment from a user-provided value may allow a malicious application to bypass access controls, exposing the application to unintended effects."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-470" ],
            "description" : "Instantiating an Android fragment from a user-provided value\n              may allow a malicious application to bypass access controls,  exposing the application to unintended effects.",
            "id" : "java/android/fragment-injection",
            "kind" : "path-problem",
            "name" : "Android fragment injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/android/intent-uri-permission-manipulation",
          "name" : "java/android/intent-uri-permission-manipulation",
          "shortDescription" : {
            "text" : "Intent URI permission manipulation"
          },
          "fullDescription" : {
            "text" : "Returning an externally provided Intent via 'setResult' may allow a malicious application to access arbitrary content providers of the vulnerable application."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-266", "external/cwe/cwe-926" ],
            "description" : "Returning an externally provided Intent via 'setResult' may allow a malicious\n              application to access arbitrary content providers of the vulnerable application.",
            "id" : "java/android/intent-uri-permission-manipulation",
            "kind" : "path-problem",
            "name" : "Intent URI permission manipulation",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "java/redos",
          "name" : "java/redos",
          "shortDescription" : {
            "text" : "Inefficient regular expression"
          },
          "fullDescription" : {
            "text" : "A regular expression that requires exponential time to match certain inputs can be a performance bottleneck, and may be vulnerable to denial-of-service attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-1333", "external/cwe/cwe-730", "external/cwe/cwe-400" ],
            "description" : "A regular expression that requires exponential time to match certain inputs\n              can be a performance bottleneck, and may be vulnerable to denial-of-service\n              attacks.",
            "id" : "java/redos",
            "kind" : "problem",
            "name" : "Inefficient regular expression",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/polynomial-redos",
          "name" : "java/polynomial-redos",
          "shortDescription" : {
            "text" : "Polynomial regular expression used on uncontrolled data"
          },
          "fullDescription" : {
            "text" : "A regular expression that can require polynomial time to match may be vulnerable to denial-of-service attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-1333", "external/cwe/cwe-730", "external/cwe/cwe-400" ],
            "description" : "A regular expression that can require polynomial time\n              to match may be vulnerable to denial-of-service attacks.",
            "id" : "java/polynomial-redos",
            "kind" : "path-problem",
            "name" : "Polynomial regular expression used on uncontrolled data",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/regex-injection",
          "name" : "java/regex-injection",
          "shortDescription" : {
            "text" : "Regular expression injection"
          },
          "fullDescription" : {
            "text" : "User input should not be used in regular expressions without first being escaped, otherwise a malicious user may be able to provide a regex that could require exponential time on certain inputs."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-730", "external/cwe/cwe-400" ],
            "description" : "User input should not be used in regular expressions without first being escaped,\n              otherwise a malicious user may be able to provide a regex that could require\n              exponential time on certain inputs.",
            "id" : "java/regex-injection",
            "kind" : "path-problem",
            "name" : "Regular expression injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/unsafe-hostname-verification",
          "name" : "java/unsafe-hostname-verification",
          "shortDescription" : {
            "text" : "Unsafe hostname verification"
          },
          "fullDescription" : {
            "text" : "Marking a certificate as valid for a host without checking the certificate hostname allows an attacker to perform a machine-in-the-middle attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-297" ],
            "description" : "Marking a certificate as valid for a host without checking the certificate hostname allows an attacker to perform a machine-in-the-middle attack.",
            "id" : "java/unsafe-hostname-verification",
            "kind" : "path-problem",
            "name" : "Unsafe hostname verification",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "5.9"
          }
        }, {
          "id" : "java/insufficient-key-size",
          "name" : "java/insufficient-key-size",
          "shortDescription" : {
            "text" : "Use of a cryptographic algorithm with insufficient key size"
          },
          "fullDescription" : {
            "text" : "Using cryptographic algorithms with too small a key size can allow an attacker to compromise security."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-326" ],
            "description" : "Using cryptographic algorithms with too small a key size can\n              allow an attacker to compromise security.",
            "id" : "java/insufficient-key-size",
            "kind" : "path-problem",
            "name" : "Use of a cryptographic algorithm with insufficient key size",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/sql-injection",
          "name" : "java/sql-injection",
          "shortDescription" : {
            "text" : "Query built from user-controlled sources"
          },
          "fullDescription" : {
            "text" : "Building a SQL or Java Persistence query from user-controlled sources is vulnerable to insertion of malicious code by the user."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-089", "external/cwe/cwe-564" ],
            "description" : "Building a SQL or Java Persistence query from user-controlled sources is vulnerable to insertion of\n              malicious code by the user.",
            "id" : "java/sql-injection",
            "kind" : "path-problem",
            "name" : "Query built from user-controlled sources",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/static-initialization-vector",
          "name" : "java/static-initialization-vector",
          "shortDescription" : {
            "text" : "Using a static initialization vector for encryption"
          },
          "fullDescription" : {
            "text" : "An initialization vector (IV) used for ciphers of certain modes (such as CBC or GCM) should be unique and unpredictable, to maximize encryption and prevent dictionary attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-329", "external/cwe/cwe-1204" ],
            "description" : "An initialization vector (IV) used for ciphers of certain modes (such as CBC or GCM) should be unique and unpredictable, to maximize encryption and prevent dictionary attacks.",
            "id" : "java/static-initialization-vector",
            "kind" : "path-problem",
            "name" : "Using a static initialization vector for encryption",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/tainted-numeric-cast",
          "name" : "java/tainted-numeric-cast",
          "shortDescription" : {
            "text" : "User-controlled data in numeric cast"
          },
          "fullDescription" : {
            "text" : "Casting user-controlled numeric data to a narrower type without validation can cause unexpected truncation."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-197", "external/cwe/cwe-681" ],
            "description" : "Casting user-controlled numeric data to a narrower type without validation\n              can cause unexpected truncation.",
            "id" : "java/tainted-numeric-cast",
            "kind" : "path-problem",
            "name" : "User-controlled data in numeric cast",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.0"
          }
        }, {
          "id" : "java/xxe",
          "name" : "java/xxe",
          "shortDescription" : {
            "text" : "Resolving XML external entity in user-controlled data"
          },
          "fullDescription" : {
            "text" : "Parsing user-controlled XML documents and allowing expansion of external entity references may lead to disclosure of confidential data or denial of service."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-611", "external/cwe/cwe-776", "external/cwe/cwe-827" ],
            "description" : "Parsing user-controlled XML documents and allowing expansion of external entity\n references may lead to disclosure of confidential data or denial of service.",
            "id" : "java/xxe",
            "kind" : "path-problem",
            "name" : "Resolving XML external entity in user-controlled data",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.1"
          }
        }, {
          "id" : "java/ldap-injection",
          "name" : "java/ldap-injection",
          "shortDescription" : {
            "text" : "LDAP query built from user-controlled sources"
          },
          "fullDescription" : {
            "text" : "Building an LDAP query from user-controlled sources is vulnerable to insertion of malicious LDAP code by the user."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-090" ],
            "description" : "Building an LDAP query from user-controlled sources is vulnerable to insertion of\n              malicious LDAP code by the user.",
            "id" : "java/ldap-injection",
            "kind" : "path-problem",
            "name" : "LDAP query built from user-controlled sources",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/missing-jwt-signature-check",
          "name" : "java/missing-jwt-signature-check",
          "shortDescription" : {
            "text" : "Missing JWT signature check"
          },
          "fullDescription" : {
            "text" : "Failing to check the Json Web Token (JWT) signature may allow an attacker to forge their own tokens."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-347" ],
            "description" : "Failing to check the Json Web Token (JWT) signature may allow an attacker to forge their own tokens.",
            "id" : "java/missing-jwt-signature-check",
            "kind" : "path-problem",
            "name" : "Missing JWT signature check",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "java/spel-expression-injection",
          "name" : "java/spel-expression-injection",
          "shortDescription" : {
            "text" : "Expression language injection (Spring)"
          },
          "fullDescription" : {
            "text" : "Evaluation of a user-controlled Spring Expression Language (SpEL) expression may lead to remote code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094" ],
            "description" : "Evaluation of a user-controlled Spring Expression Language (SpEL) expression\n              may lead to remote code execution.",
            "id" : "java/spel-expression-injection",
            "kind" : "path-problem",
            "name" : "Expression language injection (Spring)",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/groovy-injection",
          "name" : "java/groovy-injection",
          "shortDescription" : {
            "text" : "Groovy Language injection"
          },
          "fullDescription" : {
            "text" : "Evaluation of a user-controlled Groovy script may lead to arbitrary code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094" ],
            "description" : "Evaluation of a user-controlled Groovy script\n              may lead to arbitrary code execution.",
            "id" : "java/groovy-injection",
            "kind" : "path-problem",
            "name" : "Groovy Language injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/jexl-expression-injection",
          "name" : "java/jexl-expression-injection",
          "shortDescription" : {
            "text" : "Expression language injection (JEXL)"
          },
          "fullDescription" : {
            "text" : "Evaluation of a user-controlled JEXL expression may lead to arbitrary code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094" ],
            "description" : "Evaluation of a user-controlled JEXL expression\n              may lead to arbitrary code execution.",
            "id" : "java/jexl-expression-injection",
            "kind" : "path-problem",
            "name" : "Expression language injection (JEXL)",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/server-side-template-injection",
          "name" : "java/server-side-template-injection",
          "shortDescription" : {
            "text" : "Server-side template injection"
          },
          "fullDescription" : {
            "text" : "Untrusted input interpreted as a template can lead to remote code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-1336", "external/cwe/cwe-094" ],
            "description" : "Untrusted input interpreted as a template can lead to remote code execution.",
            "id" : "java/server-side-template-injection",
            "kind" : "path-problem",
            "name" : "Server-side template injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/insecure-bean-validation",
          "name" : "java/insecure-bean-validation",
          "shortDescription" : {
            "text" : "Insecure Bean Validation"
          },
          "fullDescription" : {
            "text" : "User-controlled data may be evaluated as a Java EL expression, leading to arbitrary code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094" ],
            "description" : "User-controlled data may be evaluated as a Java EL expression, leading to arbitrary code execution.",
            "id" : "java/insecure-bean-validation",
            "kind" : "path-problem",
            "name" : "Insecure Bean Validation",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/mvel-expression-injection",
          "name" : "java/mvel-expression-injection",
          "shortDescription" : {
            "text" : "Expression language injection (MVEL)"
          },
          "fullDescription" : {
            "text" : "Evaluation of a user-controlled MVEL expression may lead to remote code execution."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094" ],
            "description" : "Evaluation of a user-controlled MVEL expression\n              may lead to remote code execution.",
            "id" : "java/mvel-expression-injection",
            "kind" : "path-problem",
            "name" : "Expression language injection (MVEL)",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/android/implicit-pendingintents",
          "name" : "java/android/implicit-pendingintents",
          "shortDescription" : {
            "text" : "Use of implicit PendingIntents"
          },
          "fullDescription" : {
            "text" : "Sending an implicit and mutable 'PendingIntent' to an unspecified third party component may provide an attacker with access to internal components of the application or cause other unintended effects."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-927" ],
            "description" : "Sending an implicit and mutable 'PendingIntent' to an unspecified third party\n              component may provide an attacker with access to internal components of the\n              application or cause other unintended effects.",
            "id" : "java/android/implicit-pendingintents",
            "kind" : "path-problem",
            "name" : "Use of implicit PendingIntents",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "8.2"
          }
        }, {
          "id" : "java/maven/non-https-url",
          "name" : "java/maven/non-https-url",
          "shortDescription" : {
            "text" : "Failure to use HTTPS or SFTP URL in Maven artifact upload/download"
          },
          "fullDescription" : {
            "text" : "Non-HTTPS connections can be intercepted by third parties."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-300", "external/cwe/cwe-319", "external/cwe/cwe-494", "external/cwe/cwe-829" ],
            "description" : "Non-HTTPS connections can be intercepted by third parties.",
            "id" : "java/maven/non-https-url",
            "kind" : "problem",
            "name" : "Failure to use HTTPS or SFTP URL in Maven artifact upload/download",
            "precision" : "very-high",
            "problem.severity" : "error",
            "security-severity" : "8.1"
          }
        }, {
          "id" : "java/insecure-ldap-auth",
          "name" : "java/insecure-ldap-auth",
          "shortDescription" : {
            "text" : "Insecure LDAP authentication"
          },
          "fullDescription" : {
            "text" : "LDAP authentication with credentials sent in cleartext makes sensitive information vulnerable to remote attackers"
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-522", "external/cwe/cwe-319" ],
            "description" : "LDAP authentication with credentials sent in cleartext makes sensitive information vulnerable to remote attackers",
            "id" : "java/insecure-ldap-auth",
            "kind" : "path-problem",
            "name" : "Insecure LDAP authentication",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/rsa-without-oaep",
          "name" : "java/rsa-without-oaep",
          "shortDescription" : {
            "text" : "Use of RSA algorithm without OAEP"
          },
          "fullDescription" : {
            "text" : "Using RSA encryption without OAEP padding can result in a padding oracle attack, leading to a weaker encryption."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-780" ],
            "description" : "Using RSA encryption without OAEP padding can result in a padding oracle attack, leading to a weaker encryption.",
            "id" : "java/rsa-without-oaep",
            "kind" : "path-problem",
            "name" : "Use of RSA algorithm without OAEP",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/xml/xpath-injection",
          "name" : "java/xml/xpath-injection",
          "shortDescription" : {
            "text" : "XPath injection"
          },
          "fullDescription" : {
            "text" : "Building an XPath expression from user-controlled sources is vulnerable to insertion of malicious code by the user."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-643" ],
            "description" : "Building an XPath expression from user-controlled sources is vulnerable to insertion of\n              malicious code by the user.",
            "id" : "java/xml/xpath-injection",
            "kind" : "path-problem",
            "name" : "XPath injection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/android/intent-redirection",
          "name" : "java/android/intent-redirection",
          "shortDescription" : {
            "text" : "Android Intent redirection"
          },
          "fullDescription" : {
            "text" : "Starting Android components with user-provided Intents can provide access to internal components of the application, increasing the attack surface and potentially causing unintended effects."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-926", "external/cwe/cwe-940" ],
            "description" : "Starting Android components with user-provided Intents\n              can provide access to internal components of the application,\n              increasing the attack surface and potentially causing unintended effects.",
            "id" : "java/android/intent-redirection",
            "kind" : "path-problem",
            "name" : "Android Intent redirection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/xss",
          "name" : "java/xss",
          "shortDescription" : {
            "text" : "Cross-site scripting"
          },
          "fullDescription" : {
            "text" : "Writing user input directly to a web page allows for a cross-site scripting vulnerability."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079" ],
            "description" : "Writing user input directly to a web page\n              allows for a cross-site scripting vulnerability.",
            "id" : "java/xss",
            "kind" : "path-problem",
            "name" : "Cross-site scripting",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "java/spring-disabled-csrf-protection",
          "name" : "java/spring-disabled-csrf-protection",
          "shortDescription" : {
            "text" : "Disabled Spring CSRF protection"
          },
          "fullDescription" : {
            "text" : "Disabling CSRF protection makes the application vulnerable to a Cross-Site Request Forgery (CSRF) attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-352" ],
            "description" : "Disabling CSRF protection makes the application vulnerable to\n              a Cross-Site Request Forgery (CSRF) attack.",
            "id" : "java/spring-disabled-csrf-protection",
            "kind" : "problem",
            "name" : "Disabled Spring CSRF protection",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/http-response-splitting",
          "name" : "java/http-response-splitting",
          "shortDescription" : {
            "text" : "HTTP response splitting"
          },
          "fullDescription" : {
            "text" : "Writing user input directly to an HTTP header makes code vulnerable to attack by header splitting."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-113" ],
            "description" : "Writing user input directly to an HTTP header\n              makes code vulnerable to attack by header splitting.",
            "id" : "java/http-response-splitting",
            "kind" : "path-problem",
            "name" : "HTTP response splitting",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "java/netty-http-request-or-response-splitting",
          "name" : "java/netty-http-request-or-response-splitting",
          "shortDescription" : {
            "text" : "Disabled Netty HTTP header validation"
          },
          "fullDescription" : {
            "text" : "Disabling HTTP header validation makes code vulnerable to attack by header splitting if user input is written directly to an HTTP header."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-93", "external/cwe/cwe-113" ],
            "description" : "Disabling HTTP header validation makes code vulnerable to\n              attack by header splitting if user input is written directly to\n              an HTTP header.",
            "id" : "java/netty-http-request-or-response-splitting",
            "kind" : "problem",
            "name" : "Disabled Netty HTTP header validation",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "java/android/webview-debugging-enabled",
          "name" : "java/android/webview-debugging-enabled",
          "shortDescription" : {
            "text" : "Android Webview debugging enabled"
          },
          "fullDescription" : {
            "text" : "Enabling Webview debugging in production builds can expose entry points or leak sensitive information."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-489" ],
            "description" : "Enabling Webview debugging in production builds can expose entry points or leak sensitive information.",
            "id" : "java/android/webview-debugging-enabled",
            "kind" : "path-problem",
            "name" : "Android Webview debugging enabled",
            "precision" : "high",
            "problem.severity" : "warning",
            "security-severity" : "7.2"
          }
        }, {
          "id" : "java/android/debuggable-attribute-enabled",
          "name" : "java/android/debuggable-attribute-enabled",
          "shortDescription" : {
            "text" : "Android debuggable attribute enabled"
          },
          "fullDescription" : {
            "text" : "An enabled debugger can allow for entry points in the application or reveal sensitive information."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-489" ],
            "description" : "An enabled debugger can allow for entry points in the application or reveal sensitive information.",
            "id" : "java/android/debuggable-attribute-enabled",
            "kind" : "problem",
            "name" : "Android debuggable attribute enabled",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "7.2"
          }
        }, {
          "id" : "java/concatenated-command-line",
          "name" : "java/concatenated-command-line",
          "shortDescription" : {
            "text" : "Building a command line with string concatenation"
          },
          "fullDescription" : {
            "text" : "Using concatenated strings in a command line is vulnerable to malicious insertion of special characters in the strings."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-078", "external/cwe/cwe-088" ],
            "description" : "Using concatenated strings in a command line is vulnerable to malicious\n              insertion of special characters in the strings.",
            "id" : "java/concatenated-command-line",
            "kind" : "problem",
            "name" : "Building a command line with string concatenation",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/command-line-injection",
          "name" : "java/command-line-injection",
          "shortDescription" : {
            "text" : "Uncontrolled command line"
          },
          "fullDescription" : {
            "text" : "Using externally controlled strings in a command line is vulnerable to malicious changes in the strings."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-078", "external/cwe/cwe-088" ],
            "description" : "Using externally controlled strings in a command line is vulnerable to malicious\n              changes in the strings.",
            "id" : "java/command-line-injection",
            "kind" : "path-problem",
            "name" : "Uncontrolled command line",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/ssrf",
          "name" : "java/ssrf",
          "shortDescription" : {
            "text" : "Server-side request forgery"
          },
          "fullDescription" : {
            "text" : "Making web requests based on unvalidated user-input may cause the server to communicate with malicious servers."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-918" ],
            "description" : "Making web requests based on unvalidated user-input\n              may cause the server to communicate with malicious servers.",
            "id" : "java/ssrf",
            "kind" : "path-problem",
            "name" : "Server-side request forgery",
            "precision" : "high",
            "problem.severity" : "error",
            "security-severity" : "9.1"
          }
        }, {
          "id" : "java/implicit-cast-in-compound-assignment",
          "name" : "java/implicit-cast-in-compound-assignment",
          "shortDescription" : {
            "text" : "Implicit narrowing conversion in compound assignment"
          },
          "fullDescription" : {
            "text" : "Compound assignment statements (for example 'intvar += longvar') that implicitly cast a value of a wider type to a narrower type may result in information loss and numeric errors such as overflows."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "reliability", "security", "external/cwe/cwe-190", "external/cwe/cwe-192", "external/cwe/cwe-197", "external/cwe/cwe-681" ],
            "description" : "Compound assignment statements (for example 'intvar += longvar') that implicitly\n              cast a value of a wider type to a narrower type may result in information loss and\n              numeric errors such as overflows.",
            "id" : "java/implicit-cast-in-compound-assignment",
            "kind" : "problem",
            "name" : "Implicit narrowing conversion in compound assignment",
            "precision" : "very-high",
            "problem.severity" : "warning",
            "security-severity" : "8.1"
          }
        }, {
          "id" : "java/uncontrolled-arithmetic",
          "name" : "java/uncontrolled-arithmetic",
          "shortDescription" : {
            "text" : "Uncontrolled data in arithmetic expression"
          },
          "fullDescription" : {
            "text" : "Arithmetic operations on uncontrolled data that is not validated can cause overflows."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-190", "external/cwe/cwe-191" ],
            "description" : "Arithmetic operations on uncontrolled data that is not validated can cause\n              overflows.",
            "id" : "java/uncontrolled-arithmetic",
            "kind" : "path-problem",
            "name" : "Uncontrolled data in arithmetic expression",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.6"
          }
        }, {
          "id" : "java/comparison-with-wider-type",
          "name" : "java/comparison-with-wider-type",
          "shortDescription" : {
            "text" : "Comparison of narrow type with wide type in loop condition"
          },
          "fullDescription" : {
            "text" : "Comparisons between types of different widths in a loop condition can cause the loop to behave unexpectedly."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "reliability", "security", "external/cwe/cwe-190", "external/cwe/cwe-197" ],
            "description" : "Comparisons between types of different widths in a loop condition can cause the loop\n              to behave unexpectedly.",
            "id" : "java/comparison-with-wider-type",
            "kind" : "problem",
            "name" : "Comparison of narrow type with wide type in loop condition",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.1"
          }
        }, {
          "id" : "java/tainted-arithmetic",
          "name" : "java/tainted-arithmetic",
          "shortDescription" : {
            "text" : "User-controlled data in arithmetic expression"
          },
          "fullDescription" : {
            "text" : "Arithmetic operations on user-controlled data that is not validated can cause overflows."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-190", "external/cwe/cwe-191" ],
            "description" : "Arithmetic operations on user-controlled data that is not validated can cause\n              overflows.",
            "id" : "java/tainted-arithmetic",
            "kind" : "path-problem",
            "name" : "User-controlled data in arithmetic expression",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.6"
          }
        }, {
          "id" : "java/android/incomplete-provider-permissions",
          "name" : "java/android/incomplete-provider-permissions",
          "shortDescription" : {
            "text" : "Missing read or write permission in a content provider"
          },
          "fullDescription" : {
            "text" : "Android content providers which do not configure both read and write permissions can allow permission bypass."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-926" ],
            "description" : "Android content providers which do not configure both read and write permissions can allow permission bypass.",
            "id" : "java/android/incomplete-provider-permissions",
            "kind" : "problem",
            "name" : "Missing read or write permission in a content provider",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.2"
          }
        }, {
          "id" : "java/user-controlled-bypass",
          "name" : "java/user-controlled-bypass",
          "shortDescription" : {
            "text" : "User-controlled bypass of sensitive method"
          },
          "fullDescription" : {
            "text" : "User-controlled bypassing of sensitive methods may allow attackers to avoid passing through authentication systems."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-807", "external/cwe/cwe-290" ],
            "description" : "User-controlled bypassing of sensitive methods may allow attackers to avoid\n              passing through authentication systems.",
            "id" : "java/user-controlled-bypass",
            "kind" : "path-problem",
            "name" : "User-controlled bypass of sensitive method",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "java/hardcoded-credential-api-call",
          "name" : "java/hardcoded-credential-api-call",
          "shortDescription" : {
            "text" : "Hard-coded credential in API call"
          },
          "fullDescription" : {
            "text" : "Using a hard-coded credential in a call to a sensitive Java API may compromise security."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-798" ],
            "description" : "Using a hard-coded credential in a call to a sensitive Java API may compromise security.",
            "id" : "java/hardcoded-credential-api-call",
            "kind" : "path-problem",
            "name" : "Hard-coded credential in API call",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/local-temp-file-or-directory-information-disclosure",
          "name" : "java/local-temp-file-or-directory-information-disclosure",
          "shortDescription" : {
            "text" : "Local information disclosure in a temporary directory"
          },
          "fullDescription" : {
            "text" : "Writing information without explicit permissions to a shared temporary directory may disclose it to other users."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-200", "external/cwe/cwe-732" ],
            "description" : "Writing information without explicit permissions to a shared temporary directory may disclose it to other users.",
            "id" : "java/local-temp-file-or-directory-information-disclosure",
            "kind" : "path-problem",
            "name" : "Local information disclosure in a temporary directory",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "6.5"
          }
        }, {
          "id" : "java/android/websettings-allow-content-access",
          "name" : "java/android/websettings-allow-content-access",
          "shortDescription" : {
            "text" : "Android WebView settings allows access to content links"
          },
          "fullDescription" : {
            "text" : "Access to content providers in a WebView can allow access to protected information by loading content:// links."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-200" ],
            "description" : "Access to content providers in a WebView can allow access to protected information by loading content:// links.",
            "id" : "java/android/websettings-allow-content-access",
            "kind" : "problem",
            "name" : "Android WebView settings allows access to content links",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "6.5"
          }
        }, {
          "id" : "java/android/websettings-file-access",
          "name" : "java/android/websettings-file-access",
          "shortDescription" : {
            "text" : "Android WebSettings file access"
          },
          "fullDescription" : {
            "text" : "Enabling access to the file system in a WebView allows attackers to view sensitive information."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-200" ],
            "description" : "Enabling access to the file system in a WebView allows attackers to view sensitive information.",
            "id" : "java/android/websettings-file-access",
            "kind" : "problem",
            "name" : "Android WebSettings file access",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "6.5"
          }
        }, {
          "id" : "java/socket-auth-race-condition",
          "name" : "java/socket-auth-race-condition",
          "shortDescription" : {
            "text" : "Race condition in socket authentication"
          },
          "fullDescription" : {
            "text" : "Opening a socket after authenticating via a different channel may allow an attacker to connect to the port first."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-421" ],
            "description" : "Opening a socket after authenticating via a different channel may allow an attacker to connect to the port first.",
            "id" : "java/socket-auth-race-condition",
            "kind" : "problem",
            "name" : "Race condition in socket authentication",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.2"
          }
        }, {
          "id" : "java/android/cleartext-storage-filesystem",
          "name" : "java/android/cleartext-storage-filesystem",
          "shortDescription" : {
            "text" : "Cleartext storage of sensitive information in the Android filesystem"
          },
          "fullDescription" : {
            "text" : "Cleartext storage of sensitive information in the Android filesystem allows access for users with root privileges or unexpected exposure from chained vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-312" ],
            "description" : "Cleartext storage of sensitive information in the Android filesystem\n              allows access for users with root privileges or unexpected exposure\n              from chained vulnerabilities.",
            "id" : "java/android/cleartext-storage-filesystem",
            "kind" : "problem",
            "name" : "Cleartext storage of sensitive information in the Android filesystem",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/android/cleartext-storage-shared-prefs",
          "name" : "java/android/cleartext-storage-shared-prefs",
          "shortDescription" : {
            "text" : "Cleartext storage of sensitive information using `SharedPreferences` on Android"
          },
          "fullDescription" : {
            "text" : "Cleartext Storage of Sensitive Information using SharedPreferences on Android allows access for users with root privileges or unexpected exposure from chained vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-312" ],
            "description" : "Cleartext Storage of Sensitive Information using\n              SharedPreferences on Android allows access for users with root\n              privileges or unexpected exposure from chained vulnerabilities.",
            "id" : "java/android/cleartext-storage-shared-prefs",
            "kind" : "problem",
            "name" : "Cleartext storage of sensitive information using `SharedPreferences` on Android",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/cleartext-storage-in-properties",
          "name" : "java/cleartext-storage-in-properties",
          "shortDescription" : {
            "text" : "Cleartext storage of sensitive information using 'Properties' class"
          },
          "fullDescription" : {
            "text" : "Storing sensitive information in cleartext can expose it to an attacker."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-313" ],
            "description" : "Storing sensitive information in cleartext can expose it to an attacker.",
            "id" : "java/cleartext-storage-in-properties",
            "kind" : "problem",
            "name" : "Cleartext storage of sensitive information using 'Properties' class",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/android/cleartext-storage-database",
          "name" : "java/android/cleartext-storage-database",
          "shortDescription" : {
            "text" : "Cleartext storage of sensitive information using a local database on Android"
          },
          "fullDescription" : {
            "text" : "Cleartext Storage of Sensitive Information using a local database on Android allows access for users with root privileges or unexpected exposure from chained vulnerabilities."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-312" ],
            "description" : "Cleartext Storage of Sensitive Information using\n              a local database on Android allows access for users with root\n              privileges or unexpected exposure from chained vulnerabilities.",
            "id" : "java/android/cleartext-storage-database",
            "kind" : "problem",
            "name" : "Cleartext storage of sensitive information using a local database on Android",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/android/missing-certificate-pinning",
          "name" : "java/android/missing-certificate-pinning",
          "shortDescription" : {
            "text" : "Android missing certificate pinning"
          },
          "fullDescription" : {
            "text" : "Network connections that do not use certificate pinning may allow attackers to eavesdrop on communications."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-295" ],
            "description" : "Network connections that do not use certificate pinning may allow attackers to eavesdrop on communications.",
            "id" : "java/android/missing-certificate-pinning",
            "kind" : "problem",
            "name" : "Android missing certificate pinning",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "5.9"
          }
        }, {
          "id" : "java/partial-path-traversal",
          "name" : "java/partial-path-traversal",
          "shortDescription" : {
            "text" : "Partial path traversal vulnerability"
          },
          "fullDescription" : {
            "text" : "A prefix used to check that a canonicalised path falls within another must be slash-terminated."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-023" ],
            "description" : "A prefix used to check that a canonicalised path falls within another must be slash-terminated.",
            "id" : "java/partial-path-traversal",
            "kind" : "problem",
            "name" : "Partial path traversal vulnerability",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/potentially-weak-cryptographic-algorithm",
          "name" : "java/potentially-weak-cryptographic-algorithm",
          "shortDescription" : {
            "text" : "Use of a potentially broken or risky cryptographic algorithm"
          },
          "fullDescription" : {
            "text" : "Using broken or weak cryptographic algorithms can allow an attacker to compromise security."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-327", "external/cwe/cwe-328" ],
            "description" : "Using broken or weak cryptographic algorithms can allow an attacker to compromise security.",
            "id" : "java/potentially-weak-cryptographic-algorithm",
            "kind" : "path-problem",
            "name" : "Use of a potentially broken or risky cryptographic algorithm",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/android/sensitive-keyboard-cache",
          "name" : "java/android/sensitive-keyboard-cache",
          "shortDescription" : {
            "text" : "Android sensitive keyboard cache"
          },
          "fullDescription" : {
            "text" : "Allowing the keyboard to cache sensitive information may result in information leaks to other applications."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-524" ],
            "description" : "Allowing the keyboard to cache sensitive information may result in information leaks to other applications.",
            "id" : "java/android/sensitive-keyboard-cache",
            "kind" : "problem",
            "name" : "Android sensitive keyboard cache",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.1"
          }
        }, {
          "id" : "java/insecure-smtp-ssl",
          "name" : "java/insecure-smtp-ssl",
          "shortDescription" : {
            "text" : "Insecure JavaMail SSL Configuration"
          },
          "fullDescription" : {
            "text" : "Configuring a Java application to use authenticated mail session over SSL without certificate validation makes the session susceptible to a man-in-the-middle attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-297" ],
            "description" : "Configuring a Java application to use authenticated mail session\n              over SSL without certificate validation\n              makes the session susceptible to a man-in-the-middle attack.",
            "id" : "java/insecure-smtp-ssl",
            "kind" : "problem",
            "name" : "Insecure JavaMail SSL Configuration",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "5.9"
          }
        }, {
          "id" : "java/concatenated-sql-query",
          "name" : "java/concatenated-sql-query",
          "shortDescription" : {
            "text" : "Query built by concatenation with a possibly-untrusted string"
          },
          "fullDescription" : {
            "text" : "Building a SQL or Java Persistence query by concatenating a possibly-untrusted string is vulnerable to insertion of malicious code."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-089", "external/cwe/cwe-564" ],
            "description" : "Building a SQL or Java Persistence query by concatenating a possibly-untrusted string\n              is vulnerable to insertion of malicious code.",
            "id" : "java/concatenated-sql-query",
            "kind" : "problem",
            "name" : "Query built by concatenation with a possibly-untrusted string",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/improper-validation-of-array-construction",
          "name" : "java/improper-validation-of-array-construction",
          "shortDescription" : {
            "text" : "Improper validation of user-provided size used for array construction"
          },
          "fullDescription" : {
            "text" : "Using unvalidated external input as the argument to a construction of an array can lead to index out of bound exceptions."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-129" ],
            "description" : "Using unvalidated external input as the argument to a construction of an array can lead to index out of bound exceptions.",
            "id" : "java/improper-validation-of-array-construction",
            "kind" : "path-problem",
            "name" : "Improper validation of user-provided size used for array construction",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/improper-validation-of-array-index",
          "name" : "java/improper-validation-of-array-index",
          "shortDescription" : {
            "text" : "Improper validation of user-provided array index"
          },
          "fullDescription" : {
            "text" : "Using external input as an index to an array, without proper validation, can lead to index out of bound exceptions."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-129" ],
            "description" : "Using external input as an index to an array, without proper validation, can lead to index out of bound exceptions.",
            "id" : "java/improper-validation-of-array-index",
            "kind" : "path-problem",
            "name" : "Improper validation of user-provided array index",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/trust-boundary-violation",
          "name" : "java/trust-boundary-violation",
          "shortDescription" : {
            "text" : "Trust boundary violation"
          },
          "fullDescription" : {
            "text" : "Modifying the HTTP session attributes based on data from an untrusted source may violate a trust boundary."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-501" ],
            "description" : "Modifying the HTTP session attributes based on data from an untrusted source may violate a trust boundary.",
            "id" : "java/trust-boundary-violation",
            "kind" : "path-problem",
            "name" : "Trust boundary violation",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/android/arbitrary-apk-installation",
          "name" : "java/android/arbitrary-apk-installation",
          "shortDescription" : {
            "text" : "Android APK installation"
          },
          "fullDescription" : {
            "text" : "Creating an intent with a URI pointing to a untrusted file can lead to the installation of an untrusted application."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-094" ],
            "description" : "Creating an intent with a URI pointing to a untrusted file can lead to the installation of an untrusted application.",
            "id" : "java/android/arbitrary-apk-installation",
            "kind" : "path-problem",
            "name" : "Android APK installation",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "9.3"
          }
        }, {
          "id" : "java/android/sensitive-communication",
          "name" : "java/android/sensitive-communication",
          "shortDescription" : {
            "text" : "Leaking sensitive information through an implicit Intent"
          },
          "fullDescription" : {
            "text" : "An Android application uses implicit Intents containing sensitive data in a way that exposes it to arbitrary applications on the device."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-927" ],
            "description" : "An Android application uses implicit Intents containing sensitive data\n              in a way that exposes it to arbitrary applications on the device.",
            "id" : "java/android/sensitive-communication",
            "kind" : "path-problem",
            "name" : "Leaking sensitive information through an implicit Intent",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.2"
          }
        }, {
          "id" : "java/android/sensitive-result-receiver",
          "name" : "java/android/sensitive-result-receiver",
          "shortDescription" : {
            "text" : "Leaking sensitive information through a ResultReceiver"
          },
          "fullDescription" : {
            "text" : "Sending sensitive data to a 'ResultReceiver' obtained from an untrusted source can allow malicious actors access to your information."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-927" ],
            "description" : "Sending sensitive data to a 'ResultReceiver' obtained from an untrusted source\n              can allow malicious actors access to your information.",
            "id" : "java/android/sensitive-result-receiver",
            "kind" : "path-problem",
            "name" : "Leaking sensitive information through a ResultReceiver",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "8.2"
          }
        }, {
          "id" : "java/log-injection",
          "name" : "java/log-injection",
          "shortDescription" : {
            "text" : "Log Injection"
          },
          "fullDescription" : {
            "text" : "Building log entries from user-controlled data may allow insertion of forged log entries by malicious users."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-117" ],
            "description" : "Building log entries from user-controlled data may allow\n              insertion of forged log entries by malicious users.",
            "id" : "java/log-injection",
            "kind" : "path-problem",
            "name" : "Log Injection",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "7.8"
          }
        }, {
          "id" : "java/potentially-dangerous-function",
          "name" : "java/potentially-dangerous-function",
          "shortDescription" : {
            "text" : "Use of a potentially dangerous function"
          },
          "fullDescription" : {
            "text" : "Certain standard library routines are dangerous to call."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "reliability", "security", "external/cwe/cwe-676" ],
            "description" : "Certain standard library routines are dangerous to call.",
            "id" : "java/potentially-dangerous-function",
            "kind" : "problem",
            "name" : "Use of a potentially dangerous function",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "10.0"
          }
        }, {
          "id" : "java/unsafe-cert-trust",
          "name" : "java/unsafe-cert-trust",
          "shortDescription" : {
            "text" : "Unsafe certificate trust"
          },
          "fullDescription" : {
            "text" : "SSLSocket/SSLEngine ignores all SSL certificate validation errors when establishing an HTTPS connection, thereby making the app vulnerable to man-in-the-middle attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-273" ],
            "description" : "SSLSocket/SSLEngine ignores all SSL certificate validation\n              errors when establishing an HTTPS connection, thereby making\n              the app vulnerable to man-in-the-middle attacks.",
            "id" : "java/unsafe-cert-trust",
            "kind" : "problem",
            "name" : "Unsafe certificate trust",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/insecure-basic-auth",
          "name" : "java/insecure-basic-auth",
          "shortDescription" : {
            "text" : "Insecure basic authentication"
          },
          "fullDescription" : {
            "text" : "Basic authentication only obfuscates username/password in Base64 encoding, which can be easily recognized and reversed. Transmitting sensitive information without using HTTPS makes the data vulnerable to packet sniffing."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-522", "external/cwe/cwe-319" ],
            "description" : "Basic authentication only obfuscates username/password in\n              Base64 encoding, which can be easily recognized and reversed.\n              Transmitting sensitive information without using HTTPS makes\n              the data vulnerable to packet sniffing.",
            "id" : "java/insecure-basic-auth",
            "kind" : "path-problem",
            "name" : "Insecure basic authentication",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "8.8"
          }
        }, {
          "id" : "java/toctou-race-condition",
          "name" : "java/toctou-race-condition",
          "shortDescription" : {
            "text" : "Time-of-check time-of-use race condition"
          },
          "fullDescription" : {
            "text" : "Using a resource after an unsynchronized state check can lead to a race condition, if the state may be changed between the check and use."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-367" ],
            "description" : "Using a resource after an unsynchronized state check can lead to a race condition,\n              if the state may be changed between the check and use.",
            "id" : "java/toctou-race-condition",
            "kind" : "problem",
            "name" : "Time-of-check time-of-use race condition",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.7"
          }
        }, {
          "id" : "java/android/websettings-javascript-enabled",
          "name" : "java/android/websettings-javascript-enabled",
          "shortDescription" : {
            "text" : "Android WebView JavaScript settings"
          },
          "fullDescription" : {
            "text" : "Enabling JavaScript execution in a WebView can result in cross-site scripting attacks."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079" ],
            "description" : "Enabling JavaScript execution in a WebView can result in cross-site scripting attacks.",
            "id" : "java/android/websettings-javascript-enabled",
            "kind" : "problem",
            "name" : "Android WebView JavaScript settings",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "java/android/webview-addjavascriptinterface",
          "name" : "java/android/webview-addjavascriptinterface",
          "shortDescription" : {
            "text" : "Access Java object methods through JavaScript exposure"
          },
          "fullDescription" : {
            "text" : "Exposing a Java object in a WebView with a JavaScript interface can lead to malicious JavaScript controlling the application."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-079" ],
            "description" : "Exposing a Java object in a WebView with a JavaScript interface can lead to malicious JavaScript controlling the application.",
            "id" : "java/android/webview-addjavascriptinterface",
            "kind" : "problem",
            "name" : "Access Java object methods through JavaScript exposure",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "java/android/unsafe-android-webview-fetch",
          "name" : "java/android/unsafe-android-webview-fetch",
          "shortDescription" : {
            "text" : "Unsafe resource fetching in Android WebView"
          },
          "fullDescription" : {
            "text" : "JavaScript rendered inside WebViews can access protected application files and web resources from any origin exposing them to attack."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-749", "external/cwe/cwe-079" ],
            "description" : "JavaScript rendered inside WebViews can access protected\n              application files and web resources from any origin exposing them to attack.",
            "id" : "java/android/unsafe-android-webview-fetch",
            "kind" : "path-problem",
            "name" : "Unsafe resource fetching in Android WebView",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "6.1"
          }
        }, {
          "id" : "java/unreachable-exit-in-loop",
          "name" : "java/unreachable-exit-in-loop",
          "shortDescription" : {
            "text" : "Loop with unreachable exit condition"
          },
          "fullDescription" : {
            "text" : "An iteration or loop with an exit condition that cannot be reached is an indication of faulty logic and can likely lead to infinite looping."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-835" ],
            "description" : "An iteration or loop with an exit condition that cannot be\n              reached is an indication of faulty logic and can likely lead to infinite\n              looping.",
            "id" : "java/unreachable-exit-in-loop",
            "kind" : "problem",
            "name" : "Loop with unreachable exit condition",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/relative-path-command",
          "name" : "java/relative-path-command",
          "shortDescription" : {
            "text" : "Executing a command with a relative path"
          },
          "fullDescription" : {
            "text" : "Executing a command with a relative path is vulnerable to malicious changes in the PATH environment variable."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-078", "external/cwe/cwe-088" ],
            "description" : "Executing a command with a relative path is vulnerable to\n              malicious changes in the PATH environment variable.",
            "id" : "java/relative-path-command",
            "kind" : "problem",
            "name" : "Executing a command with a relative path",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "9.8"
          }
        }, {
          "id" : "java/sensitive-log",
          "name" : "java/sensitive-log",
          "shortDescription" : {
            "text" : "Insertion of sensitive information into log files"
          },
          "fullDescription" : {
            "text" : "Writing sensitive information to log files can allow that information to be leaked to an attacker more easily."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "warning"
          },
          "properties" : {
            "tags" : [ "security", "external/cwe/cwe-532" ],
            "description" : "Writing sensitive information to log files can allow that\n              information to be leaked to an attacker more easily.",
            "id" : "java/sensitive-log",
            "kind" : "path-problem",
            "name" : "Insertion of sensitive information into log files",
            "precision" : "medium",
            "problem.severity" : "warning",
            "security-severity" : "7.5"
          }
        }, {
          "id" : "java/unreleased-lock",
          "name" : "java/unreleased-lock",
          "shortDescription" : {
            "text" : "Unreleased lock"
          },
          "fullDescription" : {
            "text" : "A lock that is acquired one or more times without a matching number of unlocks may cause a deadlock."
          },
          "defaultConfiguration" : {
            "enabled" : true,
            "level" : "error"
          },
          "properties" : {
            "tags" : [ "reliability", "security", "external/cwe/cwe-764", "external/cwe/cwe-833" ],
            "description" : "A lock that is acquired one or more times without a matching number of unlocks\n              may cause a deadlock.",
            "id" : "java/unreleased-lock",
            "kind" : "problem",
            "name" : "Unreleased lock",
            "precision" : "medium",
            "problem.severity" : "error",
            "security-severity" : "5.0"
          }
        }, {
          "id" : "java/summary/lines-of-code-kotlin",
          "name" : "java/summary/lines-of-code-kotlin",
          "shortDescription" : {
            "text" : "Total lines of Kotlin code in the database"
          },
          "fullDescription" : {
            "text" : "The total number of lines of code across all Kotlin files. This is a useful metric of the size of a database. For all Kotlin files that were seen during the build, this query counts the lines of code, excluding whitespace or comments."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary" ],
            "description" : "The total number of lines of code across all Kotlin files. This is a useful metric of the size of a database.\n              For all Kotlin files that were seen during the build, this query counts the lines of code, excluding whitespace\n              or comments.",
            "id" : "java/summary/lines-of-code-kotlin",
            "kind" : "metric",
            "name" : "Total lines of Kotlin code in the database"
          }
        }, {
          "id" : "java/summary/lines-of-code",
          "name" : "java/summary/lines-of-code",
          "shortDescription" : {
            "text" : "Total lines of Java/Kotlin code in the database"
          },
          "fullDescription" : {
            "text" : "The total number of lines of code across all Java and Kotlin files. This is a useful metric of the size of a database. For all source files that were seen during the build, this query counts the lines of code, excluding whitespace or comments."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "lines-of-code" ],
            "description" : "The total number of lines of code across all Java and Kotlin files. This is a useful metric of the size of a database.\n              For all source files that were seen during the build, this query counts the lines of code, excluding whitespace\n              or comments.",
            "id" : "java/summary/lines-of-code",
            "kind" : "metric",
            "name" : "Total lines of Java/Kotlin code in the database"
          }
        }, {
          "id" : "java/summary/lines-of-code-java",
          "name" : "java/summary/lines-of-code-java",
          "shortDescription" : {
            "text" : "Total lines of Java code in the database"
          },
          "fullDescription" : {
            "text" : "The total number of lines of code across all Java files. This is a useful metric of the size of a database. For all Java files that were seen during the build, this query counts the lines of code, excluding whitespace or comments."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary" ],
            "description" : "The total number of lines of code across all Java files. This is a useful metric of the size of a database.\n              For all Java files that were seen during the build, this query counts the lines of code, excluding whitespace\n              or comments.",
            "id" : "java/summary/lines-of-code-java",
            "kind" : "metric",
            "name" : "Total lines of Java code in the database"
          }
        }, {
          "id" : "java/telemetry/external-libs",
          "name" : "java/telemetry/external-libs",
          "shortDescription" : {
            "text" : "External libraries"
          },
          "fullDescription" : {
            "text" : "A list of external libraries used in the code"
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "telemetry" ],
            "description" : "A list of external libraries used in the code",
            "id" : "java/telemetry/external-libs",
            "kind" : "metric",
            "name" : "External libraries"
          }
        }, {
          "id" : "java/telemetry/supported-external-api",
          "name" : "java/telemetry/supported-external-api",
          "shortDescription" : {
            "text" : "Usage of supported APIs coming from external libraries"
          },
          "fullDescription" : {
            "text" : "A list of supported 3rd party APIs used in the codebase. Excludes test and generated code."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "telemetry" ],
            "description" : "A list of supported 3rd party APIs used in the codebase. Excludes test and generated code.",
            "id" : "java/telemetry/supported-external-api",
            "kind" : "metric",
            "name" : "Usage of supported APIs coming from external libraries"
          }
        }, {
          "id" : "java/telemetry/extraction-information",
          "name" : "java/telemetry/extraction-information",
          "shortDescription" : {
            "text" : "Java extraction information"
          },
          "fullDescription" : {
            "text" : "Information about the extraction for a Java database"
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "telemetry" ],
            "description" : "Information about the extraction for a Java database",
            "id" : "java/telemetry/extraction-information",
            "kind" : "metric",
            "name" : "Java extraction information"
          }
        }, {
          "id" : "java/telemetry/supported-external-api-taint",
          "name" : "java/telemetry/supported-external-api-taint",
          "shortDescription" : {
            "text" : "Supported flow steps in external libraries"
          },
          "fullDescription" : {
            "text" : "A list of 3rd party APIs detected as flow steps. Excludes test and generated code."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "telemetry" ],
            "description" : "A list of 3rd party APIs detected as flow steps. Excludes test and generated code.",
            "id" : "java/telemetry/supported-external-api-taint",
            "kind" : "metric",
            "name" : "Supported flow steps in external libraries"
          }
        }, {
          "id" : "java/telemetry/supported-external-api-sinks",
          "name" : "java/telemetry/supported-external-api-sinks",
          "shortDescription" : {
            "text" : "Supported sinks in external libraries"
          },
          "fullDescription" : {
            "text" : "A list of 3rd party APIs detected as sinks. Excludes test and generated code."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "telemetry" ],
            "description" : "A list of 3rd party APIs detected as sinks. Excludes test and generated code.",
            "id" : "java/telemetry/supported-external-api-sinks",
            "kind" : "metric",
            "name" : "Supported sinks in external libraries"
          }
        }, {
          "id" : "java/telemetry/unsupported-external-api",
          "name" : "java/telemetry/unsupported-external-api",
          "shortDescription" : {
            "text" : "Usage of unsupported APIs coming from external libraries"
          },
          "fullDescription" : {
            "text" : "A list of 3rd party APIs used in the codebase. Excludes test and generated code."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "telemetry" ],
            "description" : "A list of 3rd party APIs used in the codebase. Excludes test and generated code.",
            "id" : "java/telemetry/unsupported-external-api",
            "kind" : "metric",
            "name" : "Usage of unsupported APIs coming from external libraries"
          }
        }, {
          "id" : "java/telemetry/supported-external-api-sources",
          "name" : "java/telemetry/supported-external-api-sources",
          "shortDescription" : {
            "text" : "Supported sources in external libraries"
          },
          "fullDescription" : {
            "text" : "A list of 3rd party APIs detected as sources. Excludes test and generated code."
          },
          "defaultConfiguration" : {
            "enabled" : true
          },
          "properties" : {
            "tags" : [ "summary", "telemetry" ],
            "description" : "A list of 3rd party APIs detected as sources. Excludes test and generated code.",
            "id" : "java/telemetry/supported-external-api-sources",
            "kind" : "metric",
            "name" : "Supported sources in external libraries"
          }
        } ]
      },
      "extensions" : [ {
        "name" : "codeql/java-queries",
        "semanticVersion" : "0.8.3-dev+a0e73eaab0690055226e73836b7704b26875d568",
        "locations" : [ {
          "uri" : "file:///home/kdas006/codeql-home/codeql-repo/java/ql/src/",
          "description" : {
            "text" : "The QL pack root directory."
          }
        }, {
          "uri" : "file:///home/kdas006/codeql-home/codeql-repo/java/ql/src/qlpack.yml",
          "description" : {
            "text" : "The QL pack definition file."
          }
        } ]
      } ]
    },
    "invocations" : [ {
      "toolExecutionNotifications" : [ {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/test/java/co/yiiu/pybbs/PybbsApplicationTests.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 16
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/test/java/co/yiiu/pybbs/util/StringUtilTest.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 17
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/TopicTagMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 18
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/DateUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 19
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Streams.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 20
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/SpringContextUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 21
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/INotificationService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 22
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MessageEncoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 23
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Captcha.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 24
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/RedisCachePlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 25
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/StringUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 26
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/Result.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 27
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/CommentController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 28
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/IBaseGenerator.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 29
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TelegramBotController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 30
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Permission.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 31
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/AdminUserAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 32
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/SecurityUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 33
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/HttpUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 34
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/IndexedServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 35
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 15
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/RoleService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 36
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/SensitiveWordMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 37
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/ElasticSearchService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 38
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IRoleService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 39
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/TagAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 40
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/impl/MyGenerator.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 41
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/RoleMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 42
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/PybbsApplication.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 43
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/NotificationService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 44
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/Message.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 45
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/package-info.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 46
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/NotificationMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 47
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ITagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 48
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/SearchDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 49
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/SensitiveWordService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 50
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/TopicCommentsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 51
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/UserCommentsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 52
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/TopicListDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 53
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/AdminUserMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 54
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Randoms.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 55
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/OAuthUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 56
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ITopicService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 57
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyCredentialsMatcher.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 58
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/IndexedService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 59
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/PermissionAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 60
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/FreemarkerConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 61
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CollectApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 62
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 63
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/ElasticSearchPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 64
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Quant.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 65
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/SocialDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 66
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/NotificationApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 67
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/DataSourceHelper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 68
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/AdminUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 69
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicTagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 70
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 9
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/IndexController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 71
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/CookieUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 0
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/ScoreDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 72
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/LocaleMessageSourceUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 73
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MyWebSocket.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 74
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/TopicAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 75
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/PermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 76
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/UserMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 77
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/UserApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 78
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/CommentLayerPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 79
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/BaseApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 80
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/IndexAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 81
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/OAuthController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 82
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/SiteConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 83
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 3
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/ServerRunner.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 84
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/SocialPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 85
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/MD5Util.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 6
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/WebSocketConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 86
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/SystemConfigAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 87
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/GifCaptcha.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 88
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/FileUploadPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 89
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ISystemConfigService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 90
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/BaseAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 91
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/CommonController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 92
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/impl/DefaultGenerator.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 93
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/UserAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 94
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/WebMvcConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 95
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyShiroRealm.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 96
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/PermissionMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 97
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/TagMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 98
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 7
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/exception/ApiAssert.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 99
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/UserController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 100
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 1
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CollectService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 101
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/SystemConfigMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 102
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/TopicTag.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 103
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/AdminUser.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 104
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/TelegramBotService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 105
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/SensitiveWord.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 106
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/bcrypt/BCryptPasswordEncoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 107
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Tag.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 108
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CodeService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 109
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ICodeService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 110
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/RolePermissionMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 111
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/OAuthUserMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 112
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/Constants.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 113
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IOAuthUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 114
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 8
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ISensitiveWordService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 115
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/RedisService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 116
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/vo/CommentsByTopic.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 117
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/RolePermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 118
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/CommentAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 119
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/RolePermission.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 120
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/BaseModel.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 121
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/FlywayConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 122
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 14
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 5
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/JsonUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 123
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/vo/package-info.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 124
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/SensitiveWordFilterService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 125
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/NotificationsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 126
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/TopicServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 127
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/exception/GlobalExceptionHandler.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 128
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MessageDecoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 129
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/TopicController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 130
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ICollectService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 131
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 2
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/CommentMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 132
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/GifEncoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 133
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/UserServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 134
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ITopicTagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 135
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/DataSourceConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 136
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/RoleAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 137
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ICommentService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 138
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/EmailService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 139
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 140
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IPermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 141
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/TagsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 142
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/MybatisPlusConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 143
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/UserTopicsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 144
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/BaseController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 145
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/SensitiveWordAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 146
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/SystemConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 147
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/ShiroTag.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 148
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Code.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 149
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/SmsService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 150
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/SystemConfigService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 151
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/User.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 152
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/OAuthUser.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 153
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IRolePermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 154
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/TopicMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 155
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/interceptor/UserInterceptor.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 156
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IAdminUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 157
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/bcrypt/BCrypt.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 158
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/CodeMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 159
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/vo/UserWithWebSocketVO.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 160
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Role.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 161
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 11
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IIndexedService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 162
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Notification.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 163
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 13
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 4
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/SettingsApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 164
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/MyPage.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 165
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/SpecCaptcha.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 166
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/CommentServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 167
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 12
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/OtherTopicDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 168
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/MarkdownUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 169
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/UserCollectsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 170
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Encoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 171
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/BaseService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 172
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/exception/ApiException.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 173
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/RestTemplateConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 174
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/FileUtilHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 175
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CommentService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 10
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Collect.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 176
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/ShiroConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 177
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/CollectMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 178
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/diagnostics/successfully-extracted-files",
          "index" : 0
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/UserApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 78
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/TopicTag.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 103
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IPermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 141
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IAdminUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 157
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/ElasticSearchPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 64
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/SearchDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 49
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/vo/CommentsByTopic.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 117
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/SettingsApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 164
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/NotificationApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 67
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CodeService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 109
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/RoleAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 137
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/BaseApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 80
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IRoleService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 39
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ITopicTagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 135
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyShiroRealm.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 96
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Streams.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 20
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/TopicListDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 53
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Code.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 149
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/FlywayConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 122
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/UserAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 94
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/SensitiveWordService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 50
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/TagsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 142
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/UserTopicsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 144
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/BaseAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 91
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/NotificationsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 126
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/SocialDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 66
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicTagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 70
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/Constants.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 113
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 8
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 2
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Permission.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 31
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/SpringContextUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 21
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/UserCollectsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 170
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/IndexedService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 59
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Captcha.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 24
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/INotificationService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 22
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/WebMvcConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 95
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/IndexedServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 35
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 9
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/LocaleMessageSourceUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 73
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/PermissionMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 97
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "plugins/redis-cache-plugin/src/main/java/co/yiiu/pybbs/plugin/RedisCachePlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 179
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/SocialPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 85
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/BaseController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 145
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/NotificationService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 44
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/SystemConfigAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 87
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/HttpUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 34
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/StringUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 26
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/TopicCommentsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 51
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/ElasticSearchService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 38
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/OAuthUser.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 153
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/CommentAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 119
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/impl/DefaultGenerator.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 93
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/vo/UserWithWebSocketVO.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 160
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/ShiroConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 177
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/RedisCachePlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 25
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/RedisService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 116
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/RolePermission.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 120
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/CommentMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 132
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 13
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "plugins/comment-layer-plugin/src/main/java/co/yiiu/pybbs/plugin/CommentLayerPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 180
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/UserMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 77
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/Message.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 45
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/MyPage.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 165
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/exception/GlobalExceptionHandler.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 128
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Role.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 161
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/SiteConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 83
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MessageEncoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 23
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/RestTemplateConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 174
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Randoms.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 55
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/CookieUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 0
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/GlobalCorsConfiguration.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 181
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IRolePermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 154
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/GifEncoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 133
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/SensitiveWord.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 106
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/RolePermissionMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 111
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/TopicMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 155
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/SmsService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 150
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/DateUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 19
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyCredentialsMatcher.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 58
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/BaseService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 172
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/FreemarkerConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 61
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IOAuthUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 114
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/UserCommentsDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 52
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ICommentService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 138
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/WebSocketConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 86
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/MD5Util.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 6
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 12
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/SystemConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 147
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/vo/package-info.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 124
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/RoleService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 36
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/DataSourceHelper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 68
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/bcrypt/BCrypt.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 158
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/UserController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 100
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CollectService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 101
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MessageDecoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 129
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/SpecCaptcha.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 166
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/JsonUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 123
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/DataSourceConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 136
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ICodeService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 110
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/exception/ApiAssert.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 99
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/AdminUserAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 32
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CommentService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 10
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/test/java/co/yiiu/pybbs/PybbsApplicationTests.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 16
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/OAuthController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 82
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Notification.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 163
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 140
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/SensitiveWordAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 146
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/Result.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 27
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Collect.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 176
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/TopicServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 127
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 7
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/exception/ApiException.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 173
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/User.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 152
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 11
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/SecurityUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 33
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 14
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 15
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/IndexController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 71
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/CollectMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 178
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/GifCaptcha.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 88
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/ScoreDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 72
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/AdminUser.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 104
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/CommentServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 167
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/RoleMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 42
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/bcrypt/BCryptPasswordEncoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 107
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/TagAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 40
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/PermissionAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 60
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ISensitiveWordService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 115
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/EmailService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 139
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/directive/OtherTopicDirective.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 168
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 1
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MyWebSocket.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 74
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/SensitiveWordMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 37
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IIndexedService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 162
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/ServerRunner.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 84
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/CommentController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 28
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/OAuthUserMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 112
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/FileUploadPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 89
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CollectApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 62
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/TopicController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 130
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/TagMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 98
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/test/java/co/yiiu/pybbs/util/StringUtilTest.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 17
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/AdminUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 69
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/package-info.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 46
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/CodeMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 159
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ISystemConfigService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 90
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/TopicAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 75
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/PermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 76
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 5
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/impl/MyGenerator.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 41
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 4
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 3
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/MybatisPlusConfig.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 143
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/front/CommonController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 92
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/model/Tag.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 108
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/TopicTagMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 18
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/AdminUserMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 54
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/IndexAdminController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 81
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/SensitiveWordFilterService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 125
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ITagService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 48
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/SystemConfigMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 102
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Encoder.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 171
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/IBaseGenerator.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 29
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "plugins/redis-cache-plugin/src/main/java/co/yiiu/pybbs/plugin/RedisService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 182
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/interceptor/UserInterceptor.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 156
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/SystemConfigService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 151
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/service/TelegramBotService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 105
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/BaseModel.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 121
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/UserServiceHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 134
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Quant.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 65
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ITopicService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 57
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/IUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 63
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/ShiroTag.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 148
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/PybbsApplication.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 43
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/plugin/CommentLayerPlugin.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 79
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/hook/FileUtilHook.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 175
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/mapper/NotificationMapper.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 47
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TelegramBotController.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 30
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyShiroFilter.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 183
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/OAuthUserService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 56
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/impl/RolePermissionService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 118
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/util/MarkdownUtil.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 169
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/java/co/yiiu/pybbs/service/ICollectService.java",
              "uriBaseId" : "%SRCROOT%",
              "index" : 131
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "java/baseline/expected-extracted-files",
          "index" : 3
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      }, {
        "locations" : [ {
          "physicalLocation" : {
            "artifactLocation" : {
              "uri" : "src/main/resources/static/theme/default/js/app.js",
              "uriBaseId" : "%SRCROOT%",
              "index" : 184
            }
          }
        } ],
        "message" : {
          "text" : ""
        },
        "level" : "none",
        "descriptor" : {
          "id" : "js/baseline/expected-extracted-files",
          "index" : 4
        },
        "properties" : {
          "formattedMessage" : {
            "text" : ""
          }
        }
      } ],
      "executionSuccessful" : true
    } ],
    "artifacts" : [ {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/CookieUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 0
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.context.request.RequestContextHolder;\nimport org.springframework.web.context.request.ServletRequestAttributes;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.Cookie;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.util.Objects;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class CookieUtil {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    public void setCookie(String key, String value) {\n        HttpServletResponse response = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder\n                .getRequestAttributes())).getResponse();\n        Cookie cookie = new Cookie(key, value);\n        cookie.setHttpOnly(true);\n        cookie.setPath(\"/\");\n        cookie.setMaxAge(Integer.parseInt(systemConfigService.selectAllConfig().get(\"cookie_max_age\").toString()));\n        cookie.setDomain(systemConfigService.selectAllConfig().get(\"cookie_domain\").toString());\n        assert response != null;\n        response.addCookie(cookie);\n    }\n\n\n    public String getCookie(String name) {\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder\n                .getRequestAttributes())).getRequest();\n        Cookie[] cookies = request.getCookies();\n        if (cookies != null) {\n            for (Cookie c : cookies) {\n                if (c.getName().equalsIgnoreCase(name)) {\n                    return c.getValue();\n                }\n            }\n        }\n        return null;\n    }\n\n    // cookie\n    public void clearCookie(String name) {\n        HttpServletResponse response = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder\n                .getRequestAttributes())).getResponse();\n        Cookie cookie = new Cookie(name, null);\n        cookie.setHttpOnly(true);\n        cookie.setMaxAge(-1);\n        cookie.setDomain((String) systemConfigService.selectAllConfig().get(\"cookie_domain\"));\n        cookie.setPath(\"/\");\n        assert response != null;\n        response.addCookie(cookie);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 1
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport com.aliyun.oss.OSSClient;\nimport com.aliyun.oss.model.GeneratePresignedUrlRequest;\nimport com.qiniu.http.Response;\nimport com.qiniu.storage.Configuration;\nimport com.qiniu.storage.Region;\nimport com.qiniu.storage.UploadManager;\nimport com.qiniu.util.Auth;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.multipart.MultipartFile;\n\nimport javax.annotation.Resource;\nimport java.io.File;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.math.BigInteger;\nimport java.net.URL;\nimport java.security.MessageDigest;\nimport java.util.Date;\nimport java.util.Objects;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class FileUtil {\n\n    private final Logger log = LoggerFactory.getLogger(FileUtil.class);\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    public static String getFileMD5(InputStream in) {\n        byte[] buffer = new byte[1024];\n        MessageDigest digest;\n        try {\n            digest = MessageDigest.getInstance(\"MD5\");\n            while (true) {\n                int len;\n                if ((len = in.read(buffer, 0, 1024)) == -1) {\n                    in.close();\n                    break;\n                }\n\n                digest.update(buffer, 0, len);\n            }\n        } catch (Exception var6) {\n            var6.printStackTrace();\n            return null;\n        }\n\n        BigInteger bigInt = new BigInteger(1, digest.digest());\n        return bigInt.toString(16);\n    }\n\n    /**\n     * \n     *\n     * @param file       \n     * @param fileName   uuid\n     * @param customPath \n     *                    avatar/admin  /  avatar\n     * @return\n     */\n    public String upload(MultipartFile file, String fileName, String customPath) {\n        try {\n            if (file == null || file.isEmpty()) return null;\n\n            if (StringUtils.isEmpty(fileName)) fileName = StringUtil.uuid();\n            String suffix = \".\" + Objects.requireNonNull(file.getContentType()).split(\"/\")[1];\n            // \n            File savePath = new File(systemConfigService.selectAllConfig().get(\"upload_path\").toString() + customPath);\n            if (!savePath.exists()) savePath.mkdirs();\n\n            // \n            String localPath = systemConfigService.selectAllConfig().get(\"upload_path\").toString() + customPath + \"/\" + fileName + suffix;\n            File file1 = new File(localPath);\n            if (file1.exists()) {\n                file1.delete();\n            }\n\n            file.transferTo(file1);\n\n            // \n            return systemConfigService.selectAllConfig().get(\"static_url\") + customPath + \"/\" + fileName +\n                    suffix + \"?v=\" + StringUtil.randomNumber(6);\n        } catch (IOException e) {\n            log.error(e.getMessage());\n            e.printStackTrace();\n            return null;\n        }\n    }\n\n    /**\n     * @param file       \n     * @param fileName   \n     * @param customPath ossbucket\"\"\n     *                   : file 2021-03-08/test/avatar customPath 2021-03-08/test/avatar\n     * @return\n     */\n    public String ossUpload(MultipartFile file, String fileName, String customPath) {\n        try {\n            String baseUrl = systemConfigService.selectAllConfig().get(\"base_url\");\n            String ossKey = systemConfigService.selectAllConfig().get(\"oss_key\");\n            String ossSecret = systemConfigService.selectAllConfig().get(\"oss_secret\");\n            String ossBucket = systemConfigService.selectAllConfig().get(\"oss_bucket\");\n            String ossEndPoint = systemConfigService.selectAllConfig().get(\"oss_end_point\");\n            if (StringUtils.isEmpty(fileName)) fileName = StringUtil.uuid();\n            String suffix = \".\" + Objects.requireNonNull(file.getContentType()).split(\"/\")[1];\n            fileName += suffix;\n            OSSClient ossClient = new OSSClient(ossEndPoint, ossKey, ossSecret);\n            ossClient.putObject(ossBucket, customPath + \"/\" + fileName, file.getInputStream());\n            ossClient.shutdown();\n            return baseUrl + \"/common/show_img?name=\" + customPath + \"/\" + fileName;\n        } catch (IOException e) {\n            log.error(e.getMessage());\n            return null;\n        }\n    }\n\n    public String generatorOssUrl(String name) {\n        String ossKey = systemConfigService.selectAllConfig().get(\"oss_key\");\n        String ossSecret = systemConfigService.selectAllConfig().get(\"oss_secret\");\n        String ossBucket = systemConfigService.selectAllConfig().get(\"oss_bucket\");\n        String ossEndPoint = systemConfigService.selectAllConfig().get(\"oss_end_point\");\n        Date expires = new Date(new Date().getTime() + 1000 * 60 * 60); // 1\n        GeneratePresignedUrlRequest generatePresignedUrlRequest = new GeneratePresignedUrlRequest(ossBucket, name);\n        generatePresignedUrlRequest.setExpiration(expires);\n        OSSClient client = new OSSClient(ossEndPoint, ossKey, ossSecret);\n        URL url = client.generatePresignedUrl(generatePresignedUrlRequest);\n        return url.toString();\n    }\n\n    public String qiniuUpload(MultipartFile file, String fileName, String customPath) {\n        try {\n            String qiniuKey = systemConfigService.selectAllConfig().get(\"qiniu_key\");\n            String qiniuSecret = systemConfigService.selectAllConfig().get(\"qiniu_secret\");\n            String qiniuBucket = systemConfigService.selectAllConfig().get(\"qiniu_bucket\");\n            String qiniuDomain = systemConfigService.selectAllConfig().get(\"qiniu_domain\");\n            if (StringUtils.isEmpty(fileName)) fileName = StringUtil.uuid();\n            String suffix = \".\" + Objects.requireNonNull(file.getContentType()).split(\"/\")[1];\n            fileName += suffix;\n            Configuration cfg = new Configuration(Region.region2());\n            UploadManager uploadManager = new UploadManager(cfg);\n            Auth auth = Auth.create(qiniuKey, qiniuSecret);\n            //keyhash\n            String key = fileName;\n            String upToken = auth.uploadToken(qiniuBucket, key);\n            Response response = uploadManager.put(file.getInputStream(), key, upToken, null, null);\n            //response.bodyString(): {\"hash\":\"FrvhXY3VZrmU6_vUYLdQtk1KKlUH\",\"key\":\"FrvhXY3VZrmU6_vUYLdQtk1KKlUH\"}\n            return qiniuDomain + \"/\" + fileName;\n        } catch (IOException e) {\n            log.error(e.getMessage());\n            return null;\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 2
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.identicon;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.HashUtil;\nimport co.yiiu.pybbs.util.MD5Util;\nimport co.yiiu.pybbs.util.StringUtil;\nimport co.yiiu.pybbs.util.identicon.generator.IBaseGenerator;\nimport co.yiiu.pybbs.util.identicon.generator.impl.MyGenerator;\nimport com.google.common.base.Preconditions;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport javax.imageio.ImageIO;\nimport java.awt.*;\nimport java.awt.image.BufferedImage;\nimport java.awt.image.RenderedImage;\nimport java.io.ByteArrayOutputStream;\nimport java.io.File;\nimport java.io.IOException;\nimport java.io.UncheckedIOException;\nimport java.util.Base64;\n\n/**\n * Author: Bryant Hang\n * Date: 15/1/10\n * Time: 2:42\n */\n@Component\npublic class Identicon {\n\n    private final Logger log = LoggerFactory.getLogger(Identicon.class);\n\n    private final IBaseGenerator generator;\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    public Identicon() {\n        this.generator = new MyGenerator();\n    }\n\n    public BufferedImage create(String hash, int size) {\n        Preconditions.checkArgument(size > 0 && !StringUtils.isEmpty(hash));\n\n        boolean[][] array = generator.getBooleanValueArray(hash);\n\n        //        int ratio = DoubleMath.roundToInt(size / 5.0, RoundingMode.HALF_UP);\n        int ratio = size / 6;\n\n        BufferedImage identicon = new BufferedImage(ratio * 6, ratio * 6, BufferedImage.TYPE_INT_ARGB);\n        Graphics graphics = identicon.getGraphics();\n\n        graphics.setColor(generator.getBackgroundColor()); // \n        graphics.fillRect(0, 0, identicon.getWidth(), identicon.getHeight());\n\n        graphics.setColor(generator.getForegroundColor()); // \n        for (int i = 0; i < 5; i++) {\n            for (int j = 0; j < 5; j++) {\n                if (array[i][j]) {\n                    graphics.fillRect(j * ratio + 35, i * ratio + 35, ratio, ratio);\n                }\n            }\n        }\n\n        return identicon;\n    }\n\n    public static String imgToBase64String(RenderedImage img, String formatName) {\n        ByteArrayOutputStream os = new ByteArrayOutputStream();\n        try {\n            ImageIO.write(img, formatName, os);\n            return Base64.getEncoder().encodeToString(os.toByteArray());\n        } catch (final IOException ioe) {\n            throw new UncheckedIOException(ioe);\n        }\n    }\n\n    public String generator() {\n        Identicon identicon = new Identicon();\n        String md5 = MD5Util.getMD5String(StringUtil.randomString(6));\n        BufferedImage image = identicon.create(md5, 300);\n        return \"data:image/png;base64,\" + imgToBase64String(image, \"png\");\n    }\n\n    public String generator(String username) {\n        Identicon identicon = new Identicon();\n        String md5 = HashUtil.md5(StringUtil.randomString(6));\n        BufferedImage image = identicon.create(md5, 420);\n        return saveFile(username, image);\n    }\n\n    public String saveFile(String username, BufferedImage image) {\n        String fileName = \"avatar.png\";\n        String userAvatarPath = \"avatar/\" + username + \"/\";\n        try {\n            File file = new File(systemConfigService.selectAllConfig().get(\"upload_path\").toString() + userAvatarPath);\n            if (!file.exists()) file.mkdirs();\n            File file1 = new File(systemConfigService.selectAllConfig().get(\"upload_path\").toString() + userAvatarPath + fileName);\n            if (!file1.exists()) file1.createNewFile();\n            ImageIO.write(image, \"PNG\", file1);\n            return systemConfigService.selectAllConfig().get(\"static_url\").toString() + userAvatarPath + fileName;\n        } catch (IOException e) {\n            log.error(e.getLocalizedMessage());\n        }\n        return null;\n    }\n\n    //  public String saveFileToQiniu(byte[] data) {\n    //    try {\n    //      //Zone\n    //      Configuration cfg = new Configuration(Zone.zone2());\n    //      //...\n    //      UploadManager uploadManager = new UploadManager(cfg);\n    //      Auth auth = Auth.create(siteConfig.getUpload().getQiniu().getAccessKey(), siteConfig.getUpload().getQiniu()\n    // .getSecretKey());\n    //      String uploadToken = auth.uploadToken(siteConfig.getUpload().getQiniu().getBucket());\n    //      Response response = uploadManager.put(data, null, uploadToken, null, null, true);\n    //      DefaultPutRet defaultPutRet = JsonUtil.jsonToObject(response.bodyString(), DefaultPutRet.class);\n    //      return siteConfig.getUpload().getQiniu().getDomain() + defaultPutRet.key;\n    //    } catch (QiniuException e) {\n    //      log.error(e.getLocalizedMessage());\n    //    }\n    //    return \"\";\n    //  }\n\n    //  public static void main(String[] args) {\n    //    System.out.println(new Identicon().generator());\n    //  }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 3
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.exception.ApiAssert;\nimport co.yiiu.pybbs.model.Code;\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.*;\nimport co.yiiu.pybbs.util.*;\nimport co.yiiu.pybbs.util.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.*;\nimport org.springframework.web.multipart.MultipartFile;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpSession;\nimport java.util.*;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@RestController\n@RequestMapping(\"/api\")\npublic class IndexApiController extends BaseApiController {\n\n    @Resource\n    private IUserService userService;\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private CookieUtil cookieUtil;\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ITagService tagService;\n    @Resource\n    private FileUtil fileUtil;\n    @Resource\n    private ICodeService codeService;\n\n    // \n    @GetMapping({\"/\", \"/index\"})\n    public Result index(@RequestParam(defaultValue = \"1\") Integer pageNo, @RequestParam(defaultValue = \"all\") String\n            tab) {\n        MyPage<Map<String, Object>> page = topicService.selectAll(pageNo, tab);\n        for (Map<String, Object> map : page.getRecords()) {\n            Object content = map.get(\"content\");\n            map.put(\"content\", StringUtils.isEmpty(content) ? null : SensitiveWordUtil.replaceSensitiveWord(content\n                    .toString(), \"*\", SensitiveWordUtil.MinMatchType));\n        }\n        return success(page);\n    }\n\n    // \n    @GetMapping(\"/tag/{name}\")\n    public Result topicsByTagName(@RequestParam(defaultValue = \"1\") Integer pageNo, @PathVariable String name) {\n        Tag tag = tagService.selectByName(name);\n        if (tag == null) {\n            return error(\"\");\n        } else {\n            MyPage<Map<String, Object>> iPage = tagService.selectTopicByTagId(tag.getId(), pageNo);\n            Map<String, Object> result = new HashMap<>();\n            result.put(\"tag\", tag);\n            result.put(\"page\", iPage);\n            return success(result);\n        }\n    }\n\n    // \n    @PostMapping(\"/login\")\n    public Result login(@RequestBody Map<String, String> body, HttpSession session) {\n        String username = body.get(\"username\");\n        String password = body.get(\"password\");\n        String captcha = body.get(\"captcha\");\n        String _captcha = (String) session.getAttribute(\"_captcha\");\n        ApiAssert.notTrue(_captcha == null || StringUtils.isEmpty(captcha), \"\");\n        ApiAssert.notTrue(!_captcha.equalsIgnoreCase(captcha), \"\");\n        ApiAssert.notEmpty(username, \"\");\n        ApiAssert.notEmpty(password, \"\");\n        User user = userService.selectByUsername(username);\n        ApiAssert.notNull(user, \"\");\n        ApiAssert.isTrue(new BCryptPasswordEncoder().matches(password, user.getPassword()), \"\");\n        return this.doUserStorage(session, user);\n    }\n\n    // \n    @PostMapping(\"/register\")\n    public Result register(@RequestBody Map<String, String> body, HttpSession session) {\n        String username = body.get(\"username\");\n        String password = body.get(\"password\");\n        String email = body.get(\"email\");\n        String captcha = body.get(\"captcha\");\n        String _captcha = (String) session.getAttribute(\"_captcha\");\n        ApiAssert.notTrue(_captcha == null || StringUtils.isEmpty(captcha), \"\");\n        ApiAssert.notTrue(!_captcha.equalsIgnoreCase(captcha), \"\");\n        ApiAssert.notEmpty(username, \"\");\n        ApiAssert.notEmpty(password, \"\");\n        ApiAssert.notEmpty(email, \"\");\n        ApiAssert.isTrue(StringUtil.check(username, StringUtil.USERNAMEREGEX), \"a-z,A-Z,0-92-16\");\n        ApiAssert.isTrue(StringUtil.check(email, StringUtil.EMAILREGEX), \"\");\n        User user = userService.selectByUsername(username);\n        ApiAssert.isNull(user, \"\");\n        User emailUser = userService.selectByEmail(email);\n        ApiAssert.isNull(emailUser, \"\");\n        user = userService.addUser(username, password, null, email, null, null, true);\n        return this.doUserStorage(session, user);\n    }\n\n    // \n    @GetMapping(\"/sms_code\")\n    public Result sms_code(String captcha, String mobile, HttpSession session) {\n        String _captcha = (String) session.getAttribute(\"_captcha\");\n        ApiAssert.notTrue(_captcha == null || StringUtils.isEmpty(captcha), \"\");\n        ApiAssert.notTrue(!_captcha.equalsIgnoreCase(captcha), \"\");\n        ApiAssert.notEmpty(mobile, \"\");\n        ApiAssert.isTrue(StringUtil.check(mobile, StringUtil.MOBILEREGEX), \"\");\n        boolean b = codeService.sendSms(mobile);\n        if (!b) {\n            return error(\"\");\n        } else {\n            return success();\n        }\n    }\n\n    // +\n    @PostMapping(\"/mobile_login\")\n    public Result mobile_login(@RequestBody Map<String, String> body, HttpSession session) {\n        String mobile = body.get(\"mobile\");\n        String code = body.get(\"code\");\n        String captcha = body.get(\"captcha\");\n        String _captcha = (String) session.getAttribute(\"_captcha\");\n        ApiAssert.notTrue(_captcha == null || StringUtils.isEmpty(captcha), \"\");\n        ApiAssert.notTrue(!_captcha.equalsIgnoreCase(captcha), \"\");\n        ApiAssert.notEmpty(mobile, \"\");\n        ApiAssert.isTrue(StringUtil.check(mobile, StringUtil.MOBILEREGEX), \"\");\n        ApiAssert.notEmpty(code, \"\");\n        Code validateCode = codeService.validateCode(null, null, mobile, code);\n        ApiAssert.notTrue(validateCode == null, \"\");\n        User user = userService.addUserWithMobile(mobile);\n        return doUserStorage(session, user);\n    }\n\n    // \n    // \n    // @PostMapping(\"/forget_password\")\n    //  public Result forget_password(@RequestBody Map<String, String> body, HttpSession session) {\n    //    String email = body.get(\"email\");\n    //    String captcha = body.get(\"captcha\");\n    //    String _captcha = (String) session.getAttribute(\"_captcha\");\n    //    ApiAssert.notTrue(_captcha == null || StringUtils.isEmpty(captcha), \"\");\n    //    ApiAssert.notTrue(!_captcha.equalsIgnoreCase(captcha), \"\");\n    //    ApiAssert.notEmpty(email, \"\");\n    //    ApiAssert.isTrue(StringUtil.check(email, StringUtil.EMAILREGEX), \"\");\n    //    emailService.send\n    //  }\n\n    // \n    private Result doUserStorage(HttpSession session, User user) {\n        // session\n        if (session != null) {\n            session.setAttribute(\"_user\", user);\n            session.removeAttribute(\"_captcha\");\n        }\n        // tokencookie\n        cookieUtil.setCookie(systemConfigService.selectAllConfig().get(\"cookie_name\").toString(), user.getToken());\n        Map<String, Object> map = new HashMap<>();\n        map.put(\"user\", user);\n        map.put(\"token\", user.getToken());\n        return success(map);\n    }\n\n    // \n    @GetMapping(\"/tags\")\n    public Result tags(@RequestParam(defaultValue = \"1\") Integer pageNo) {\n        return success(tagService.selectAll(pageNo, null, null));\n    }\n\n    // \n    @PostMapping(\"/upload\")\n    @ResponseBody\n    public Result upload(@RequestParam(\"file\") MultipartFile[] files, String type, HttpSession session) {\n        User user = getApiUser();\n        ApiAssert.isTrue(user.getActive(), \"\");\n        ApiAssert.notEmpty(type, \"\");\n        Map<String, Object> resultMap = new HashMap<>();\n        List<String> urls = new ArrayList<>();\n        List<String> errors = new ArrayList<>();\n        for (int i = 0; i < files.length; i++) {\n            String url;\n            MultipartFile file = files[i];\n            String suffix = \".\" + Objects.requireNonNull(file.getContentType()).split(\"/\")[1];\n            if (!Arrays.asList(\".jpg\", \".png\", \".gif\", \".jpeg\", \".mp4\").contains(suffix.toLowerCase())) {\n                errors.add(\"[\" + (i + 1) + \"]: \" + \"\");\n                continue;\n            }\n            long size = file.getSize();\n            // \n            if (type.equalsIgnoreCase(\"video\")) {\n                long uploadVideoSizeLimit = Long.parseLong(systemConfigService.selectAllConfig().get(\"upload_video_size_limit\").toString());\n                if (size > uploadVideoSizeLimit * 1024 * 1024) {\n                    errors.add(\"[\" + (i + 1) + \"]: \" + \" \" + uploadVideoSizeLimit + \"MB \");\n                    continue;\n                }\n            } else {\n                long uploadImageSizeLimit = Long.parseLong(systemConfigService.selectAllConfig().get(\"upload_image_size_limit\").toString());\n                if (size > uploadImageSizeLimit * 1024 * 1024) {\n                    errors.add(\"[\" + (i + 1) + \"]: \" + \" \" + uploadImageSizeLimit + \"MB \");\n                    continue;\n                }\n            }\n            if (type.equalsIgnoreCase(\"avatar\")) { // \n                // url\n                url = fileUtil.upload(file, \"avatar\", \"avatar/\" + user.getUsername());\n                if (url != null) {\n                    // \n                    User user1 = userService.selectById(user.getId());\n                    user1.setAvatar(url);\n                    // \n                    userService.update(user1);\n                    // session\n                    if (session != null) session.setAttribute(\"_user\", user1);\n                }\n            } else if (type.equalsIgnoreCase(\"topic\")) { // \n                url = fileUtil.upload(file, null, \"topic/\" + user.getUsername());\n            } else if (type.equalsIgnoreCase(\"video\")) { // \n                url = fileUtil.upload(file, null, \"video/\" + user.getUsername());\n            } else {\n                errors.add(\"[\" + (i + 1) + \"]: \" + \"\");\n                continue;\n            }\n            if (url == null) {\n                errors.add(\"[\" + (i + 1) + \"]: \" + \"\");\n                continue;\n            }\n            urls.add(url);\n        }\n        resultMap.put(\"urls\", urls);\n        resultMap.put(\"errors\", errors);\n        return success(resultMap);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 4
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.UserMapper;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.*;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.SpringContextUtil;\nimport co.yiiu.pybbs.util.StringUtil;\nimport co.yiiu.pybbs.util.bcrypt.BCryptPasswordEncoder;\nimport co.yiiu.pybbs.util.identicon.Identicon;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\nimport org.springframework.context.annotation.Lazy;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.context.request.RequestContextHolder;\nimport org.springframework.web.context.request.ServletRequestAttributes;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Objects;\nimport java.util.UUID;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class UserService implements IUserService {\n\n    @Resource\n    private UserMapper userMapper;\n    @Resource\n    @Lazy\n    private ICollectService collectService;\n    @Resource\n    @Lazy\n    private ITopicService topicService;\n    @Resource\n    @Lazy\n    private ICommentService commentService;\n    @Resource\n    private Identicon identicon;\n    @Resource\n    private INotificationService notificationService;\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private ICodeService codeService;\n\n    // \n    @Override\n    public User selectByUsername(String username) {\n        QueryWrapper<User> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(User::getUsername, username);\n        return userMapper.selectOne(wrapper);\n    }\n\n    // tokentoken\n    // uuidtoken\n    //  : )\n    private String generateToken() {\n        String token = UUID.randomUUID().toString();\n        User user = this.selectByToken(token);\n        if (user != null) {\n            return this.generateToken();\n        }\n        return token;\n    }\n\n    /**\n     * \n     *\n     * @param username\n     * @param password\n     * @param avatar\n     * @param email\n     * @param bio\n     * @param website\n     * @param needActiveEmail \n     *                        \n     *                        Github\n     * @return\n     */\n    @Override\n    public User addUser(String username, String password, String avatar, String email, String bio, String website,\n                        boolean needActiveEmail) {\n        String token = this.generateToken();\n        User user = new User();\n        user.setUsername(username);\n        if (!StringUtils.isEmpty(password)) user.setPassword(new BCryptPasswordEncoder().encode(password));\n        user.setToken(token);\n        user.setInTime(new Date());\n        if (avatar == null) avatar = identicon.generator(username);\n        user.setAvatar(avatar);\n        user.setEmail(email);\n        user.setBio(bio);\n        user.setWebsite(website);\n        user.setActive(systemConfigService.selectAllConfig().get(\"user_need_active\").equals(\"0\"));\n        userMapper.insert(user);\n        if (needActiveEmail) {\n            // \n            new Thread(() -> {\n                String title = \"%s\";\n                String content = \"%s&nbsp;&nbsp;<a href='%s/active?email=%s&code=${code}'></a>\";\n                codeService.sendEmail(user.getId(), email, String.format(title, systemConfigService.selectAllConfig().get(\n                        \"base_url\").toString()), String.format(content,\n                        systemConfigService.selectAllConfig().get(\"name\").toString(), systemConfigService.selectAllConfig().get(\n                                \"base_url\").toString(), email));\n            }).start();\n        }\n        // null\n        return this.selectById(user.getId());\n    }\n\n    // \n    private String generateUsername() {\n        String username = StringUtil.randomString(6);\n        if (this.selectByUsername(username) != null) {\n            return this.generateUsername();\n        }\n        return username;\n    }\n\n    // /\n    @Override\n    public User addUserWithMobile(String mobile) {\n        // \n        User user = selectByMobile(mobile);\n        if (user == null) {\n            String token = this.generateToken();\n            String username = generateUsername();\n            user = new User();\n            user.setUsername(username);\n            user.setToken(token);\n            user.setInTime(new Date());\n            user.setAvatar(identicon.generator(username));\n            user.setEmail(null);\n            user.setBio(null);\n            user.setWebsite(null);\n            user.setActive(true);\n            userMapper.insert(user);\n            // null\n            return this.selectById(user.getId());\n        }\n        return user;\n    }\n\n    // token\n    @Override\n    public User selectByToken(String token) {\n        QueryWrapper<User> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(User::getToken, token);\n        return userMapper.selectOne(wrapper);\n    }\n\n    // mobile\n    @Override\n    public User selectByMobile(String mobile) {\n        QueryWrapper<User> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(User::getMobile, mobile);\n        return userMapper.selectOne(wrapper);\n    }\n\n    // email\n    @Override\n    public User selectByEmail(String email) {\n        QueryWrapper<User> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(User::getEmail, email);\n        return userMapper.selectOne(wrapper);\n    }\n\n    @Override\n    public User selectById(Integer id) {\n        return userMapper.selectById(id);\n    }\n\n    @Override\n    public User selectByIdWithoutCache(Integer id) {\n        return userMapper.selectById(id);\n    }\n\n    // \n    @Override\n    public List<User> selectTop(Integer limit) {\n        QueryWrapper<User> wrapper = new QueryWrapper<>();\n        wrapper.orderByDesc(\"score\").last(\"limit \" + limit);\n        return userMapper.selectList(wrapper);\n    }\n\n    // \n    @Override\n    public void update(User user) {\n        userMapper.updateById(user);\n        \n        // session\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder\n                .getRequestAttributes())).getRequest();\n        HttpSession session = request.getSession();\n        session.setAttribute(\"_user\", user);\n\n        // springaop\n        SpringContextUtil.getBean(UserService.class).delRedisUser(user);\n    }\n\n    // ------------------------------- admin ------------------------------------------\n\n    @Override\n    public IPage<User> selectAll(Integer pageNo, String username) {\n        MyPage<User> page = new MyPage<>(pageNo, Integer.parseInt((String) systemConfigService.selectAllConfig().get(\"page_size\")));\n        page.setDesc(\"in_time\");\n        QueryWrapper<User> wrapper = new QueryWrapper<>();\n        if (!StringUtils.isEmpty(username)) {\n            wrapper.lambda().eq(User::getUsername, username);\n        }\n        return userMapper.selectPage(page, wrapper);\n    }\n\n    public User selectByIdNoCatch(Integer id) {\n        return userMapper.selectById(id);\n    }\n\n    // \n    @Override\n    public int countToday() {\n        return userMapper.countToday();\n    }\n\n    // \n    @Override\n    public void deleteUser(Integer id) {\n        // \n        notificationService.deleteByUserId(id);\n        // \n        collectService.deleteByUserId(id);\n        // \n        commentService.deleteByUserId(id);\n        // \n        topicService.deleteByUserId(id);\n        // code\n        codeService.deleteByUserId(id);\n        // redis\n        User user = this.selectById(id);\n        SpringContextUtil.getBean(UserService.class).delRedisUser(user);\n        // \n        userMapper.deleteById(id);\n    }\n\n    // redis\n    @Override\n    public void delRedisUser(User user) {\n\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 5
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport java.security.MessageDigest;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2016, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class HashUtil {\n\n    private static final java.security.SecureRandom random = new java.security.SecureRandom();\n\n    private static final char[] HEX_DIGITS = {'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd',\n            'e', 'f'};\n\n    public static String md5(String srcStr) {\n        return hash(\"MD5\", srcStr);\n    }\n\n    public static String sha1(String srcStr) {\n        return hash(\"SHA-1\", srcStr);\n    }\n\n    public static String sha256(String srcStr) {\n        return hash(\"SHA-256\", srcStr);\n    }\n\n    public static String sha384(String srcStr) {\n        return hash(\"SHA-384\", srcStr);\n    }\n\n    public static String sha512(String srcStr) {\n        return hash(\"SHA-512\", srcStr);\n    }\n\n    public static String hash(String algorithm, String srcStr) {\n        try {\n            MessageDigest md = MessageDigest.getInstance(algorithm);\n            byte[] bytes = md.digest(srcStr.getBytes(\"utf-8\"));\n            return toHex(bytes);\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    private static String toHex(byte[] bytes) {\n        StringBuilder ret = new StringBuilder(bytes.length * 2);\n        for (int i = 0; i < bytes.length; i++) {\n            ret.append(HEX_DIGITS[(bytes[i] >> 4) & 0x0f]);\n            ret.append(HEX_DIGITS[bytes[i] & 0x0f]);\n        }\n        return ret.toString();\n    }\n\n    /**\n     * md5 128bit 16bytes\n     * sha1 160bit 20bytes\n     * sha256 256bit 32bytes\n     * sha384 384bit 48bites\n     * sha512 512bit 64bites\n     */\n    public static String generateSalt(int numberOfBytes) {\n        byte[] salt = new byte[numberOfBytes];\n        random.nextBytes(salt);\n        return toHex(salt);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/MD5Util.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 6
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.nio.MappedByteBuffer;\nimport java.nio.channels.FileChannel;\nimport java.security.MessageDigest;\nimport java.security.NoSuchAlgorithmException;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class MD5Util {\n\n    private static Logger log = LoggerFactory.getLogger(MD5Util.class);\n\n    private final static char[] hexDigits = {'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e',\n            'f'};\n    private static MessageDigest messagedigest = null;\n\n    static {\n        try {\n            messagedigest = MessageDigest.getInstance(\"MD5\");\n        } catch (NoSuchAlgorithmException e) {\n            log.error(\"{}MessageDigestMD5Util, errorMessage: {}\", MD5Util.class.getName(), e.getMessage());\n        }\n    }\n\n    private MD5Util() {\n    }\n\n    /**\n     * MD5.MD5(+{})\n     *\n     * @param password \n     * @param salt     \n     * @return String\n     * @author \n     * @date 20140624\n     */\n    public static String getMD5StringWithSalt(String password, String salt) {\n        if (password == null) {\n            throw new IllegalArgumentException(\"passwordnull\");\n        }\n        if (salt.equals(\"\") || salt.length() == 0) {\n            throw new IllegalArgumentException(\"salt\");\n        }\n        if ((salt.lastIndexOf('{') != -1) || (salt.lastIndexOf('}') != -1)) {\n            throw new IllegalArgumentException(\"salt {  }\");\n        }\n        return getMD5String(password + '{' + salt + '}');\n    }\n\n    /**\n     * md5\n     *\n     * @param file \n     * @return String\n     * @throws IOException IO\n     * @author \n     * @date 20140624\n     */\n    public static String getFileMD5String(File file) throws IOException {\n        FileInputStream in = new FileInputStream(file);\n        FileChannel ch = in.getChannel();\n        MappedByteBuffer byteBuffer = ch.map(FileChannel.MapMode.READ_ONLY, 0, file.length());\n        messagedigest.update(byteBuffer);\n        return bufferToHex(messagedigest.digest());\n    }\n\n    /**\n     * MD5\n     *\n     * @param str \n     * @return String\n     * @author \n     * @date 20140624\n     */\n    public static String getMD5String(String str) {\n        return getMD5String(str.getBytes());\n    }\n\n    private static String getMD5String(byte[] bytes) {\n        messagedigest.update(bytes);\n        return bufferToHex(messagedigest.digest());\n    }\n\n    private static String bufferToHex(byte[] bytes) {\n        return bufferToHex(bytes, 0, bytes.length);\n    }\n\n    private static String bufferToHex(byte[] bytes, int m, int n) {\n        StringBuffer stringbuffer = new StringBuffer(2 * n);\n        int k = m + n;\n        for (int l = m; l < k; l++) {\n            appendHexPair(bytes[l], stringbuffer);\n        }\n        return stringbuffer.toString();\n    }\n\n    private static void appendHexPair(byte bt, StringBuffer stringbuffer) {\n        char c0 = hexDigits[(bt & 0xf0) >> 4];\n        char c1 = hexDigits[bt & 0xf];\n        stringbuffer.append(c0);\n        stringbuffer.append(c1);\n    }\n\n    /*\n     * \n     */\n    public static String hexdigest(byte[] paramArrayOfByte) {\n        try {\n            MessageDigest localMessageDigest = MessageDigest.getInstance(\"MD5\");\n            localMessageDigest.update(paramArrayOfByte);\n            byte[] arrayOfByte = localMessageDigest.digest();\n            char[] arrayOfChar = new char[32];\n            int i = 0;\n            int j = 0;\n            for (; ; ) {\n                if (i >= 16) {\n                    return new String(arrayOfChar);\n                }\n                int k = arrayOfByte[i];\n                int m = j + 1;\n                arrayOfChar[j] = hexDigits[(0xF & k >>> 4)];\n                j = m + 1;\n                arrayOfChar[m] = hexDigits[(k & 0xF)];\n                i++;\n            }\n\n        } catch (Exception localException) {\n            return null;\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 7
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport com.aliyuncs.utils.StringUtils;\n\nimport java.util.*;\n\n/**\n *  - DFA\n * <p>\n * https://www.jianshu.com/p/2e84eacc3cc8\n *\n * @author sam\n * @since 2017/9/4\n * <p>\n *  :)\n */\npublic class SensitiveWordUtil {\n\n    /**\n     * \n     */\n    public static final int MinMatchType = 1;      //[\"\",\"\"]\"\"[]\n    public static final int MaxMatchType = 2;      //[\"\",\"\"]\"\"[]\n\n    /**\n     * \n     */\n    public static HashMap sensitiveWordMap;\n\n    /**\n     * DFA\n     *\n     * @param sensitiveWordSet \n     */\n    public static synchronized void init(Set<String> sensitiveWordSet) {\n        initSensitiveWordMap(sensitiveWordSet);\n    }\n\n    /**\n     * DFA\n     *\n     * @param sensitiveWordSet \n     */\n    private static void initSensitiveWordMap(Set<String> sensitiveWordSet) {\n        //\n        sensitiveWordMap = new HashMap(sensitiveWordSet.size());\n        String key;\n        Map nowMap;\n        Map<String, String> newWorMap;\n        //sensitiveWordSet\n        Iterator<String> iterator = sensitiveWordSet.iterator();\n        while (iterator.hasNext()) {\n            //\n            key = iterator.next();\n            nowMap = sensitiveWordMap;\n            for (int i = 0; i < key.length(); i++) {\n                //char\n                char keyChar = key.charAt(i);\n                //\n                Object wordMap = nowMap.get(keyChar);\n                //key\n                if (wordMap != null) {\n                    nowMap = (Map) wordMap;\n                } else {\n                    //mapisEnd0\n                    newWorMap = new HashMap<>();\n                    //\n                    newWorMap.put(\"isEnd\", \"0\");\n                    nowMap.put(keyChar, newWorMap);\n                    nowMap = newWorMap;\n                }\n\n                if (i == key.length() - 1) {\n                    //\n                    nowMap.put(\"isEnd\", \"1\");\n                }\n            }\n        }\n    }\n\n    /**\n     * \n     *\n     * @param txt       \n     * @param matchType  12\n     * @return truefalse\n     */\n    public static boolean contains(String txt, int matchType) {\n        boolean flag = false;\n        for (int i = 0; i < txt.length(); i++) {\n            int matchFlag = checkSensitiveWord(txt, i, matchType); //\n            if (matchFlag > 0) {    //0true\n                flag = true;\n            }\n        }\n        return flag;\n    }\n\n    /**\n     * \n     *\n     * @param txt \n     * @return truefalse\n     */\n    public static boolean contains(String txt) {\n        return contains(txt, MaxMatchType);\n    }\n\n    /**\n     * \n     *\n     * @param txt       \n     * @param matchType  12\n     * @return\n     */\n    public static Set<String> getSensitiveWord(String txt, int matchType) {\n        Set<String> sensitiveWordList = new HashSet<>();\n\n        for (int i = 0; i < txt.length(); i++) {\n            //\n            int length = checkSensitiveWord(txt, i, matchType);\n            if (length > 0) {//,list\n                sensitiveWordList.add(txt.substring(i, i + length));\n                i = i + length - 1;//1for\n            }\n        }\n\n        return sensitiveWordList;\n    }\n\n    /**\n     * \n     *\n     * @param txt \n     * @return\n     */\n    public static Set<String> getSensitiveWord(String txt) {\n        return getSensitiveWord(txt, MaxMatchType);\n    }\n\n    /**\n     * \n     *\n     * @param txt         \n     * @param replaceChar   * ***\n     * @param matchType   \n     * @return\n     */\n    public static String replaceSensitiveWord(String txt, char replaceChar, int matchType) {\n        String resultTxt = txt;\n        //\n        Set<String> set = getSensitiveWord(txt, matchType);\n        Iterator<String> iterator = set.iterator();\n        String word;\n        String replaceString;\n        while (iterator.hasNext()) {\n            word = iterator.next();\n            replaceString = getReplaceChars(replaceChar, word.length());\n            resultTxt = resultTxt.replaceAll(word, replaceString);\n        }\n\n        return resultTxt;\n    }\n\n    /**\n     * \n     *\n     * @param txt         \n     * @param replaceChar   * ***\n     * @return\n     */\n    public static String replaceSensitiveWord(String txt, char replaceChar) {\n        return replaceSensitiveWord(txt, replaceChar, MaxMatchType);\n    }\n\n    /**\n     * \n     *\n     * @param txt        \n     * @param replaceStr   [][]\n     * @param matchType  \n     * @return\n     */\n    public static String replaceSensitiveWord(String txt, String replaceStr, int matchType) {\n        if (StringUtils.isEmpty(txt)) return null;\n        String resultTxt = txt;\n        //\n        Set<String> set = getSensitiveWord(txt, matchType);\n        Iterator<String> iterator = set.iterator();\n        String word;\n        while (iterator.hasNext()) {\n            word = iterator.next();\n            resultTxt = resultTxt.replaceAll(word, replaceStr);\n        }\n\n        return resultTxt;\n    }\n\n    /**\n     * \n     *\n     * @param txt        \n     * @param replaceStr   [][]\n     * @return\n     */\n    public static String replaceSensitiveWord(String txt, String replaceStr) {\n        return replaceSensitiveWord(txt, replaceStr, MaxMatchType);\n    }\n\n    /**\n     * \n     *\n     * @param replaceChar\n     * @param length\n     * @return\n     */\n    private static String getReplaceChars(char replaceChar, int length) {\n        String resultReplace = String.valueOf(replaceChar);\n        for (int i = 1; i < length; i++) {\n            resultReplace += replaceChar;\n        }\n\n        return resultReplace;\n    }\n\n    /**\n     * <br>\n     *\n     * @param txt\n     * @param beginIndex\n     * @param matchType\n     * @return 0\n     */\n    private static int checkSensitiveWord(String txt, int beginIndex, int matchType) {\n        //1\n        boolean flag = false;\n        //0\n        int matchFlag = 0;\n        char word;\n        Map nowMap = sensitiveWordMap;\n        for (int i = beginIndex; i < txt.length(); i++) {\n            word = txt.charAt(i);\n            //key\n            nowMap = (Map) nowMap.get(word);\n            if (nowMap != null) {//\n                //key+1\n                matchFlag++;\n                //,\n                if (\"1\".equals(nowMap.get(\"isEnd\"))) {\n                    //true\n                    flag = true;\n                    //,\n                    if (MinMatchType == matchType) {\n                        break;\n                    }\n                }\n            } else {//\n                break;\n            }\n        }\n        if (matchFlag < 2 || !flag) {//1\n            matchFlag = 0;\n        }\n        return matchFlag;\n    }\n\n    //    public static void main(String[] args) {\n    //\n    //        Set<String> sensitiveWordSet = new HashSet<>();\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        sensitiveWordSet.add(\"\");\n    //        //\n    //        SensitiveWordUtil.init(sensitiveWordSet);\n    //\n    //        System.out.println(\"\" + SensitiveWordUtil.sensitiveWordMap.size());\n    //        String string = \" \"\n    //                + \" \"\n    //                + \" \";\n    //        System.out.println(\"\" + string.length());\n    //\n    //        //\n    //        boolean result = SensitiveWordUtil.contains(string);\n    //        System.out.println(result);\n    //        result = SensitiveWordUtil.contains(string, SensitiveWordUtil.MinMatchType);\n    //        System.out.println(result);\n    //\n    //        //\n    //        Set<String> set = SensitiveWordUtil.getSensitiveWord(string);\n    //        System.out.println(\"\" + set.size() + \"\" + set);\n    //        set = SensitiveWordUtil.getSensitiveWord(string, SensitiveWordUtil.MinMatchType);\n    //        System.out.println(\"\" + set.size() + \"\" + set);\n    //\n    //        //\n    //        String filterStr = SensitiveWordUtil.replaceSensitiveWord(string, '*');\n    //        System.out.println(filterStr);\n    //        filterStr = SensitiveWordUtil.replaceSensitiveWord(string, '*', SensitiveWordUtil.MinMatchType);\n    //        System.out.println(filterStr);\n    //\n    //        String filterStr2 = SensitiveWordUtil.replaceSensitiveWord(string, \"[**]\");\n    //        System.out.println(filterStr2);\n    //        filterStr2 = SensitiveWordUtil.replaceSensitiveWord(string, \"[**]\", SensitiveWordUtil.MinMatchType);\n    //        System.out.println(filterStr2);\n    //    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 8
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.exception.ApiAssert;\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICommentService;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.util.Result;\nimport co.yiiu.pybbs.util.SensitiveWordUtil;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@RestController\n@RequestMapping(\"/api/comment\")\npublic class CommentApiController extends BaseApiController {\n\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    // \n    @PostMapping\n    public Result create(@RequestBody Map<String, String> body) {\n        User user = getApiUser();\n        ApiAssert.isTrue(user.getActive(), \"\");\n        String content = body.get(\"content\");\n        Integer topicId = StringUtils.isEmpty(body.get(\"topicId\")) ? null : Integer.parseInt(body.get(\"topicId\"));\n        Integer commentId = StringUtils.isEmpty(body.get(\"commentId\")) ? null : Integer.parseInt(body.get(\"commentId\"));\n        ApiAssert.notEmpty(content, \"\");\n        ApiAssert.notNull(topicId, \"ID\");\n        Topic topic = topicService.selectById(topicId);\n        ApiAssert.notNull(topic, \"\");\n        // comment\n        Comment comment = new Comment();\n        comment.setCommentId(commentId);\n        comment.setStyle(systemConfigService.selectAllConfig().get(\"content_style\"));\n        comment.setContent(content);\n        comment.setInTime(new Date());\n        comment.setTopicId(topic.getId());\n        comment.setUserId(user.getId());\n        comment = commentService.insert(comment, topic, user);\n        // \n        comment.setContent(SensitiveWordUtil.replaceSensitiveWord(comment.getContent(), \"*\", SensitiveWordUtil.MinMatchType));\n        return success(comment);\n    }\n\n    // \n    // \n    @PutMapping(\"/{id}\")\n    public Result update(@PathVariable Integer id, @RequestBody Map<String, String> body) {\n        User user = getApiUser();\n        String content = body.get(\"content\");\n        ApiAssert.notNull(id, \"ID\");\n        ApiAssert.notEmpty(content, \"\");\n        Comment comment = commentService.selectById(id);\n        ApiAssert.notNull(comment, \"\");\n        ApiAssert.isTrue(comment.getUserId().equals(user.getId()), \"\");\n        comment.setContent(content);\n        commentService.update(comment);\n        comment.setContent(SensitiveWordUtil.replaceSensitiveWord(comment.getContent(), \"*\", SensitiveWordUtil\n                .MinMatchType));\n        return success(comment);\n    }\n\n    // \n    @DeleteMapping(\"/{id}\")\n    public Result delete(@PathVariable Integer id) {\n        User user = getApiUser();\n        Comment comment = commentService.selectById(id);\n        ApiAssert.notNull(comment, \"\");\n        ApiAssert.isTrue(comment.getUserId().equals(user.getId()), \"\");\n        commentService.delete(comment);\n        return success();\n    }\n\n    // \n    @GetMapping(\"/{id}/vote\")\n    public Result vote(@PathVariable Integer id) {\n        User user = getApiUser();\n        Comment comment = commentService.selectById(id);\n        ApiAssert.notNull(comment, \"\");\n        ApiAssert.notTrue(comment.getUserId().equals(user.getId()), \"\");\n        int voteCount = commentService.vote(comment, user);\n        return success(voteCount);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 9
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Comment implements Serializable {\n    private static final long serialVersionUID = 8413239906874427490L;\n\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private Integer topicId;\n    private Integer userId;\n    private String style; // RICHMD\n    private String content;\n    private Date inTime;\n    private Integer commentId;\n    // id\n    private String upIds;\n    private Integer tgMessageId;\n    // true: false: \n    private Boolean status;\n\n    public String getStyle() {\n        return style;\n    }\n\n    public void setStyle(String style) {\n        this.style = style;\n    }\n\n    public String getUpIds() {\n        return upIds;\n    }\n\n    public void setUpIds(String upIds) {\n        this.upIds = upIds;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public Integer getTopicId() {\n        return topicId;\n    }\n\n    public void setTopicId(Integer topicId) {\n        this.topicId = topicId;\n    }\n\n    public Integer getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Integer userId) {\n        this.userId = userId;\n    }\n\n    public String getContent() {\n        return content;\n    }\n\n    public void setContent(String content) {\n        this.content = content;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public Integer getCommentId() {\n        return commentId;\n    }\n\n    public void setCommentId(Integer commentId) {\n        this.commentId = commentId;\n    }\n\n    public Integer getTgMessageId() {\n        return tgMessageId;\n    }\n\n    public void setTgMessageId(Integer tgMessageId) {\n        this.tgMessageId = tgMessageId;\n    }\n\n    public Boolean getStatus() {\n        return status;\n    }\n\n    public void setStatus(Boolean status) {\n        this.status = status;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CommentService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 10
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.config.service.EmailService;\nimport co.yiiu.pybbs.config.service.TelegramBotService;\nimport co.yiiu.pybbs.config.websocket.MyWebSocket;\nimport co.yiiu.pybbs.mapper.CommentMapper;\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.model.vo.CommentsByTopic;\nimport co.yiiu.pybbs.service.*;\nimport co.yiiu.pybbs.util.Message;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.SensitiveWordUtil;\nimport co.yiiu.pybbs.util.StringUtil;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.context.annotation.Lazy;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class CommentService implements ICommentService {\n\n    private final Logger log = LoggerFactory.getLogger(CommentService.class);\n\n    @Resource\n    private CommentMapper commentMapper;\n    @Resource\n    @Lazy\n    private ITopicService topicService;\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    @Lazy\n    private IUserService userService;\n    @Resource\n    private INotificationService notificationService;\n    @Resource\n    private EmailService emailService;\n    @Resource\n    private TelegramBotService telegramBotService;\n\n    // id\n    @Override\n    public List<CommentsByTopic> selectByTopicId(Integer topicId) {\n        List<CommentsByTopic> commentsByTopics = commentMapper.selectByTopicId(topicId);\n        // redis\n        for (CommentsByTopic commentsByTopic : commentsByTopics) {\n            commentsByTopic.setContent(SensitiveWordUtil.replaceSensitiveWord(commentsByTopic.getContent(), \"*\",\n                    SensitiveWordUtil.MinMatchType));\n        }\n        return commentsByTopics;\n    }\n\n    // \n    @Override\n    public void deleteByTopicId(Integer topicId) {\n        QueryWrapper<Comment> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Comment::getTopicId, topicId);\n        commentMapper.delete(wrapper);\n    }\n\n    // id\n    @Override\n    public void deleteByUserId(Integer userId) {\n        QueryWrapper<Comment> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Comment::getUserId, userId);\n        commentMapper.delete(wrapper);\n    }\n\n    // \n    @Override\n    public Comment insert(Comment comment, Topic topic, User user) {\n        if (systemConfigService.selectAllConfig().get(\"comment_need_examine\").equals(\"1\")) {\n            comment.setStatus(false);// \n        } else {\n            comment.setStatus(true);// \n        }\n        commentMapper.insert(comment);\n\n        // +1\n        topic.setCommentCount(topic.getCommentCount() + 1);\n        topicService.update(topic, null);\n\n        // \n        user.setScore(user.getScore() + Integer.parseInt(systemConfigService.selectAllConfig().get\n                (\"create_comment_score\")));\n        userService.update(user);\n\n        // \n        // \n        if (comment.getCommentId() != null) {\n            Comment targetComment = this.selectById(comment.getCommentId());\n            if (!user.getId().equals(targetComment.getUserId())) {\n                notificationService.insert(user.getId(), targetComment.getUserId(), topic.getId(), \"REPLY\", comment\n                        .getContent());\n\n                String emailTitle = \" %s  %s \";\n                // websocket\n                if (systemConfigService.selectAllConfig().get(\"websocket\").equals(\"1\")) {\n                    MyWebSocket.emit(targetComment.getUserId(), new Message(\"notifications\", String.format(emailTitle, topic\n                            .getTitle(), user.getUsername())));\n                    MyWebSocket.emit(targetComment.getUserId(), new Message(\"notification_notread\", 1));\n                }\n                // \n                User targetUser = userService.selectById(targetComment.getUserId());\n                if (!StringUtils.isEmpty(targetUser.getEmail()) && targetUser.getEmailNotification()) {\n                    String emailContent = \": %s <br><a href='%s/topic/%s' target='_blank'></a>\";\n                    new Thread(() -> emailService.sendEmail(targetUser.getEmail(), String.format(emailTitle, topic.getTitle(),\n                            user.getUsername()), String.format(emailContent, comment.getContent(), systemConfigService\n                            .selectAllConfig().get(\"base_url\"), topic.getId()))).start();\n                }\n            }\n        }\n        // \n        if (!user.getId().equals(topic.getUserId())) {\n            notificationService.insert(user.getId(), topic.getUserId(), topic.getId(), \"COMMENT\", comment.getContent());\n            // \n            String emailTitle = \"%s  %s \";\n            // websocket\n            if (systemConfigService.selectAllConfig().get(\"websocket\").equals(\"1\")) {\n                MyWebSocket.emit(topic.getUserId(), new Message(\"notifications\", String.format(emailTitle, user.getUsername()\n                        , topic.getTitle())));\n                MyWebSocket.emit(topic.getUserId(), new Message(\"notification_notread\", 1));\n            }\n            User targetUser = userService.selectById(topic.getUserId());\n            if (!StringUtils.isEmpty(targetUser.getEmail()) && targetUser.getEmailNotification()) {\n                String emailContent = \": %s <br><a href='%s/topic/%s' target='_blank'></a>\";\n                new Thread(() -> emailService.sendEmail(targetUser.getEmail(), String.format(emailTitle, user.getUsername(),\n                        topic.getTitle()), String.format(emailContent, comment.getContent(), systemConfigService.selectAllConfig\n                        ().get(\"base_url\"), topic.getId()))).start();\n            }\n        }\n\n        //  TODO\n\n        // TG\n        new Thread(() -> {\n            String formatMessage;\n            String domain = systemConfigService.selectAllConfig().get(\"base_url\");\n            if (systemConfigService.selectAllConfig().get(\"content_style\").equals(\"MD\")) {\n                formatMessage = String.format(\"%s  [%s](%s)  %s\", user.getUsername(), topic.getTitle(), domain + \"/topic/\" + topic.getId(), StringUtil.removeSpecialChar(comment.getContent()));\n            } else {\n                formatMessage = String.format(\"%s  <a href=\\\"%s\\\">%s</a>  %s\", user.getUsername(), domain + \"/topic/\" + topic.getId(), topic.getTitle(), StringUtil.removeSpecialChar(comment.getContent()));\n            }\n            Integer message_id = telegramBotService.init().sendMessage(formatMessage, true, null);\n            Comment newComment = new Comment();\n            newComment.setId(comment.getId());\n            newComment.setTgMessageId(message_id);\n            commentMapper.updateById(newComment);\n\n        }).start();\n\n        return comment;\n    }\n\n    @Override\n    public Comment selectById(Integer id) {\n        return commentMapper.selectById(id);\n    }\n\n    @Override\n    public Comment selectByTgMessageId(Integer messageId) {\n        QueryWrapper<Comment> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Comment::getTgMessageId, messageId);\n        List<Comment> comments = commentMapper.selectList(wrapper);\n        return comments.size() > 0 ? comments.get(0) : null;\n    }\n\n    // \n    @Override\n    public void update(Comment comment) {\n        commentMapper.updateById(comment);\n    }\n\n    // \n    @Override\n    public int vote(Comment comment, User user) {\n        String upIds = comment.getUpIds();\n        // id\n        Set<String> strings = StringUtils.commaDelimitedListToSet(upIds);\n        // idsetid\n        Integer userScore = user.getScore();\n        if (strings.contains(String.valueOf(user.getId()))) { // \n            strings.remove(String.valueOf(user.getId()));\n            userScore -= Integer.parseInt(systemConfigService.selectAllConfig().get(\"up_comment_score\"));\n        } else { // \n            strings.add(String.valueOf(user.getId()));\n            userScore += Integer.parseInt(systemConfigService.selectAllConfig().get(\"up_comment_score\"));\n        }\n        // id\n        comment.setUpIds(StringUtils.collectionToCommaDelimitedString(strings));\n        // \n        this.update(comment);\n        // \n        user.setScore(userScore);\n        userService.update(user);\n        return strings.size();\n    }\n\n    // \n    @Override\n    public void delete(Comment comment) {\n        if (comment != null) {\n            // -1\n            Topic topic = topicService.selectById(comment.getTopicId());\n            topic.setCommentCount(topic.getCommentCount() - 1);\n            topicService.update(topic, null);\n            // \n            User user = userService.selectById(comment.getUserId());\n            user.setScore(user.getScore() - Integer.parseInt(systemConfigService.selectAllConfig().get\n                    (\"delete_comment_score\").toString()));\n            userService.update(user);\n            // \n            commentMapper.deleteById(comment.getId());\n        }\n    }\n\n    // \n    @Override\n    public MyPage<Map<String, Object>> selectByUserId(Integer userId, Integer pageNo, Integer pageSize) {\n        MyPage<Map<String, Object>> iPage = new MyPage<>(pageNo, pageSize == null ? Integer.parseInt(systemConfigService\n                .selectAllConfig().get(\"page_size\").toString()) : pageSize);\n        MyPage<Map<String, Object>> page = commentMapper.selectByUserId(iPage, userId);\n        for (Map<String, Object> map : page.getRecords()) {\n            Object content = map.get(\"content\");\n            map.put(\"content\", StringUtils.isEmpty(content) ? null : SensitiveWordUtil.replaceSensitiveWord(content\n                    .toString(), \"*\", SensitiveWordUtil.MinMatchType));\n        }\n        return page;\n    }\n\n    // ---------------------------- admin ----------------------------\n\n    @Override\n    public MyPage<Map<String, Object>> selectAllForAdmin(Integer pageNo, String startDate, String endDate, String username) {\n        MyPage<Map<String, Object>> iPage = new MyPage<>(pageNo, Integer.parseInt((String) systemConfigService.selectAllConfig().get(\"page_size\")));\n        return commentMapper.selectAllForAdmin(iPage, startDate, endDate, username);\n    }\n\n    // \n    @Override\n    public int countToday() {\n        return commentMapper.countToday();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 11
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.exception.ApiAssert;\nimport co.yiiu.pybbs.model.Collect;\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.model.vo.CommentsByTopic;\nimport co.yiiu.pybbs.service.*;\nimport co.yiiu.pybbs.util.IpUtil;\nimport co.yiiu.pybbs.util.Result;\nimport co.yiiu.pybbs.util.SensitiveWordUtil;\nimport org.jsoup.Jsoup;\nimport org.jsoup.safety.Whitelist;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@RestController\n@RequestMapping(\"/api/topic\")\npublic class TopicApiController extends BaseApiController {\n\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ITagService tagService;\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private IUserService userService;\n    @Resource\n    private ICollectService collectService;\n\n    // \n    @GetMapping(\"/{id}\")\n    public Result detail(@PathVariable Integer id, HttpServletRequest request) {\n        Map<String, Object> map = new HashMap<>();\n        // \n        Topic topic = topicService.selectById(id);\n        // \n        List<Tag> tags = tagService.selectByTopicId(id);\n        // \n        List<CommentsByTopic> comments = commentService.selectByTopicId(id);\n        // \n        User topicUser = userService.selectById(topic.getUserId());\n        // \n        List<Collect> collects = collectService.selectByTopicId(id);\n        // \n        User user = getApiUser(false);\n        if (user != null) {\n            Collect collect = collectService.selectByTopicIdAndUserId(id, user.getId());\n            map.put(\"collect\", collect);\n        }\n        // +1\n        String ip = IpUtil.getIpAddr(request);\n        ip = ip.replace(\":\", \"_\").replace(\".\", \"_\");\n        topic = topicService.updateViewCount(topic, ip);\n        topic.setContent(SensitiveWordUtil.replaceSensitiveWord(topic.getContent(), \"*\", SensitiveWordUtil.MinMatchType));\n\n        map.put(\"topic\", topic);\n        map.put(\"tags\", tags);\n        map.put(\"comments\", comments);\n        map.put(\"topicUser\", topicUser);\n        map.put(\"collects\", collects);\n        return success(map);\n    }\n\n    // \n    @PostMapping\n    public Result create(@RequestBody Map<String, String> body) {\n        User user = getApiUser();\n        ApiAssert.isTrue(user.getActive(), \"\");\n        String title = body.get(\"title\");\n        String content = body.get(\"content\");\n        String tag = body.get(\"tag\");\n        //    String tags = body.get(\"tags\");\n        title = Jsoup.clean(title, Whitelist.basic());\n        ApiAssert.notEmpty(title, \"\");\n        ApiAssert.isNull(topicService.selectByTitle(title), \"\");\n        //    String[] strings = StringUtils.commaDelimitedListToStringArray(tags);\n        //    Set<String> set = StringUtil.removeEmpty(strings);\n        //    ApiAssert.notTrue(set.isEmpty() || set.size() > 5, \"5\");\n        // \n        // tag\n        //    tags = StringUtils.collectionToCommaDelimitedString(set);\n        Topic topic = topicService.insert(title, content, tag, user);\n        topic.setContent(SensitiveWordUtil.replaceSensitiveWord(topic.getContent(), \"*\", SensitiveWordUtil.MinMatchType));\n        return success(topic);\n    }\n\n    // \n    @PutMapping(value = \"/{id}\")\n    public Result edit(@PathVariable Integer id, @RequestBody Map<String, String> body) {\n        User user = getApiUser();\n        String title = body.get(\"title\");\n        String content = body.get(\"content\");\n        ApiAssert.notEmpty(title, \"\");\n        // \n        Topic topic = topicService.selectById(id);\n        ApiAssert.isTrue(topic.getUserId().equals(user.getId()), \"\");\n        topic.setTitle(Jsoup.clean(title, Whitelist.none().addTags(\"video\")));\n        topic.setContent(content);\n        topic.setModifyTime(new Date());\n        topicService.update(topic, null);\n        topic.setContent(SensitiveWordUtil.replaceSensitiveWord(topic.getContent(), \"*\", SensitiveWordUtil.MinMatchType));\n        return success(topic);\n    }\n\n    // \n    @DeleteMapping(\"{id}\")\n    public Result delete(@PathVariable Integer id) {\n        User user = getApiUser();\n        Topic topic = topicService.selectById(id);\n        ApiAssert.isTrue(topic.getUserId().equals(user.getId()), \"\");\n        topicService.delete(topic);\n        return success();\n    }\n\n    @GetMapping(\"/{id}/vote\")\n    public Result vote(@PathVariable Integer id) {\n        User user = getApiUser();\n        Topic topic = topicService.selectById(id);\n        ApiAssert.notNull(topic, \"\");\n        ApiAssert.notTrue(topic.getUserId().equals(user.getId()), \"\");\n        int voteCount = topicService.vote(topic, getApiUser());\n        return success(voteCount);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 12
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Topic implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private String title;\n    private String style; // RICHMD\n    private String content;\n    private Date inTime;\n    private Date modifyTime;\n    private Integer userId;\n    // \n    private Integer commentCount;\n    // \n    private Integer collectCount;\n    // \n    private Integer view;\n    // \n    private Boolean top;\n    // \n    private Boolean good;\n    // id,,\n    private String upIds;\n\n    public String getStyle() {\n        return style;\n    }\n\n    public void setStyle(String style) {\n        this.style = style;\n    }\n\n    public String getUpIds() {\n        return upIds;\n    }\n\n    public void setUpIds(String upIds) {\n        this.upIds = upIds;\n    }\n\n    public Integer getCollectCount() {\n        return collectCount;\n    }\n\n    public void setCollectCount(Integer collectCount) {\n        this.collectCount = collectCount;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    public String getContent() {\n        return content;\n    }\n\n    public void setContent(String content) {\n        this.content = content;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public Date getModifyTime() {\n        return modifyTime;\n    }\n\n    public void setModifyTime(Date modifyTime) {\n        this.modifyTime = modifyTime;\n    }\n\n    public Integer getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Integer userId) {\n        this.userId = userId;\n    }\n\n    public Integer getCommentCount() {\n        return commentCount;\n    }\n\n    public void setCommentCount(Integer commentCount) {\n        this.commentCount = commentCount;\n    }\n\n    public Integer getView() {\n        return view;\n    }\n\n    public void setView(Integer view) {\n        this.view = view;\n    }\n\n    public Boolean getTop() {\n        return top;\n    }\n\n    public void setTop(Boolean top) {\n        this.top = top;\n    }\n\n    public Boolean getGood() {\n        return good;\n    }\n\n    public void setGood(Boolean good) {\n        this.good = good;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 13
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.TopicMapper;\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.*;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.SensitiveWordUtil;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.jsoup.Jsoup;\nimport org.jsoup.safety.Whitelist;\nimport org.springframework.context.annotation.Lazy;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class TopicService implements ITopicService {\n\n    @Resource\n    private TopicMapper topicMapper;\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private ITopicTagService topicTagService;\n    @Resource\n    private ITagService tagService;\n    @Resource\n    @Lazy\n    private ICollectService collectService;\n    @Resource\n    @Lazy\n    private ICommentService commentService;\n    @Resource\n    @Lazy\n    private IUserService userService;\n    @Resource\n    private INotificationService notificationService;\n    @Resource\n    private IndexedService indexedService;\n\n    @Override\n    public MyPage<Map<String, Object>> search(Integer pageNo, Integer pageSize, String keyword) {\n        if (pageSize == null)\n            pageSize = Integer.parseInt(systemConfigService.selectAllConfig().get(\"page_size\").toString());\n        MyPage<Map<String, Object>> page = new MyPage<>(pageNo, pageSize);\n        return topicMapper.search(page, keyword);\n    }\n\n    @Override\n    public MyPage<Map<String, Object>> selectAll(Integer pageNo, String tab) {\n        MyPage<Map<String, Object>> page = new MyPage<>(pageNo, Integer.parseInt(systemConfigService.selectAllConfig()\n                .get(\"page_size\").toString()));\n        page = topicMapper.selectAll(page, tab);\n        // \n        tagService.selectTagsByTopicId(page);\n        return page;\n    }\n\n    // \n    @Override\n    public List<Topic> selectAuthorOtherTopic(Integer userId, Integer topicId, Integer limit) {\n        QueryWrapper<Topic> wrapper = new QueryWrapper<>();\n        wrapper.eq(\"user_id\", userId).orderByDesc(\"in_time\");\n        if (topicId != null) {\n            wrapper.lambda().ne(Topic::getId, topicId);\n        }\n        if (limit != null) wrapper.last(\"limit \" + limit);\n        return topicMapper.selectList(wrapper);\n    }\n\n    // \n    @Override\n    public MyPage<Map<String, Object>> selectByUserId(Integer userId, Integer pageNo, Integer pageSize) {\n        MyPage<Map<String, Object>> iPage = new MyPage<>(pageNo, pageSize == null ? Integer.parseInt(systemConfigService\n                .selectAllConfig().get(\"page_size\").toString()) : pageSize);\n        MyPage<Map<String, Object>> page = topicMapper.selectByUserId(iPage, userId);\n        for (Map<String, Object> map : page.getRecords()) {\n            Object content = map.get(\"content\");\n            map.put(\"content\", StringUtils.isEmpty(content) ? null : SensitiveWordUtil.replaceSensitiveWord(content\n                    .toString(), \"*\", SensitiveWordUtil.MinMatchType));\n        }\n        return page;\n    }\n\n    // \n    @Override\n    public Topic insert(String title, String content, String tags, User user) {\n        Topic topic = new Topic();\n        topic.setTitle(Jsoup.clean(title, Whitelist.simpleText()));\n        topic.setStyle(systemConfigService.selectAllConfig().get(\"content_style\"));\n        topic.setContent(content);\n        topic.setInTime(new Date());\n        topic.setUserId(user.getId());\n        topic.setTop(false);\n        topic.setGood(false);\n        topic.setView(1);\n        topic.setCollectCount(0);\n        topic.setCommentCount(0);\n        topicMapper.insert(topic);\n        // \n        user.setScore(user.getScore() + Integer.parseInt(systemConfigService.selectAllConfig().get(\"create_topic_score\").toString()));\n        userService.update(user);\n        if (!StringUtils.isEmpty(tags)) {\n            // \n            List<Tag> tagList = tagService.insertTag(Jsoup.clean(tags, Whitelist.none()));\n            // \n            topicTagService.insertTopicTag(topic.getId(), tagList);\n        }\n        // \n        indexedService.indexTopic(String.valueOf(topic.getId()), topic.getTitle(), topic.getContent());\n        return topic;\n    }\n\n    // id\n    @Override\n    public Topic selectById(Integer id) {\n        return topicMapper.selectById(id);\n    }\n\n    // title\n    @Override\n    public Topic selectByTitle(String title) {\n        QueryWrapper<Topic> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Topic::getTitle, title);\n        return topicMapper.selectOne(wrapper);\n    }\n\n    // \n    @Override\n    public Topic updateViewCount(Topic topic, String ip) {\n        topic.setView(topic.getView() + 1);\n        this.update(topic, null);\n        return topic;\n    }\n\n    // \n    @Override\n    public void update(Topic topic, String tags) {\n        topicMapper.updateById(topic);\n        // \n        if (!StringUtils.isEmpty(tags)) {\n            // topicCount-1\n            tagService.reduceTopicCount(topic.getId());\n            if (!StringUtils.isEmpty(tags)) {\n                // \n                List<Tag> tagList = tagService.insertTag(Jsoup.clean(tags, Whitelist.none()));\n                // \n                topicTagService.insertTopicTag(topic.getId(), tagList);\n            }\n        }\n        // \n        indexedService.indexTopic(String.valueOf(topic.getId()), topic.getTitle(), topic.getContent());\n    }\n\n    // \n    @Override\n    public void delete(Topic topic) {\n        Integer id = topic.getId();\n        // \n        notificationService.deleteByTopicId(id);\n        // \n        collectService.deleteByTopicId(id);\n        // \n        commentService.deleteByTopicId(id);\n        //  topicCount -1\n        tagService.reduceTopicCount(id);\n        // \n        topicTagService.deleteByTopicId(id);\n        // \n        User user = userService.selectById(topic.getUserId());\n        user.setScore(user.getScore() - Integer.parseInt(systemConfigService.selectAllConfig().get(\"delete_topic_score\")\n                .toString()));\n        userService.update(user);\n        // \n        indexedService.deleteTopicIndex(String.valueOf(topic.getId()));\n        // \n        topicMapper.deleteById(id);\n    }\n\n    // id\n    @Override\n    public void deleteByUserId(Integer userId) {\n        QueryWrapper<Topic> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Topic::getUserId, userId);\n        List<Topic> topics = topicMapper.selectList(wrapper);\n        topics.forEach(topic -> {\n            // \n            indexedService.deleteTopicIndex(String.valueOf(topic.getId()));\n            // \n            commentService.deleteByTopicId(topic.getId());\n            // \n            collectService.deleteByTopicId(topic.getId());\n            // \n            // topicCount-1\n            tagService.reduceTopicCount(topic.getId());\n            // \n            topicTagService.deleteByTopicId(topic.getId());\n        });\n        //\n        topicMapper.delete(wrapper);\n    }\n\n    // ---------------------------- admin ----------------------------\n\n    @Override\n    public MyPage<Map<String, Object>> selectAllForAdmin(Integer pageNo, String startDate, String endDate, String\n            username) {\n        MyPage<Map<String, Object>> iPage = new MyPage<>(pageNo, Integer.parseInt((String) systemConfigService\n                .selectAllConfig().get(\"page_size\")));\n        return topicMapper.selectAllForAdmin(iPage, startDate, endDate, username);\n    }\n\n    // \n    @Override\n    public int countToday() {\n        return topicMapper.countToday();\n    }\n\n    // ---------------------------- api ----------------------------\n\n    @Override\n    public int vote(Topic topic, User user) {\n        String upIds = topic.getUpIds();\n        // id\n        Set<String> strings = StringUtils.commaDelimitedListToSet(upIds);\n        // idsetid\n        Integer userScore = user.getScore();\n        if (strings.contains(String.valueOf(user.getId()))) { // \n            strings.remove(String.valueOf(user.getId()));\n            userScore -= Integer.parseInt(systemConfigService.selectAllConfig().get(\"up_topic_score\").toString());\n        } else { // \n            strings.add(String.valueOf(user.getId()));\n            userScore += Integer.parseInt(systemConfigService.selectAllConfig().get(\"up_topic_score\").toString());\n        }\n        // id\n        topic.setUpIds(StringUtils.collectionToCommaDelimitedString(strings));\n        // \n        this.update(topic, null);\n        // \n        user.setScore(userScore);\n        userService.update(user);\n        return strings.size();\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 14
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.interceptor;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.IUserService;\nimport co.yiiu.pybbs.util.CookieUtil;\nimport co.yiiu.pybbs.util.HttpUtil;\nimport co.yiiu.pybbs.util.IpUtil;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.servlet.HandlerInterceptor;\nimport org.springframework.web.servlet.ModelAndView;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class CommonInterceptor implements HandlerInterceptor {\n\n    private final Logger log = LoggerFactory.getLogger(CommonInterceptor.class);\n    @Resource\n    private IUserService userService;\n    @Resource\n    private CookieUtil cookieUtil;\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {\n        long start = System.currentTimeMillis();\n        request.setAttribute(\"_start\", start);\n\n        // session\n        HttpSession session = request.getSession();\n        User user = (User) session.getAttribute(\"_user\");\n        if (user == null) {\n            // cookietokensession\n            String token = cookieUtil.getCookie(systemConfigService.selectAllConfig().get(\"cookie_name\").toString());\n            if (!StringUtils.isEmpty(token)) {\n                // token\n                user = userService.selectByToken(token);\n                if (user != null) {\n                    // sessioncookie\n                    session.setAttribute(\"_user\", user);\n                    cookieUtil.setCookie(systemConfigService.selectAllConfig().get(\"cookie_name\").toString(), user.getToken());\n                }\n            }\n        }\n        return true;\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) {\n        if (!HttpUtil.isApiRequest(request) && modelAndView != null) {\n            // TODO system_config\n            // \n            // 2023/3/14 systemConfigtypepassword\n            modelAndView.addObject(\"site\", systemConfigService.selectAllConfigWithoutPassword());\n        }\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) {\n        long start = (long) request.getAttribute(\"_start\");\n        String actionName = request.getRequestURI();\n        String clientIp = IpUtil.getIpAddr(request);\n        StringBuilder logString = new StringBuilder();\n        logString.append(clientIp).append(\"|\").append(actionName).append(\"|\");\n        Map<String, String[]> params = request.getParameterMap();\n        params.forEach((key, value) -> {\n            logString.append(key);\n            logString.append(\"=\");\n            for (String paramString : value) {\n                logString.append(paramString);\n            }\n            logString.append(\"|\");\n        });\n        long executionTime = System.currentTimeMillis() - start;\n        logString.append(\"excitation=\").append(executionTime).append(\"ms\");\n        log.info(logString.toString());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 15
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport javax.servlet.http.HttpServletRequest;\n\npublic class IpUtil {\n    public IpUtil() {\n    }\n\n    public static String getIpAddr(HttpServletRequest request) {\n        String ip = request.getHeader(\"x-forwarded-for\");\n        if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) {\n            ip = request.getHeader(\"Proxy-Client-IP\");\n        }\n\n        if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) {\n            ip = request.getHeader(\"WL-Proxy-Client-IP\");\n        }\n\n        if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) {\n            ip = request.getRemoteAddr();\n        }\n\n        return ip;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/test/java/co/yiiu/pybbs/PybbsApplicationTests.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 16
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs;\n\nimport org.junit.Test;\n\n//@RunWith(SpringRunner.class)\n//@SpringBootTest\npublic class PybbsApplicationTests {\n\n    @Test\n    public void contextLoads() {\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/test/java/co/yiiu/pybbs/util/StringUtilTest.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 17
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport co.yiiu.pybbs.util.bcrypt.BCryptPasswordEncoder;\nimport org.junit.Test;\n\n/**\n * Created by tomoya at 2019/5/24\n */\npublic class StringUtilTest {\n\n    @Test\n    public void check() {\n        String username = \"admin@dhajksd.ahsd.xyz\";\n        System.out.println(StringUtil.check(username, StringUtil.USERNAMEREGEX));\n\n        System.out.println(new BCryptPasswordEncoder().encode(\"123123\"));\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/TopicTagMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 18
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.TopicTag;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface TopicTagMapper extends BaseMapper<TopicTag> {\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/DateUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 19
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport org.springframework.util.StringUtils;\n\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.TimeZone;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2016, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class DateUtil {\n\n    private DateUtil() {\n    }\n\n    public static final String FORMAT_DATETIME = \"yyyy-MM-dd HH:mm:ss\";\n    public static final String FORMAT_DATE = \"yyyy-MM-dd\";\n    public static final String TIME_ZONE = \"GMT+8\";\n\n    public static String formatDateTime(Date date) {\n        return DateUtil.formatDateTime(date, DateUtil.FORMAT_DATETIME);\n    }\n\n    public static String formatDate(Date date) {\n        return DateUtil.formatDateTime(date, DateUtil.FORMAT_DATE);\n    }\n\n    public static String formatDateTime(Date date, String style) {\n        if (date == null) return null;\n        SimpleDateFormat sdf = new SimpleDateFormat(style);\n        sdf.setTimeZone(TimeZone.getTimeZone(DateUtil.TIME_ZONE));\n        return sdf.format(date);\n    }\n\n    /**\n     * \n     *\n     * @param dateString\n     * @param style\n     * @return\n     */\n    public static Date string2Date(String dateString, String style) {\n        if (StringUtils.isEmpty(dateString)) return null;\n        Date date = new Date();\n        SimpleDateFormat strToDate = new SimpleDateFormat(style);\n        try {\n            date = strToDate.parse(dateString);\n        } catch (ParseException e) {\n            e.printStackTrace();\n        }\n        return date;\n    }\n\n    /**\n     * boolean\n     * true: \n     * false: \n     *\n     * @param date\n     * @return\n     */\n    public static boolean isExpire(Date date) {\n        if (date.before(new Date())) return true;\n        return false;\n    }\n\n    //  hour \n    public static Date getHourAfter(Date date, int hour) {\n        Calendar calendar = Calendar.getInstance();\n        calendar.setTime(date);\n        calendar.set(Calendar.HOUR_OF_DAY, calendar.get(Calendar.HOUR_OF_DAY) + hour);\n        return calendar.getTime();\n    }\n\n    //  hour \n    public static Date getHourBefore(Date date, int hour) {\n        Calendar calendar = Calendar.getInstance();\n        calendar.setTime(date);\n        calendar.set(Calendar.HOUR_OF_DAY, calendar.get(Calendar.HOUR_OF_DAY) - hour);\n        return calendar.getTime();\n    }\n\n    public static Date getDateBefore(Date date, int day) {\n        Calendar calendar = Calendar.getInstance();\n        calendar.setTime(date);\n        calendar.add(Calendar.DAY_OF_MONTH, -day);\n        return calendar.getTime();\n    }\n\n    public static Date getDateAfter(Date date, int day) {\n        Calendar calendar = Calendar.getInstance();\n        calendar.setTime(date);\n        calendar.add(Calendar.DAY_OF_MONTH, day);\n        return calendar.getTime();\n    }\n\n    public static Date getMinuteAfter(Date date, int minute) {\n        Calendar calendar = Calendar.getInstance();\n        calendar.setTime(date);\n        calendar.add(Calendar.MINUTE, minute);\n        return calendar.getTime();\n    }\n\n    public static Date getMinuteBefore(Date date, int minute) {\n        Calendar calendar = Calendar.getInstance();\n        calendar.setTime(date);\n        calendar.add(Calendar.MINUTE, -minute);\n        return calendar.getTime();\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Streams.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 20
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\n\npublic class Streams {\n    /**\n     * \n     *\n     * @param in \n     */\n    public static void close(InputStream in) {\n        if (in != null) {\n            try {\n                in.close();\n            } catch (IOException ioex) {\n                // ignore\n            }\n        }\n    }\n\n    /**\n     * \n     *\n     * @param out \n     */\n    public static void close(OutputStream out) {\n        if (out != null) {\n            try {\n                out.flush();\n            } catch (IOException ioex) {\n                // ignore\n            }\n            try {\n                out.close();\n            } catch (IOException ioex) {\n                // ignore\n            }\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/SpringContextUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 21
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.ApplicationContextAware;\nimport org.springframework.stereotype.Component;\n\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class SpringContextUtil implements ApplicationContextAware {\n\n    private static ApplicationContext context = null;\n\n    public SpringContextUtil() {\n        super();\n    }\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        context = applicationContext;\n    }\n\n    /**\n     * bean\n     *\n     * @param beanName\n     * @return\n     */\n    public static Object getBean(String beanName) {\n        return context.getBean(beanName);\n    }\n\n    /**\n     * beanbean\n     *\n     * @param beanName bean\n     * @param clazz    bean,,\n     */\n    public static <T> T getBean(String beanName, Class<T> clazz) {\n        return context.getBean(beanName, clazz);\n    }\n\n    /**\n     * bean\n     *\n     * @param clazz\n     * @return\n     */\n    public static <T> T getBean(Class<T> clazz) {\n        T t = null;\n        Map<String, T> map = context.getBeansOfType(clazz);\n        for (Map.Entry<String, T> entry : map.entrySet()) {\n            t = entry.getValue();\n        }\n        return t;\n    }\n\n    /**\n     * bean\n     *\n     * @param beanName\n     * @return\n     */\n    public static boolean containsBean(String beanName) {\n        return context.containsBean(beanName);\n    }\n\n    /**\n     * \n     *\n     * @param beanName\n     * @return\n     */\n    public static boolean isSingleton(String beanName) {\n        return context.isSingleton(beanName);\n    }\n\n    /**\n     * bean\n     *\n     * @param beanName\n     * @return\n     */\n    public static Class getType(String beanName) {\n        return context.getType(beanName);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/INotificationService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 22
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface INotificationService {\n    // \n    List<Map<String, Object>> selectByUserId(Integer userId, Boolean read, Integer limit);\n\n    void markRead(Integer userId);\n\n    // \n    long countNotRead(Integer userId);\n\n    void deleteByTopicId(Integer topicId);\n\n    void deleteByUserId(Integer userId);\n\n    void insert(Integer userId, Integer targetUserId, Integer topicId, String action, String content);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MessageEncoder.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 23
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.websocket;\n\nimport co.yiiu.pybbs.util.Message;\nimport com.alibaba.fastjson.JSON;\n\nimport javax.websocket.Encoder;\nimport javax.websocket.EndpointConfig;\n\npublic class MessageEncoder implements Encoder.Text<Message> {\n    @Override\n    public String encode(Message o) {\n        return JSON.toJSONString(o);\n    }\n\n    @Override\n    public void init(EndpointConfig endpointConfig) {\n\n    }\n\n    @Override\n    public void destroy() {\n\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Captcha.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 24
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\nimport java.awt.*;\nimport java.io.OutputStream;\n\nimport static co.yiiu.pybbs.util.captcha.Randoms.alpha;\nimport static co.yiiu.pybbs.util.captcha.Randoms.num;\n\n/**\n * <p>,</p>\n *\n * @author: wuhongjun\n * @version:1.0\n */\npublic abstract class Captcha {\n\n    protected Font font = new Font(\"Verdana\", Font.ITALIC | Font.BOLD, 28);   // \n    protected int len = 4;  // \n    protected int width = 120;  // \n    protected int height = 32;  // \n    private String chars = null;  // \n\n    /**\n     * \n     *\n     * @return \n     */\n    protected char[] alphas() {\n        char[] cs = new char[len];\n        for (int i = 0; i < len; i++) {\n            cs[i] = alpha();\n        }\n        chars = new String(cs);\n        return cs;\n    }\n\n    public Font getFont() {\n        return font;\n    }\n\n    public void setFont(Font font) {\n        this.font = font;\n    }\n\n    public int getLen() {\n        return len;\n    }\n\n    public void setLen(int len) {\n        this.len = len;\n    }\n\n    public int getWidth() {\n        return width;\n    }\n\n    public void setWidth(int width) {\n        this.width = width;\n    }\n\n    public int getHeight() {\n        return height;\n    }\n\n    public void setHeight(int height) {\n        this.height = height;\n    }\n\n    /**\n     * \n     *\n     * @return Color \n     */\n    protected Color color(int fc, int bc) {\n        if (fc > 255) fc = 255;\n        if (bc > 255) bc = 255;\n        int r = fc + num(bc - fc);\n        int g = fc + num(bc - fc);\n        int b = fc + num(bc - fc);\n        return new Color(r, g, b);\n    }\n\n    /**\n     * ,\n     *\n     * @param os \n     */\n    public abstract void out(OutputStream os);\n\n    /**\n     * \n     *\n     * @return string\n     */\n    public String text() {\n        return chars;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/plugin/RedisCachePlugin.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 25
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.plugin;\n\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.model.vo.CommentsByTopic;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.util.JsonUtil;\nimport org.aspectj.lang.JoinPoint;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.After;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\n@Aspect\npublic class RedisCachePlugin {\n\n    @Resource\n    private RedisService redisService;\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    // ---------- topic cache start ----------\n\n    @Around(\"co.yiiu.pybbs.hook.TopicServiceHook.selectById()\")\n    public Object topicSelectById(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        String topicJson = redisService.getString(String.format(RedisKeys.REDIS_TOPIC_KEY, proceedingJoinPoint.getArgs()[0]));\n        if (topicJson == null) {\n            Object topic = proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n            // redis\n            redisService.setString(String.format(RedisKeys.REDIS_TOPIC_KEY, proceedingJoinPoint.getArgs()[0]), JsonUtil.objectToJson(topic));\n            return topic;\n        } else {\n            return JsonUtil.jsonToObject(topicJson, Topic.class);\n        }\n    }\n\n    @Around(\"co.yiiu.pybbs.hook.TopicServiceHook.updateViewCount()\")\n    public Object topicUpdateViewCount(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        Topic topic = (Topic) proceedingJoinPoint.getArgs()[0];\n        String ip = (String) proceedingJoinPoint.getArgs()[1];\n        String s = redisService.getString(String.format(RedisKeys.REDIS_TOPIC_VIEW_IP_ID_KEY, ip, topic.getId()));\n        if (redisService.isRedisConfig()) {\n            if (s == null) {\n                topic.setView(topic.getView() + 1);\n                topicService.update(topic, null);\n                redisService.setString(String.format(RedisKeys.REDIS_TOPIC_VIEW_IP_ID_KEY, ip, topic.getId()), String.valueOf\n                        (topic.getId()), Integer.parseInt(systemConfigService.selectAllConfig().get(\"topic_view_increase_interval\").toString()));\n            }\n            return topic;\n        } else {\n            return proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n        }\n    }\n\n    @Around(\"co.yiiu.pybbs.hook.TopicServiceHook.vote()\")\n    public Object voteTopic(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        // redistopic\n        Topic topic = (Topic) proceedingJoinPoint.getArgs()[0];\n        redisService.delString(String.format(RedisKeys.REDIS_TOPIC_KEY, topic.getId()));\n        return proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n    }\n\n    @After(\"co.yiiu.pybbs.hook.TopicServiceHook.update()\")\n    public void topicUpdate(JoinPoint joinPoint) {\n        Topic topic = (Topic) joinPoint.getArgs()[0];\n        // redis\n        redisService.setString(String.format(RedisKeys.REDIS_TOPIC_KEY, topic.getId()), JsonUtil.objectToJson(topic));\n    }\n\n    // ---------- topic cache end ----------\n\n    // ---------- comment cache start ----------\n\n    @Around(\"co.yiiu.pybbs.hook.CommentServiceHook.selectByTopicId()\")\n    public Object commentSelectByTopicId(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        Integer topicId = (Integer) proceedingJoinPoint.getArgs()[0];\n        String commentsJson = redisService.getString(String.format(RedisKeys.REDIS_COMMENTS_KEY, topicId));\n        if (commentsJson != null) {\n            // , \n            return JsonUtil.jsonToListObject(commentsJson, CommentsByTopic.class);\n        } else {\n            Object returnValue = proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n            redisService.setString(String.format(RedisKeys.REDIS_COMMENTS_KEY, topicId), JsonUtil.objectToJson(returnValue));\n            return returnValue;\n        }\n    }\n\n    @After(\"co.yiiu.pybbs.hook.CommentServiceHook.insert()\")\n    public void commentInsert(JoinPoint joinPoint) {\n        Comment comment = (Comment) joinPoint.getArgs()[0];\n        redisService.delString(String.format(RedisKeys.REDIS_COMMENTS_KEY, comment.getTopicId()));\n    }\n\n    @After(\"co.yiiu.pybbs.hook.CommentServiceHook.update()\")\n    public void commentUpdate(JoinPoint joinPoint) {\n        Comment comment = (Comment) joinPoint.getArgs()[0];\n        redisService.delString(String.format(RedisKeys.REDIS_COMMENTS_KEY, comment.getTopicId()));\n    }\n\n    @After(\"co.yiiu.pybbs.hook.CommentServiceHook.delete()\")\n    public void commentDelete(JoinPoint joinPoint) {\n        Comment comment = (Comment) joinPoint.getArgs()[0];\n        redisService.delString(String.format(RedisKeys.REDIS_COMMENTS_KEY, comment.getTopicId()));\n    }\n\n    @Around(\"co.yiiu.pybbs.hook.CommentServiceHook.vote()\")\n    public Object voteComment(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        Comment comment = (Comment) proceedingJoinPoint.getArgs()[0];\n        redisService.delString(String.format(RedisKeys.REDIS_COMMENTS_KEY, comment.getTopicId()));\n        return proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n    }\n\n    // ---------- comment cache end ----------\n\n    // ---------- user cache start ----------\n\n    @Around(\"co.yiiu.pybbs.hook.UserServiceHook.selectByUsername()\")\n    public Object userSelectByUsername(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        String username = (String) proceedingJoinPoint.getArgs()[0];\n        String userJson = redisService.getString(String.format(RedisKeys.REDIS_USER_USERNAME_KEY, username));\n        if (userJson != null) {\n            // , \n            return JsonUtil.jsonToObject(userJson, User.class);\n        } else {\n            Object returnValue = proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n            if (returnValue != null) {\n                redisService.setString(String.format(RedisKeys.REDIS_USER_USERNAME_KEY, username), JsonUtil.objectToJson(returnValue));\n            }\n            return returnValue;\n        }\n    }\n\n    @Around(\"co.yiiu.pybbs.hook.UserServiceHook.selectByToken()\")\n    public Object userSelectByToken(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        String token = (String) proceedingJoinPoint.getArgs()[0];\n        String userJson = redisService.getString(String.format(RedisKeys.REDIS_USER_TOKEN_KEY, token));\n        if (userJson != null) {\n            // , \n            return JsonUtil.jsonToObject(userJson, User.class);\n        } else {\n            Object returnValue = proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n            if (returnValue != null) {\n                redisService.setString(String.format(RedisKeys.REDIS_USER_TOKEN_KEY, token), JsonUtil.objectToJson(returnValue));\n            }\n            return returnValue;\n        }\n    }\n\n    @Around(\"co.yiiu.pybbs.hook.UserServiceHook.selectById()\")\n    public Object userSelectById(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        Integer id = (Integer) proceedingJoinPoint.getArgs()[0];\n        String userJson = redisService.getString(String.format(RedisKeys.REDIS_USER_ID_KEY, id));\n        if (userJson != null) {\n            // , \n            return JsonUtil.jsonToObject(userJson, User.class);\n        } else {\n            Object returnValue = proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n            if (returnValue != null) {\n                redisService.setString(String.format(RedisKeys.REDIS_USER_ID_KEY, id), JsonUtil.objectToJson(returnValue));\n            }\n            return returnValue;\n        }\n    }\n\n    @After(\"co.yiiu.pybbs.hook.UserServiceHook.delRedisUser()\")\n    public void userDelRedisUser(JoinPoint joinPoint) {\n        User user = (User) joinPoint.getArgs()[0];\n        redisService.delString(String.format(RedisKeys.REDIS_USER_ID_KEY, user.getId()));\n        redisService.delString(String.format(RedisKeys.REDIS_USER_USERNAME_KEY, user.getUsername()));\n        redisService.delString(String.format(RedisKeys.REDIS_USER_TOKEN_KEY, user.getToken()));\n    }\n\n    // ---------- user cache end ----------\n\n    static class RedisKeys {\n        public static final String REDIS_TOPIC_KEY = \"pybbs_topic_%s\"; // id\n        public static final String REDIS_TOPIC_VIEW_IP_ID_KEY = \"pybbs_topic_view_ip_%s_topic_%s\"; // ipid\n        public static final String REDIS_COMMENTS_KEY = \"pybbs_comments_%s\"; // id\n\n        public static final String REDIS_USER_ID_KEY = \"pybbs_user_id_%s\"; // id\n        public static final String REDIS_USER_USERNAME_KEY = \"pybbs_user_username_%s\"; // \n        public static final String REDIS_USER_TOKEN_KEY = \"pybbs_user_token_%s\"; // token\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/StringUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 26
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport org.springframework.util.StringUtils;\n\nimport java.util.*;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class StringUtil {\n\n    private StringUtil() {\n    }\n\n    // \n    public static final String MOBILEREGEX = \"^1[0-9]{10}\";\n    // email\n    public static final String EMAILREGEX = \"\\\\w[-\\\\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\\\\.)+[A-Za-z]{2,14}\";\n    // url\n    public static final String URLREGEX = \"^((https|http)?:\\\\/\\\\/)[^\\\\s]+\";\n    // \n    public static final String USERNAMEREGEX = \"[a-z0-9A-Z]{2,16}\";\n    // \n    public static final String PASSWORDREGEX = \"[a-z0-9A-Z]{6,32}\";\n    // \n    private static final char[] hexDigits = new char[]{'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c',\n            'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y',\n            'z'};\n    // \n    private static final char[] digits = new char[]{'0', '1', '2', '3', '4', '5', '6', '7', '8', '9'};\n    public static final Random random = new Random();\n\n    public static boolean check(String text, String regex) {\n        if (StringUtils.isEmpty(text)) {\n            return false;\n        } else {\n            Pattern pattern = Pattern.compile(regex);\n            Matcher matcher = pattern.matcher(text);\n            return matcher.matches();\n        }\n    }\n\n    /**\n     * \n     *\n     * @param length\n     * @return\n     */\n    public static String randomString(int length) {\n        StringBuilder sb = new StringBuilder();\n        for (int loop = 0; loop < length; ++loop) {\n            sb.append(hexDigits[random.nextInt(hexDigits.length)]);\n        }\n        return sb.toString();\n    }\n\n    /**\n     * \n     *\n     * @param length\n     * @return\n     */\n    public static String randomNumber(int length) {\n        StringBuilder sb = new StringBuilder();\n        for (int loop = 0; loop < length; ++loop) {\n            sb.append(digits[random.nextInt(digits.length)]);\n        }\n        return sb.toString();\n    }\n\n    // uuid\n    public static String uuid() {\n        return UUID.randomUUID().toString();\n    }\n\n    /**\n     * accessToken\n     */\n    public static boolean isUUID(String accessToken) {\n        if (StringUtils.isEmpty(accessToken)) {\n            return false;\n        } else {\n            try {\n                // noinspection ResultOfMethodCallIgnored\n                UUID.fromString(accessToken);\n                return true;\n            } catch (Exception e) {\n                return false;\n            }\n        }\n    }\n\n    // urlmap\n    // paramsa=1&b=2&c=3\n    // {a: 1, b: 2, c: 3}\n    public static Map<String, Object> formatParams(String params) {\n        if (StringUtils.isEmpty(params)) return null;\n        Map<String, Object> map = new HashMap<>();\n        for (String s : params.split(\"&\")) {\n            String[] ss = s.split(\"=\");\n            map.put(ss[0], ss[1]);\n        }\n        return map;\n    }\n\n    // at\n    public static List<String> fetchAtUser(String content) {\n        if (StringUtils.isEmpty(content)) return Collections.emptyList();\n        //  ``` ``` \n        content = content.replaceAll(\"```([\\\\s\\\\S]*)```\", \"\");\n        //  ` ` \n        content = content.replaceAll(\"`([\\\\s\\\\S]*)`\", \"\");\n        // @\n        String atRegex = \"@[a-z0-9-_]+\\\\b?\";\n        List<String> atUsers = new ArrayList<>();\n        Pattern regex = Pattern.compile(atRegex);\n        Matcher regexMatcher = regex.matcher(content);\n        while (regexMatcher.find()) {\n            atUsers.add(regexMatcher.group());\n        }\n        return atUsers;\n    }\n\n    // \n    public static Set<String> removeEmpty(String[] strs) {\n        if (strs == null || strs.length == 0) return Collections.emptySet();\n        Set<String> set = new HashSet<>();\n        for (String str : strs) {\n            if (!StringUtils.isEmpty(str)) {\n                set.add(str);\n            }\n        }\n        return set;\n    }\n\n    /**\n     * unicode\n     *\n     * @param string\n     * @return\n     * @author shuai.ding\n     */\n    public static String string2Unicode(String string) {\n        if (StringUtils.isEmpty(string)) {\n            return null;\n        }\n        char[] bytes = string.toCharArray();\n        StringBuilder unicode = new StringBuilder();\n        for (int i = 0; i < bytes.length; i++) {\n            char c = bytes[i];\n            // ASCII\n            if (c >= 0 && c <= 127) {\n                unicode.append(c);\n                continue;\n            }\n            String hexString = Integer.toHexString(bytes[i]);\n            unicode.append(\"\\\\u\");\n            // 0\n            if (hexString.length() < 4) {\n                unicode.append(\"0000\".substring(hexString.length(), 4));\n            }\n            unicode.append(hexString);\n        }\n        return unicode.toString();\n    }\n\n    /**\n     * \\s+,\n     * \\pP  p  property  Unicode  Unicode \n     *  P  Unicode \n     * \n     * L\n     * M\n     * Z\n     * S\n     * N\n     * C\n     *\n     * @param str\n     * @return\n     */\n    public static String removeSpecialChar(String str) {\n        String regEx = \"\\\\pP|\\\\pS|\\\\s+\";\n        str = Pattern.compile(regEx).matcher(str).replaceAll(\"\").trim();\n        return str;\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/Result.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 27
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Result {\n\n    private Integer code;\n    private String description;\n    private Object detail;\n\n    public Integer getCode() {\n        return code;\n    }\n\n    public void setCode(Integer code) {\n        this.code = code;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public Object getDetail() {\n        return detail;\n    }\n\n    public void setDetail(Object detail) {\n        this.detail = detail;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/front/CommentController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 28
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.front;\n\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.service.ICommentService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/comment\")\npublic class CommentController extends BaseController {\n\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private ITopicService topicService;\n\n    // \n    @GetMapping(\"/edit/{id}\")\n    public String edit(@PathVariable Integer id, Model model) {\n        Comment comment = commentService.selectById(id);\n        Topic topic = topicService.selectById(comment.getTopicId());\n        model.addAttribute(\"comment\", comment);\n        model.addAttribute(\"topic\", topic);\n        return render(\"comment/edit\");\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/IBaseGenerator.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 29
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.identicon.generator;\n\nimport java.awt.*;\n\n/**\n * Author: Bryant Hang\n * Date: 15/1/10\n * Time: 2:43\n */\npublic interface IBaseGenerator {\n    /**\n     * hashbool6*5\n     *\n     * @param hash\n     * @return\n     */\n    public boolean[][] getBooleanValueArray(String hash);\n\n\n    /**\n     * \n     *\n     * @return\n     */\n    public Color getBackgroundColor();\n\n\n    /**\n     * \n     *\n     * @return\n     */\n    public Color getForegroundColor();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TelegramBotController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 30
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.config.service.TelegramBotService;\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.service.ICommentService;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.JsonUtil;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.ResponseBody;\n\nimport javax.annotation.Resource;\nimport javax.servlet.ServletInputStream;\nimport javax.servlet.http.HttpServletRequest;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Map;\n\n@Controller\n@RequestMapping(\"/bot/tg\")\npublic class TelegramBotController extends BaseApiController {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private TelegramBotService telegramBotService;\n\n    @PostMapping(\"/webhook\")\n    @ResponseBody\n    public Object webhook(HttpServletRequest request) throws IOException {\n        String secretToken = request.getHeader(\"X-Telegram-Bot-Api-Secret-Token\");\n        if (StringUtils.isEmpty(secretToken)) return \"False\";\n\n        String webhookSecretToken = systemConfigService.selectAllConfig().get(\"tg_webhook_secret_token\");\n        if (StringUtils.isEmpty(webhookSecretToken)) return \"False\";\n        if (!secretToken.equals(webhookSecretToken)) return \"False\";\n\n        ServletInputStream inputStream = request.getInputStream();\n        BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, StandardCharsets.UTF_8));\n        StringBuilder sb = new StringBuilder();\n        String buff;\n        while ((buff = reader.readLine()) != null) {\n            sb.append(buff);\n        }\n        Map map = JsonUtil.jsonToObject(sb.toString(), Map.class);\n        Map callback_query = (Map) map.get(\"callback_query\");\n        if (callback_query != null) {\n            Map message = (Map) callback_query.get(\"message\");\n            Integer message_id = (Integer) message.get(\"message_id\");\n            String data = (String) callback_query.get(\"data\");\n\n            Comment comment = null;\n            if (message_id != null) {\n                comment = commentService.selectByTgMessageId(message_id);\n            }\n            if (data.equals(\"del_btn\")) {\n                if (comment != null) {\n                    commentService.delete(comment);\n                    telegramBotService.init().sendMessage(\"\", false, comment.getTgMessageId());\n                }\n            } else if (data.equals(\"pass_btn\")) {\n                if (comment != null && comment.getStatus() != null && !comment.getStatus() && systemConfigService.selectAllConfig().get(\"comment_need_examine\").equals(\"1\")) {\n                    comment.setStatus(true);\n                    commentService.update(comment);\n                    telegramBotService.init().sendMessage(\"\", false, comment.getTgMessageId());\n                }\n            }\n        }\n        return \"True\";\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Permission.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 31
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Permission implements Serializable {\n    private static final long serialVersionUID = -2694960432845360318L;\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private String name;\n    private String value;\n    // id\n    private Integer pid;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n\n    public Integer getPid() {\n        return pid;\n    }\n\n    public void setPid(Integer pid) {\n        this.pid = pid;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/AdminUserAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 32
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.model.AdminUser;\nimport co.yiiu.pybbs.service.IAdminUserService;\nimport co.yiiu.pybbs.service.IRoleService;\nimport co.yiiu.pybbs.util.bcrypt.BCryptPasswordEncoder;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/admin_user\")\npublic class AdminUserAdminController extends BaseAdminController {\n\n    @Resource\n    private IAdminUserService adminUserService;\n    @Resource\n    private IRoleService roleService;\n\n    @RequiresPermissions(\"admin_user:list\")\n    @GetMapping(\"/list\")\n    public String list(Model model) {\n        model.addAttribute(\"adminUsers\", adminUserService.selectAll());\n        return \"admin/admin_user/list\";\n    }\n\n    @RequiresPermissions(\"admin_user:add\")\n    @GetMapping(\"/add\")\n    public String add(Model model) {\n        // \n        model.addAttribute(\"roles\", roleService.selectAll());\n        return \"admin/admin_user/add\";\n    }\n\n    @RequiresPermissions(\"admin_user:add\")\n    @PostMapping(\"/add\")\n    public String save(AdminUser adminUser) {\n        adminUser.setInTime(new Date());\n        adminUser.setPassword(new BCryptPasswordEncoder().encode(adminUser.getPassword()));\n        adminUserService.insert(adminUser);\n        return redirect(\"/admin/admin_user/list\");\n    }\n\n    @RequiresPermissions(\"admin_user:edit\")\n    @GetMapping(\"/edit\")\n    public String edit(Integer id, Model model) {\n        AdminUser adminUser = getAdminUser();\n        //    Assert.isTrue(adminUser.getId().equals(id), \"\");\n        // \n        model.addAttribute(\"roles\", roleService.selectAll());\n        model.addAttribute(\"adminUser\", adminUserService.selectById(id));\n        return \"admin/admin_user/edit\";\n    }\n\n    @RequiresPermissions(\"admin_user:edit\")\n    @PostMapping(\"/edit\")\n    public String edit(AdminUser adminUser) {\n        AdminUser _adminUser = getAdminUser();\n        //    Assert.isTrue(_adminUser.getId().equals(adminUser.getId()), \"\");\n        if (StringUtils.isEmpty(adminUser.getPassword())) {\n            adminUser.setPassword(null);\n        } else {\n            adminUser.setPassword(new BCryptPasswordEncoder().encode(adminUser.getPassword()));\n        }\n        adminUserService.update(adminUser);\n        return redirect(\"/admin/admin_user/list\");\n    }\n\n    @RequiresPermissions(\"admin_user:delete\")\n    @GetMapping(\"/delete\")\n    public String delete(Integer id) {\n        adminUserService.delete(id);\n        return redirect(\"/admin/admin_user/list\");\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/SecurityUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 33
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\n\nimport org.apache.commons.text.StringEscapeUtils;\n\npublic class SecurityUtil {\n\n    public static String sanitizeInput(String input) {\n        return StringEscapeUtils.escapeHtml3(StringEscapeUtils.escapeHtml4(StringEscapeUtils.escapeEcmaScript(input)));\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/HttpUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 34
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class HttpUtil {\n\n    public static boolean isApiRequest(HttpServletRequest request) {\n        return request.getHeader(\"Accept\") == null || !request.getHeader(\"Accept\").contains(\"text/html\");\n    }\n\n    // \n    // requestheaderaccept\n    //  text/html jsresponse text/javascript\n    //  application/json jsonresponse  application/json\n    //  ;charset=utf-8 \n    // \n    public static void responseWrite(HttpServletRequest request, HttpServletResponse response) throws IOException {\n        if (!HttpUtil.isApiRequest(request)) {\n            response.setContentType(\"text/html;charset=utf-8\");\n            response.sendRedirect(\"/login\");\n//            response.getWriter().write(\"<script>alert('!');window.history.go(-1);</script>\");\n        } else /*if (accept.contains(\"application/json\"))*/ {\n            response.setContentType(\"application/json;charset=utf-8\");\n            Result result = new Result();\n            result.setCode(201);\n            result.setDescription(\"\");\n            response.getWriter().write(JsonUtil.objectToJson(result));\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/hook/IndexedServiceHook.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 35
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.hook;\n\nimport org.aspectj.lang.annotation.Pointcut;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class IndexedServiceHook {\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IIndexedService.indexAllTopic(..))\")\n    public void indexAllTopic() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IIndexedService.indexTopic(..))\")\n    public void indexTopic() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IIndexedService.deleteTopicIndex(..))\")\n    public void deleteTopicIndex() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IIndexedService.batchDeleteIndex(..))\")\n    public void batchDeleteIndex() {\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/RoleService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 36
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.RoleMapper;\nimport co.yiiu.pybbs.model.Role;\nimport co.yiiu.pybbs.model.RolePermission;\nimport co.yiiu.pybbs.service.IRolePermissionService;\nimport co.yiiu.pybbs.service.IRoleService;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class RoleService implements IRoleService {\n\n    @Resource\n    private RoleMapper roleMapper;\n    @Resource\n    private IRolePermissionService rolePermissionService;\n    @Resource\n    private PermissionService permissionService;\n\n    @Override\n    public Role selectById(Integer roleId) {\n        return roleMapper.selectById(roleId);\n    }\n\n    @Override\n    public List<Role> selectAll() {\n        return roleMapper.selectList(null);\n    }\n\n    @Override\n    public void insert(String name, Integer[] permissionIds) {\n        Role role = new Role();\n        role.setName(name);\n        roleMapper.insert(role);\n        insertRolePermissions(role, permissionIds);\n    }\n\n    @Override\n    public void update(Integer id, String name, Integer[] permissionIds) {\n        // role\n        Role role = this.selectById(id);\n        role.setName(name);\n        roleMapper.updateById(role);\n        // role permission \n        rolePermissionService.deleteByRoleId(id);\n        // \n        insertRolePermissions(role, permissionIds);\n    }\n\n    private void insertRolePermissions(Role role, Integer[] permissionIds) {\n        for (Integer permissionId : permissionIds) {\n            RolePermission rolePermission = new RolePermission();\n            rolePermission.setRoleId(role.getId());\n            rolePermission.setPermissionId(permissionId);\n            rolePermissionService.insert(rolePermission);\n        }\n        // \n        permissionService.clearRolePermissionCache();\n    }\n\n    @Override\n    public void delete(Integer id) {\n        // \n        rolePermissionService.deleteByRoleId(id);\n        // \n        roleMapper.deleteById(id);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/SensitiveWordMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 37
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.SensitiveWord;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface SensitiveWordMapper extends BaseMapper<SensitiveWord> {\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/plugin/ElasticSearchService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 38
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.plugin;\n\nimport co.yiiu.pybbs.config.service.BaseService;\nimport co.yiiu.pybbs.model.SystemConfig;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\nimport org.apache.http.HttpHost;\nimport org.elasticsearch.action.admin.indices.create.CreateIndexRequest;\nimport org.elasticsearch.action.admin.indices.create.CreateIndexResponse;\nimport org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest;\nimport org.elasticsearch.action.admin.indices.get.GetIndexRequest;\nimport org.elasticsearch.action.bulk.BulkRequest;\nimport org.elasticsearch.action.delete.DeleteRequest;\nimport org.elasticsearch.action.index.IndexRequest;\nimport org.elasticsearch.action.search.SearchRequest;\nimport org.elasticsearch.action.search.SearchResponse;\nimport org.elasticsearch.action.support.IndicesOptions;\nimport org.elasticsearch.action.support.master.AcknowledgedResponse;\nimport org.elasticsearch.action.update.UpdateRequest;\nimport org.elasticsearch.client.RequestOptions;\nimport org.elasticsearch.client.RestClient;\nimport org.elasticsearch.client.RestHighLevelClient;\nimport org.elasticsearch.common.settings.Settings;\nimport org.elasticsearch.common.xcontent.XContentBuilder;\nimport org.elasticsearch.common.xcontent.json.JsonXContent;\nimport org.elasticsearch.index.query.QueryBuilders;\nimport org.elasticsearch.search.builder.SearchSourceBuilder;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.*;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\n@DependsOn(\"mybatisPlusConfig\")\npublic class ElasticSearchService implements BaseService<RestHighLevelClient> {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n    private final Logger log = LoggerFactory.getLogger(ElasticSearchService.class);\n    private RestHighLevelClient client;\n    // \n    private String name;\n\n    public static XContentBuilder topicMappingBuilder;\n\n    static {\n        try {\n            topicMappingBuilder = JsonXContent.contentBuilder()\n                    .startObject()\n                    .startObject(\"properties\")\n                    // .startObject(\"id\")\n                    // .field(\"type\", \"integer\")\n                    // .endObject()\n                    .startObject(\"title\")\n                    .field(\"type\", \"text\")\n                    .field(\"analyzer\", \"ik_max_word\")\n                    .field(\"index\", \"true\")\n                    .endObject()\n                    .startObject(\"content\")\n                    .field(\"type\", \"text\")\n                    .field(\"analyzer\", \"ik_max_word\")\n                    .field(\"index\", \"true\")\n                    .endObject()\n                    .endObject()\n                    .endObject();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n\n    @Override\n    public RestHighLevelClient instance() {\n        if (this.client != null) return client;\n        try {\n            SystemConfig systemConfigHost = systemConfigService.selectByKey(\"elasticsearch_host\");\n            String host = systemConfigHost.getValue();\n            SystemConfig systemConfigPort = systemConfigService.selectByKey(\"elasticsearch_port\");\n            String port = systemConfigPort.getValue();\n            SystemConfig systemConfigName = systemConfigService.selectByKey(\"elasticsearch_index\");\n            name = systemConfigName.getValue();\n\n            if (StringUtils.isEmpty(host) || StringUtils.isEmpty(port)) return null;\n            client = new RestHighLevelClient(RestClient.builder(new HttpHost(host, Integer.parseInt(port), \"http\")));\n            // \n            if (!this.existIndex()) this.createIndex(\"topic\", topicMappingBuilder);\n            return client;\n        } catch (NumberFormatException e) {\n            log.error(e.getMessage());\n            return null;\n        }\n    }\n\n    // \n    public boolean createIndex(String type, XContentBuilder mappingBuilder) {\n        try {\n            if (this.instance() == null) return false;\n            CreateIndexRequest request = new CreateIndexRequest(name);\n            request.settings(Settings.builder().put(\"index.number_of_shards\", 1).put(\"index.number_of_shards\", 5));\n            if (mappingBuilder != null) request.mapping(type, mappingBuilder);\n            CreateIndexResponse response = this.client.indices().create(request, RequestOptions.DEFAULT);\n            return response.isAcknowledged();\n        } catch (IOException e) {\n            log.error(e.getMessage());\n            return false;\n        }\n    }\n\n    // \n    public boolean existIndex() {\n        try {\n            if (this.instance() == null) return false;\n            GetIndexRequest request = new GetIndexRequest();\n            request.indices(name);\n            request.local(false);\n            request.humanReadable(true);\n            return client.indices().exists(request, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(e.getMessage());\n            return false;\n        }\n    }\n\n    // \n    public boolean deleteIndex() {\n        try {\n            if (this.instance() == null) return false;\n            DeleteIndexRequest request = new DeleteIndexRequest(name);\n            request.indicesOptions(IndicesOptions.LENIENT_EXPAND_OPEN);\n            AcknowledgedResponse response = client.indices().delete(request, RequestOptions.DEFAULT);\n            return response.isAcknowledged();\n        } catch (IOException e) {\n            log.error(e.getMessage());\n            return false;\n        }\n    }\n\n    // \n    public void createDocument(String type, String id, Map<String, Object> source) {\n        try {\n            if (this.instance() == null) return;\n            IndexRequest request = new IndexRequest(name, type, id);\n            request.source(source);\n            client.index(request, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(e.getMessage());\n        }\n    }\n\n    // \n    public void updateDocument(String type, String id, Map<String, Object> source) {\n        try {\n            if (this.instance() == null) return;\n            UpdateRequest request = new UpdateRequest(name, type, id);\n            request.doc(source);\n            client.update(request, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(e.getMessage());\n        }\n    }\n\n    // \n    public void deleteDocument(String type, String id) {\n        try {\n            if (this.instance() == null) return;\n            DeleteRequest request = new DeleteRequest(name, type, id);\n            client.delete(request, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(e.getMessage());\n        }\n    }\n\n    // \n    public void bulkDocument(String type, Map<String, Map<String, Object>> sources) {\n        try {\n            if (this.instance() == null) return;\n            BulkRequest requests = new BulkRequest();\n            Iterator<String> it = sources.keySet().iterator();\n            int count = 0;\n            while (it.hasNext()) {\n                count++;\n                String next = it.next();\n                IndexRequest request = new IndexRequest(name, type, next);\n                request.source(sources.get(next));\n                requests.add(request);\n                if (count % 1000 == 0) {\n                    client.bulk(requests, RequestOptions.DEFAULT);\n                    requests.requests().clear();\n                    count = 0;\n                }\n            }\n            if (requests.numberOfActions() > 0) client.bulk(requests, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(e.getMessage());\n        }\n    }\n\n    // \n    public void bulkDeleteDocument(String type, List<Integer> ids) {\n        try {\n            if (this.instance() == null) return;\n            BulkRequest requests = new BulkRequest();\n            int count = 0;\n            for (Integer id : ids) {\n                count++;\n                DeleteRequest request = new DeleteRequest(name, type, String.valueOf(id));\n                requests.add(request);\n                if (count % 1000 == 0) {\n                    client.bulk(requests, RequestOptions.DEFAULT);\n                    requests.requests().clear();\n                    count = 0;\n                }\n            }\n            if (requests.numberOfActions() > 0) client.bulk(requests, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(e.getMessage());\n        }\n    }\n\n    /**\n     * \n     *\n     * @param pageNo\n     * @param pageSize\n     * @param keyword  \n     * @param fields   \n     * @return  {@link Page}\n     */\n    public MyPage<Map<String, Object>> searchDocument(Integer pageNo, Integer pageSize, String keyword, String... fields) {\n        try {\n            if (this.instance() == null) return new MyPage<>();\n            SearchRequest request = new SearchRequest(name);\n            SearchSourceBuilder builder = new SearchSourceBuilder();\n            builder.query(QueryBuilders.multiMatchQuery(keyword, fields));\n            builder.from((pageNo - 1) * pageSize).size(pageSize);\n            request.source(builder);\n            SearchResponse response = client.search(request, RequestOptions.DEFAULT);\n            // \n            long totalCount = response.getHits().getTotalHits();\n            // \n            List<Map<String, Object>> records = Arrays.stream(response.getHits().getHits()).map(hit -> {\n                Map<String, Object> map = new HashMap<>();\n                map.put(\"id\", hit.getId());\n                map.putAll(hit.getSourceAsMap());\n                return map;\n            }).collect(Collectors.toList());\n            MyPage<Map<String, Object>> page = new MyPage<>(pageNo, pageSize);\n            page.setTotal(totalCount);\n            page.setRecords(records);\n            return page;\n        } catch (IOException e) {\n            log.error(e.getMessage());\n            return new MyPage<>();\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/IRoleService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 39
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Role;\n\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface IRoleService {\n    Role selectById(Integer roleId);\n\n    List<Role> selectAll();\n\n    void insert(String name, Integer[] permissionIds);\n\n    void update(Integer id, String name, Integer[] permissionIds);\n\n    void delete(Integer id);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/TagAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 40
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.service.ITagService;\nimport co.yiiu.pybbs.util.FileUtil;\nimport co.yiiu.pybbs.util.Result;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.*;\nimport org.springframework.web.multipart.MultipartFile;\n\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/tag\")\npublic class TagAdminController extends BaseAdminController {\n\n    @Resource\n    private ITagService tagService;\n    @Resource\n    private FileUtil fileUtil;\n\n    @RequiresPermissions(\"tag:list\")\n    @GetMapping(\"/list\")\n    public String list(@RequestParam(defaultValue = \"1\") Integer pageNo, String name, Model model) {\n        if (name != null) name = name.replace(\"\\\"\", \"\").replace(\"'\", \"\");\n//        name= SecurityUtil.sanitizeInput(name);\n        if (StringUtils.isEmpty(name)) name = null;\n        IPage<Tag> page = tagService.selectAll(pageNo, null, name);\n        model.addAttribute(\"page\", page);\n        model.addAttribute(\"name\", name);\n        return \"admin/tag/list\";\n    }\n\n    @RequiresPermissions(\"tag:edit\")\n    @GetMapping(\"/edit\")\n    public String edit(Integer id, Model model) {\n        model.addAttribute(\"tag\", tagService.selectById(id));\n        return \"admin/tag/edit\";\n    }\n\n    @RequiresPermissions(\"tag:edit\")\n    @PostMapping(\"/edit\")\n    public String update(Integer id, String name, String description, Integer topicCount, MultipartFile file) {\n        Tag tag = tagService.selectById(id);\n        tag.setName(name);\n        tag.setDescription(description);\n        tag.setTopicCount(topicCount);\n        String path = fileUtil.upload(file, null, \"tag\");\n        tag.setIcon(path);\n        tagService.update(tag);\n        return redirect(\"/admin/tag/list\");\n    }\n\n    @RequiresPermissions(\"tag:delete\")\n    @GetMapping(\"/delete\")\n    @ResponseBody\n    public Result delete(Integer id) {\n        Tag tag = tagService.selectById(id);\n        if (tag.getTopicCount() > 0) return error(\"\");\n        tagService.delete(id);\n        return success();\n    }\n\n    // \n    @RequiresPermissions(\"tag:async\")\n    @GetMapping(\"/async\")\n    @ResponseBody\n    public Result async() {\n        tagService.async();\n        return success();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/impl/MyGenerator.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 41
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.identicon.generator.impl;\n\nimport co.yiiu.pybbs.util.identicon.generator.IBaseGenerator;\n\nimport java.awt.*;\nimport java.util.Random;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2016, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class MyGenerator implements IBaseGenerator {\n\n    private Random random = new Random();\n\n    @Override\n    public boolean[][] getBooleanValueArray(String hash) {\n\n        boolean[][] array = new boolean[5][5];\n\n        //\n        for (int i = 0; i < 5; i++) {\n            for (int j = 0; j < 5; j++) {\n                array[i][j] = false;\n            }\n        }\n\n        for (int i = 0; i < 15; i++) {\n            if (i % 3 == 0) {\n                boolean b = random.nextBoolean();\n                array[i / 3][0] = b;\n                array[i / 3][4] = b;\n            } else if (i % 3 == 1) {\n                boolean b = random.nextBoolean();\n                array[i / 3][1] = b;\n                array[i / 3][3] = b;\n            } else {\n                boolean b = random.nextBoolean();\n                array[i / 3][2] = b;\n            }\n        }\n\n        return array;\n    }\n\n    @Override\n    public Color getBackgroundColor() {\n        return new Color(236, 236, 236);\n    }\n\n    @Override\n    public Color getForegroundColor() {\n        int r = random.nextInt(256);\n        int g = random.nextInt(256);\n        int b = random.nextInt(256);\n        return new Color(r, g, b);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/RoleMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 42
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Role;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface RoleMapper extends BaseMapper<Role> {\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/PybbsApplication.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 43
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration;\nimport org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;\nimport org.springframework.context.annotation.EnableAspectJAutoProxy;\n\n// \n@SpringBootApplication(scanBasePackages = \"co.yiiu.pybbs\",\n        exclude = {DataSourceAutoConfiguration.class, FlywayAutoConfiguration.class})\n@EnableAspectJAutoProxy\npublic class PybbsApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(PybbsApplication.class, args);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/NotificationService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 44
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.NotificationMapper;\nimport co.yiiu.pybbs.model.Notification;\nimport co.yiiu.pybbs.service.INotificationService;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class NotificationService implements INotificationService {\n\n    @Resource\n    private NotificationMapper notificationMapper;\n\n    // \n    @Override\n    public List<Map<String, Object>> selectByUserId(Integer userId, Boolean read, Integer limit) {\n        List<Map<String, Object>> notifications = notificationMapper.selectByUserId(userId, read, limit);\n        return notifications;\n    }\n\n    @Override\n    public void markRead(Integer userId) {\n        notificationMapper.updateNotificationStatus(userId);\n    }\n\n    // \n    @Override\n    public long countNotRead(Integer userId) {\n        return notificationMapper.countNotRead(userId);\n    }\n\n    @Override\n    public void deleteByTopicId(Integer topicId) {\n        QueryWrapper<Notification> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Notification::getTopicId, topicId);\n        notificationMapper.delete(wrapper);\n    }\n\n    @Override\n    public void deleteByUserId(Integer userId) {\n        QueryWrapper<Notification> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Notification::getTargetUserId, userId).or().eq(Notification::getUserId, userId);\n        notificationMapper.delete(wrapper);\n    }\n\n    @Override\n    public void insert(Integer userId, Integer targetUserId, Integer topicId, String action, String content) {\n        Notification notification = new Notification();\n        notification.setAction(action);\n        notification.setContent(content);\n        notification.setUserId(userId);\n        notification.setTargetUserId(targetUserId);\n        notification.setTopicId(topicId);\n        notification.setInTime(new Date());\n        notification.setRead(false);\n        notificationMapper.insert(notification);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/Message.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 45
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport java.io.Serializable;\n\npublic class Message implements Serializable {\n\n    private static final long serialVersionUID = 1244988167184789309L;\n\n    private String type;\n    private Object payload;\n\n    public Message() {\n    }\n\n    public Message(String type, Object payload) {\n        this.type = type;\n        this.payload = payload;\n    }\n\n    public String getType() {\n        return type;\n    }\n\n    public void setType(String type) {\n        this.type = type;\n    }\n\n    public Object getPayload() {\n        return payload;\n    }\n\n    public void setPayload(Object payload) {\n        this.payload = payload;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/package-info.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 46
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\n/**\n * \n * : https://blog.csdn.net/qq_34875064/article/details/51312127\n */"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/NotificationMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 47
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Notification;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Param;\nimport org.apache.ibatis.annotations.Select;\nimport org.apache.ibatis.annotations.Update;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface NotificationMapper extends BaseMapper<Notification> {\n\n    List<Map<String, Object>> selectByUserId(@Param(\"userId\") Integer userId, @Param(\"read\") Boolean read, @Param\n            (\"limit\") Integer limit);\n\n    // \n    @Select(\"select count(1) from notification where target_user_id = #{userId} and `read` = false\")\n    long countNotRead(@Param(\"userId\") Integer userId);\n\n    // \n    @Update(\"update notification set `read` = true where target_user_id = #{targetUserId}\")\n    void updateNotificationStatus(@Param(\"targetUserId\") Integer targetUserId);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ITagService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 48
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ITagService {\n    void selectTagsByTopicId(MyPage<Map<String, Object>> page);\n\n    Tag selectById(Integer id);\n\n    Tag selectByName(String name);\n\n    List<Tag> selectByIds(List<Integer> ids);\n\n    // \n    List<Tag> selectByTopicId(Integer topicId);\n\n    // tag\n    List<Tag> insertTag(String newTags);\n\n    // -1\n    void reduceTopicCount(Integer id);\n\n    // \n    MyPage<Map<String, Object>> selectTopicByTagId(Integer tagId, Integer pageNo);\n\n    // \n    IPage<Tag> selectAll(Integer pageNo, Integer pageSize, String name);\n\n    void update(Tag tag);\n\n    //  topic_tag \n    void delete(Integer id);\n\n    //\n    void async();\n\n    // \n    int countToday();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/SearchDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 49
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class SearchDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private ITopicService topicService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        Page<Map<String, Object>> page = new Page<>();\n        String keyword = String.valueOf(map.get(\"keyword\"));\n        Integer pageNo = Integer.parseInt(map.get(\"pageNo\").toString());\n        if (!StringUtils.isEmpty(keyword)) {\n            Integer pageSize = Integer.parseInt(systemConfigService.selectAllConfig().get(\"page_size\").toString());\n//      page = elasticSearchService.searchDocument(pageNo, pageSize, keyword, \"title\", \"content\");\n            page = topicService.search(pageNo, pageSize, keyword);\n        }\n\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"page\", builder.build().wrap(page));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/SensitiveWordService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 50
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.SensitiveWordMapper;\nimport co.yiiu.pybbs.model.SensitiveWord;\nimport co.yiiu.pybbs.service.ISensitiveWordService;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class SensitiveWordService implements ISensitiveWordService {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    @Resource\n    private SensitiveWordMapper sensitiveWordMapper;\n\n    @Override\n    public void save(SensitiveWord sensitiveWord) {\n        sensitiveWordMapper.insert(sensitiveWord);\n    }\n\n    @Override\n    public void update(SensitiveWord sensitiveWord) {\n        sensitiveWordMapper.updateById(sensitiveWord);\n    }\n\n    @Override\n    public List<SensitiveWord> selectAll() {\n        return sensitiveWordMapper.selectList(null);\n    }\n\n    @Override\n    public void deleteById(Integer id) {\n        sensitiveWordMapper.deleteById(id);\n    }\n\n    // ---------admin------------\n\n    @Override\n    public IPage<SensitiveWord> page(Integer pageNo, String word) {\n        IPage<SensitiveWord> iPage = new MyPage<>(pageNo, Integer.parseInt(systemConfigService.selectAllConfig().get\n                (\"page_size\").toString()));\n        QueryWrapper<SensitiveWord> wrapper = new QueryWrapper<>();\n        if (!StringUtils.isEmpty(word)) wrapper.lambda().eq(SensitiveWord::getWord, word);\n        return sensitiveWordMapper.selectPage(iPage, wrapper);\n    }\n\n    @Override\n    public void updateWordById(Integer id, String word) {\n        SensitiveWord sensitiveWord = new SensitiveWord();\n        sensitiveWord.setId(id);\n        sensitiveWord.setWord(word);\n        sensitiveWordMapper.updateById(sensitiveWord);\n    }\n\n    @Override\n    public SensitiveWord selectByWord(String word) {\n        QueryWrapper<SensitiveWord> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(SensitiveWord::getWord, word);\n        return sensitiveWordMapper.selectOne(wrapper);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/TopicCommentsDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 51
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.service.ICommentService;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class TopicCommentsDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ICommentService commentService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        Integer topicId = Integer.parseInt(map.get(\"topicId\").toString());\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"comments\", builder.build().wrap(commentService.selectByTopicId(topicId)));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/UserCommentsDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 52
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICommentService;\nimport co.yiiu.pybbs.service.IUserService;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class UserCommentsDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private IUserService userService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        String username = String.valueOf(map.get(\"username\"));\n        Integer pageNo = Integer.parseInt(map.get(\"pageNo\").toString());\n        Integer pageSize = map.get(\"pageSize\") == null ? null : Integer.parseInt(map.get(\"pageSize\").toString());\n        User user = userService.selectByUsername(username);\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"comments\", builder.build().wrap(commentService.selectByUserId(user.getId(), pageNo,\n                pageSize)));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/TopicListDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 53
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.util.MyPage;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class TopicListDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ITopicService topicService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels,\n                        TemplateDirectiveBody templateDirectiveBody) throws TemplateException, IOException {\n        Integer pageNo = Integer.parseInt(map.get(\"pageNo\").toString());\n        String tab = map.get(\"tab\").toString();\n        MyPage<Map<String, Object>> page = topicService.selectAll(pageNo, tab);\n\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"page\", builder.build().wrap(page));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/AdminUserMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 54
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.AdminUser;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface AdminUserMapper extends BaseMapper<AdminUser> {\n\n    List<Map<String, Object>> selectAll();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Randoms.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 55
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\nimport java.util.Random;\n\n/**\n * <p></p>\n *\n * @author: wuhongjun\n * @version:1.0\n */\npublic class Randoms {\n    private static final Random RANDOM = new Random();\n    //.OI\n    public static final char ALPHA[] = {'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'G', 'K', 'M', 'N', 'P', 'Q', 'R', 'S',\n            'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'm', 'n', 'p', 'q',\n            'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '2', '3', '4', '5', '6', '7', '8', '9'};\n\n    /**\n     * \n     *\n     * @param min \n     * @param max min\n     * @return int \n     */\n    public static int num(int min, int max) {\n        return min + RANDOM.nextInt(max - min);\n    }\n\n    /**\n     * 0--num,num\n     *\n     * @param num \n     * @return int \n     */\n    public static int num(int num) {\n        return RANDOM.nextInt(num);\n    }\n\n    public static char alpha() {\n        return ALPHA[num(0, ALPHA.length)];\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/OAuthUserService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 56
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.OAuthUserMapper;\nimport co.yiiu.pybbs.model.OAuthUser;\nimport co.yiiu.pybbs.service.IOAuthUserService;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class OAuthUserService implements IOAuthUserService {\n\n    @Resource\n    private OAuthUserMapper oAuthUserMapper;\n\n    @Override\n    public OAuthUser selectByTypeAndLogin(String type, String login) {\n        QueryWrapper<OAuthUser> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(OAuthUser::getType, type).eq(OAuthUser::getLogin, login);\n        return oAuthUserMapper.selectOne(wrapper);\n    }\n\n    @Override\n    public List<OAuthUser> selectByUserId(Integer userId) {\n        QueryWrapper<OAuthUser> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(OAuthUser::getUserId, userId);\n        return oAuthUserMapper.selectList(wrapper);\n    }\n\n    @Override\n    public void addOAuthUser(Integer oauthId, String type, String login, String accessToken, String bio, String email,\n                             Integer userId, String refreshToken, String unionId, String openId) {\n        OAuthUser oAuthUser = new OAuthUser();\n        oAuthUser.setOauthId(oauthId);\n        oAuthUser.setType(type);\n        oAuthUser.setLogin(login);\n        oAuthUser.setAccessToken(accessToken);\n        oAuthUser.setBio(bio);\n        oAuthUser.setEmail(email);\n        oAuthUser.setUserId(userId);\n        oAuthUser.setInTime(new Date());\n        oAuthUserMapper.insert(oAuthUser);\n    }\n\n    @Override\n    public void update(OAuthUser oAuthUser) {\n        oAuthUserMapper.updateById(oAuthUser);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ITopicService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 57
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.util.MyPage;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ITopicService {\n    // \n    MyPage<Map<String, Object>> search(Integer pageNo, Integer pageSize, String keyword);\n\n    // \n    MyPage<Map<String, Object>> selectAll(Integer pageNo, String tab);\n\n    // \n    List<Topic> selectAuthorOtherTopic(Integer userId, Integer topicId, Integer limit);\n\n    // \n    MyPage<Map<String, Object>> selectByUserId(Integer userId, Integer pageNo, Integer pageSize);\n\n    // \n    Topic insert(String title, String content, String tags, User user);\n\n    // id\n    Topic selectById(Integer id);\n\n    // title\n    Topic selectByTitle(String title);\n\n    // \n    Topic updateViewCount(Topic topic, String ip);\n\n    // \n    void update(Topic topic, String tags);\n\n    // \n    void delete(Topic topic);\n\n    // id\n    void deleteByUserId(Integer userId);\n\n    MyPage<Map<String, Object>> selectAllForAdmin(Integer pageNo, String startDate, String endDate, String username);\n\n    // \n    int countToday();\n\n    int vote(Topic topic, User user);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyCredentialsMatcher.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 58
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.realm;\n\nimport co.yiiu.pybbs.util.bcrypt.BCryptPasswordEncoder;\nimport org.apache.shiro.authc.AuthenticationInfo;\nimport org.apache.shiro.authc.AuthenticationToken;\nimport org.apache.shiro.authc.credential.CredentialsMatcher;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class MyCredentialsMatcher implements CredentialsMatcher {\n\n    @Override\n    public boolean doCredentialsMatch(AuthenticationToken token, AuthenticationInfo info) {\n        // \n        // tokeninfoCredentialsObject char[]\n        //  tokenString char[]\n        // infoCredentials String.valueOf() String\n        // \n        String rawPassword = String.valueOf((char[]) token.getCredentials());\n        String encodedPassword = String.valueOf(info.getCredentials());\n        return new BCryptPasswordEncoder().matches(rawPassword, encodedPassword);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/IndexedService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 59
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.service.IIndexedService;\nimport org.springframework.stereotype.Service;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\npublic class IndexedService implements IIndexedService {\n\n    // \n    @Override\n    public void indexAllTopic() {\n    }\n\n    // \n    @Override\n    public void indexTopic(String id, String title, String content) {\n    }\n\n    // \n    @Override\n    public void deleteTopicIndex(String id) {\n    }\n\n    // \n    @Override\n    public void batchDeleteIndex() {\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/PermissionAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 60
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.model.Permission;\nimport co.yiiu.pybbs.service.IPermissionService;\nimport co.yiiu.pybbs.util.Result;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.ResponseBody;\n\nimport javax.annotation.Resource;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/permission\")\npublic class PermissionAdminController extends BaseAdminController {\n\n    @Resource\n    private IPermissionService permissionService;\n\n    @RequiresPermissions(\"permission:list\")\n    @GetMapping(\"/list\")\n    public String list(Integer pid, Model model) {\n        List<Permission> permissions = permissionService.selectByPid(0);\n        model.addAttribute(\"permissions\", permissions);\n        List<Permission> childPermissions;\n        if (pid == null || pid == 0) {\n            childPermissions = permissionService.selectByPid(permissions.get(0).getId());\n        } else {\n            childPermissions = permissionService.selectByPid(pid);\n        }\n        model.addAttribute(\"childPermissions\", childPermissions);\n        model.addAttribute(\"pid\", pid);\n        return \"admin/permission/list\";\n    }\n\n    @RequiresPermissions(\"permission:add\")\n    @PostMapping(\"/add\")\n    @ResponseBody\n    public Result add(Permission permission) {\n        permission = permissionService.insert(permission);\n        return success(permission.getPid() == 0 ? permission.getId() : permission.getPid());\n    }\n\n    @RequiresPermissions(\"permission:edit\")\n    @PostMapping(\"/edit\")\n    @ResponseBody\n    public Result edit(Permission permission) {\n        permission = permissionService.update(permission);\n        return success(permission.getPid() == 0 ? permission.getId() : permission.getPid());\n    }\n\n    @RequiresPermissions(\"permission:delete\")\n    @GetMapping(\"/delete\")\n    @ResponseBody\n    public Result delete(Integer id) {\n        permissionService.delete(id);\n        return success();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/FreemarkerConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 61
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport co.yiiu.pybbs.directive.*;\nimport co.yiiu.pybbs.util.BaseModel;\nimport co.yiiu.pybbs.util.LocaleMessageSourceUtil;\nimport freemarker.template.TemplateModelException;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.servlet.view.freemarker.FreeMarkerConfig;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\npublic class FreemarkerConfig {\n\n    private Logger log = LoggerFactory.getLogger(FreeMarkerConfig.class);\n\n    @Resource\n    private freemarker.template.Configuration configuration;\n    @Resource\n    private TopicListDirective topicListDirective;\n    @Resource\n    private OtherTopicDirective otherTopicDirective;\n    @Resource\n    private NotificationsDirective notificationsDirective;\n    @Resource\n    private ScoreDirective scoreDirective;\n    @Resource\n    private SearchDirective searchDirective;\n    @Resource\n    private TagsDirective tagsDirective;\n    @Resource\n    private UserTopicsDirective userTopicsDirective;\n    @Resource\n    private UserCommentsDirective userCommentsDirective;\n    @Resource\n    private UserCollectsDirective userCollectsDirective;\n    @Resource\n    private TopicCommentsDirective topicCommentsDirective;\n    @Resource\n    private SocialDirective socialDirective;\n    @Resource\n    private BaseModel baseModel;\n    @Resource\n    private ShiroTag shiroTag;\n    @Resource\n    private LocaleMessageSourceUtil localeMessageSourceUtil;\n\n    @PostConstruct\n    public void setSharedVariable() throws TemplateModelException {\n        //freemarker\n        log.info(\"freemarker...\");\n        configuration.setSharedVariable(\"model\", baseModel);\n        // shiro\n        configuration.setSharedVariable(\"sec\", shiroTag);\n        log.info(\"freemarker!\");\n\n        log.info(\"freemarker...\");\n        configuration.setSharedVariable(\"tag_topics\", topicListDirective);\n        configuration.setSharedVariable(\"tag_other_topic\", otherTopicDirective);\n        configuration.setSharedVariable(\"tag_notifications\", notificationsDirective);\n        configuration.setSharedVariable(\"tag_score\", scoreDirective);\n        configuration.setSharedVariable(\"tag_search\", searchDirective);\n        configuration.setSharedVariable(\"tag_tags\", tagsDirective);\n        configuration.setSharedVariable(\"tag_user_topics\", userTopicsDirective);\n        configuration.setSharedVariable(\"tag_user_comments\", userCommentsDirective);\n        configuration.setSharedVariable(\"tag_user_collects\", userCollectsDirective);\n        configuration.setSharedVariable(\"tag_topic_comments\", topicCommentsDirective);\n        configuration.setSharedVariable(\"tag_social_list\", socialDirective);\n\n        configuration.setSharedVariable(\"i18n\", localeMessageSourceUtil);\n        log.info(\"freemarker!\");\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CollectApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 62
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.exception.ApiAssert;\nimport co.yiiu.pybbs.model.Collect;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICollectService;\nimport co.yiiu.pybbs.util.Result;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@RestController\n@RequestMapping(\"/api/collect\")\npublic class CollectApiController extends BaseApiController {\n\n    @Resource\n    private ICollectService collectService;\n\n    // \n    @PostMapping(\"/{topicId}\")\n    public Result get(@PathVariable Integer topicId) {\n        User user = getApiUser();\n        Collect collect = collectService.selectByTopicIdAndUserId(topicId, user.getId());\n        ApiAssert.isNull(collect, \"\");\n        collectService.insert(topicId, user);\n        return success();\n    }\n\n    // \n    @DeleteMapping(\"/{topicId}\")\n    public Result delete(@PathVariable Integer topicId) {\n        User user = getApiUser();\n        Collect collect = collectService.selectByTopicIdAndUserId(topicId, user.getId());\n        ApiAssert.notNull(collect, \"\");\n        collectService.delete(topicId, user.getId());\n        return success();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/IUserService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 63
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.User;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\n\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface IUserService {\n    // \n    User selectByUsername(String username);\n\n    User addUser(String username, String password, String avatar, String email, String bio, String website,\n                 boolean needActiveEmail);\n\n    // /\n    User addUserWithMobile(String mobile);\n\n    // token\n    User selectByToken(String token);\n\n    // mobile\n    User selectByMobile(String mobile);\n\n    // email\n    User selectByEmail(String email);\n\n    User selectById(Integer id);\n\n    User selectByIdWithoutCache(Integer id);\n\n    // \n    List<User> selectTop(Integer limit);\n\n    // \n    void update(User user);\n\n    IPage<User> selectAll(Integer pageNo, String username);\n\n    User selectByIdNoCatch(Integer id);\n\n    // \n    int countToday();\n\n    // \n    void deleteUser(Integer id);\n\n    // redis\n    void delRedisUser(User user);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/plugin/ElasticSearchPlugin.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 64
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.plugin;\n\nimport co.yiiu.pybbs.mapper.TopicMapper;\nimport co.yiiu.pybbs.model.Topic;\nimport org.aspectj.lang.JoinPoint;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.After;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\n@Aspect\npublic class ElasticSearchPlugin {\n\n    @Resource\n    private ElasticSearchService elasticSearchService;\n    @Resource\n    private TopicMapper topicMapper;\n\n    @Around(\"co.yiiu.pybbs.hook.TopicServiceHook.search()\")\n    public Object search(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        Object[] args = proceedingJoinPoint.getArgs();\n        if (elasticSearchService.instance() == null) return proceedingJoinPoint.proceed(args);\n        return elasticSearchService.searchDocument((Integer) args[0], (Integer) args[1], (String) args[2], \"title\", \"content\");\n    }\n\n    @After(\"co.yiiu.pybbs.hook.IndexedServiceHook.indexAllTopic()\")\n    public void indexAllTopic() {\n        if (elasticSearchService.instance() != null) {\n            List<Topic> topics = topicMapper.selectList(null);\n            Map<String, Map<String, Object>> sources = topics.stream().collect(Collectors.toMap(key -> String.valueOf(key\n                    .getId()), value -> {\n                Map<String, Object> map = new HashMap<>();\n                map.put(\"title\", value.getTitle());\n                map.put(\"content\", value.getContent());\n                return map;\n            }));\n            elasticSearchService.bulkDocument(\"topic\", sources);\n        }\n    }\n\n    @After(\"co.yiiu.pybbs.hook.IndexedServiceHook.indexTopic()\")\n    public void indexTopic(JoinPoint joinPoint) {\n        if (elasticSearchService.instance() != null) {\n            Object[] args = joinPoint.getArgs();\n            Map<String, Object> source = new HashMap<>();\n            source.put(\"title\", args[1]);\n            source.put(\"content\", args[2]);\n            elasticSearchService.createDocument(\"topic\", (String) args[0], source);\n        }\n    }\n\n    @After(\"co.yiiu.pybbs.hook.IndexedServiceHook.deleteTopicIndex()\")\n    public void deleteTopicIndex(JoinPoint joinPoint) {\n        if (elasticSearchService.instance() != null) {\n            elasticSearchService.deleteDocument(\"topic\", (String) joinPoint.getArgs()[0]);\n        }\n    }\n\n    @After(\"co.yiiu.pybbs.hook.IndexedServiceHook.batchDeleteIndex()\")\n    public void batchDeleteIndex(JoinPoint joinPoint) {\n        if (elasticSearchService.instance() != null) {\n            List<Topic> topics = topicMapper.selectList(null);\n            List<Integer> ids = topics.stream().map(Topic::getId).collect(Collectors.toList());\n            elasticSearchService.bulkDeleteDocument(\"topic\", ids);\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Quant.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 65
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\n/**\n * <p></p>\n *\n * @author: wuhongjun\n * @version:1.0\n */\npublic class Quant {\n    protected static final int netsize = 256; /* number of colours used */\n\n    /* four primes near 500 - assume no image has a length so large */\n    /* that it is divisible by all four primes */\n    protected static final int prime1 = 499;\n    protected static final int prime2 = 491;\n    protected static final int prime3 = 487;\n    protected static final int prime4 = 503;\n\n    protected static final int minpicturebytes = (3 * prime4);\n    /* minimum size for input image */\n \n\t/* Program Skeleton\n\t   ----------------\n\t   [select samplefac in range 1..30]\n\t   [read image from input file]\n\t   pic = (unsigned char*) malloc(3*width*height);\n\t   initnet(pic,3*width*height,samplefac);\n\t   learn();\n\t   unbiasnet();\n\t   [write output image header, using writecolourmap(f)]\n\t   inxbuild();\n\t   write output image using inxsearch(b,g,r)      */\n \n\t/* Network Definitions\n\t   ------------------- */\n\n    protected static final int maxnetpos = (netsize - 1);\n    protected static final int netbiasshift = 4; /* bias for colour values */\n    protected static final int ncycles = 100; /* no. of learning cycles */\n\n    /* defs for freq and bias */\n    protected static final int intbiasshift = 16; /* bias for fractions */\n    protected static final int intbias = (((int) 1) << intbiasshift);\n    protected static final int gammashift = 10; /* gamma = 1024 */\n    protected static final int gamma = (((int) 1) << gammashift);\n    protected static final int betashift = 10;\n    protected static final int beta = (intbias >> betashift); /* beta = 1/1024 */\n    protected static final int betagamma = (intbias << (gammashift - betashift));\n\n    /* defs for decreasing radius factor */\n    protected static final int initrad = (netsize >> 3); /* for 256 cols, radius starts */\n    protected static final int radiusbiasshift = 6; /* at 32.0 biased by 6 bits */\n    protected static final int radiusbias = (((int) 1) << radiusbiasshift);\n    protected static final int initradius = (initrad * radiusbias); /* and decreases by a */\n    protected static final int radiusdec = 30; /* factor of 1/30 each cycle */\n\n    /* defs for decreasing alpha factor */\n    protected static final int alphabiasshift = 10; /* alpha starts at 1.0 */\n    protected static final int initalpha = (((int) 1) << alphabiasshift);\n\n    protected int alphadec; /* biased by 10 bits */\n\n    /* radbias and alpharadbias used for radpower calculation */\n    protected static final int radbiasshift = 8;\n    protected static final int radbias = (((int) 1) << radbiasshift);\n    protected static final int alpharadbshift = (alphabiasshift + radbiasshift);\n    protected static final int alpharadbias = (((int) 1) << alpharadbshift);\n \n\t/* Types and Global Variables\n\t-------------------------- */\n\n    protected byte[] thepicture; /* the input image itself */\n    protected int lengthcount; /* lengthcount = H*W*3 */\n\n    protected int samplefac; /* sampling factor 1..30 */\n\n    //   typedef int pixel[4];                /* BGRc */\n    protected int[][] network; /* the network itself - [netsize][4] */\n\n    protected int[] netindex = new int[256];\n    /* for network lookup - really 256 */\n\n    protected int[] bias = new int[netsize];\n    /* bias and freq arrays for learning */\n    protected int[] freq = new int[netsize];\n    protected int[] radpower = new int[initrad];\n    /* radpower for precomputation */\n\n    /* Initialise network in range (0,0,0) to (255,255,255) and set parameters\n       ----------------------------------------------------------------------- */\n    public Quant(byte[] thepic, int len, int sample) {\n\n        int i;\n        int[] p;\n\n        thepicture = thepic;\n        lengthcount = len;\n        samplefac = sample;\n\n        network = new int[netsize][];\n        for (i = 0; i < netsize; i++) {\n            network[i] = new int[4];\n            p = network[i];\n            p[0] = p[1] = p[2] = (i << (netbiasshift + 8)) / netsize;\n            freq[i] = intbias / netsize; /* 1/netsize */\n            bias[i] = 0;\n        }\n    }\n\n    public byte[] colorMap() {\n        byte[] map = new byte[3 * netsize];\n        int[] index = new int[netsize];\n        for (int i = 0; i < netsize; i++)\n            index[network[i][3]] = i;\n        int k = 0;\n        for (int i = 0; i < netsize; i++) {\n            int j = index[i];\n            map[k++] = (byte) (network[j][0]);\n            map[k++] = (byte) (network[j][1]);\n            map[k++] = (byte) (network[j][2]);\n        }\n        return map;\n    }\n\n    /* Insertion sort of network and building of netindex[0..255] (to do after unbias)\n       ------------------------------------------------------------------------------- */\n    public void inxbuild() {\n\n        int i, j, smallpos, smallval;\n        int[] p;\n        int[] q;\n        int previouscol, startpos;\n\n        previouscol = 0;\n        startpos = 0;\n        for (i = 0; i < netsize; i++) {\n            p = network[i];\n            smallpos = i;\n            smallval = p[1]; /* index on g */\n            /* find smallest in i..netsize-1 */\n            for (j = i + 1; j < netsize; j++) {\n                q = network[j];\n                if (q[1] < smallval) { /* index on g */\n                    smallpos = j;\n                    smallval = q[1]; /* index on g */\n                }\n            }\n            q = network[smallpos];\n            /* swap p (i) and q (smallpos) entries */\n            if (i != smallpos) {\n                j = q[0];\n                q[0] = p[0];\n                p[0] = j;\n                j = q[1];\n                q[1] = p[1];\n                p[1] = j;\n                j = q[2];\n                q[2] = p[2];\n                p[2] = j;\n                j = q[3];\n                q[3] = p[3];\n                p[3] = j;\n            }\n            /* smallval entry is now in position i */\n            if (smallval != previouscol) {\n                netindex[previouscol] = (startpos + i) >> 1;\n                for (j = previouscol + 1; j < smallval; j++)\n                    netindex[j] = i;\n                previouscol = smallval;\n                startpos = i;\n            }\n        }\n        netindex[previouscol] = (startpos + maxnetpos) >> 1;\n        for (j = previouscol + 1; j < 256; j++)\n            netindex[j] = maxnetpos; /* really 256 */\n    }\n\n    /* Main Learning Loop\n       ------------------ */\n    public void learn() {\n\n        int i, j, b, g, r;\n        int radius, rad, alpha, step, delta, samplepixels;\n        byte[] p;\n        int pix, lim;\n\n        if (lengthcount < minpicturebytes) samplefac = 1;\n        alphadec = 30 + ((samplefac - 1) / 3);\n        p = thepicture;\n        pix = 0;\n        lim = lengthcount;\n        samplepixels = lengthcount / (3 * samplefac);\n        delta = samplepixels / ncycles;\n        alpha = initalpha;\n        radius = initradius;\n\n        rad = radius >> radiusbiasshift;\n        if (rad <= 1) rad = 0;\n        for (i = 0; i < rad; i++)\n            radpower[i] = alpha * (((rad * rad - i * i) * radbias) / (rad * rad));\n\n        //fprintf(stderr,\"beginning 1D learning: initial radius=%d\\n\", rad);\n\n        if (lengthcount < minpicturebytes) step = 3;\n        else if ((lengthcount % prime1) != 0) step = 3 * prime1;\n        else {\n            if ((lengthcount % prime2) != 0) step = 3 * prime2;\n            else {\n                if ((lengthcount % prime3) != 0) step = 3 * prime3;\n                else step = 3 * prime4;\n            }\n        }\n\n        i = 0;\n        while (i < samplepixels) {\n            b = (p[pix + 0] & 0xff) << netbiasshift;\n            g = (p[pix + 1] & 0xff) << netbiasshift;\n            r = (p[pix + 2] & 0xff) << netbiasshift;\n            j = contest(b, g, r);\n\n            altersingle(alpha, j, b, g, r);\n            if (rad != 0) alterneigh(rad, j, b, g, r); /* alter neighbours */\n\n            pix += step;\n            if (pix >= lim) pix -= lengthcount;\n\n            i++;\n            if (delta == 0) delta = 1;\n            if (i % delta == 0) {\n                alpha -= alpha / alphadec;\n                radius -= radius / radiusdec;\n                rad = radius >> radiusbiasshift;\n                if (rad <= 1) rad = 0;\n                for (j = 0; j < rad; j++)\n                    radpower[j] = alpha * (((rad * rad - j * j) * radbias) / (rad * rad));\n            }\n        }\n        //fprintf(stderr,\"finished 1D learning: final alpha=%f !\\n\",((float)alpha)/initalpha);\n    }\n\n    /* Search for BGR values 0..255 (after net is unbiased) and return colour index\n       ---------------------------------------------------------------------------- */\n    public int map(int b, int g, int r) {\n\n        int i, j, dist, a, bestd;\n        int[] p;\n        int best;\n\n        bestd = 1000; /* biggest possible dist is 256*3 */\n        best = -1;\n        i = netindex[g]; /* index on g */\n        j = i - 1; /* start at netindex[g] and work outwards */\n\n        while ((i < netsize) || (j >= 0)) {\n            if (i < netsize) {\n                p = network[i];\n                dist = p[1] - g; /* inx key */\n                if (dist >= bestd) i = netsize; /* stop iter */\n                else {\n                    i++;\n                    if (dist < 0) dist = -dist;\n                    a = p[0] - b;\n                    if (a < 0) a = -a;\n                    dist += a;\n                    if (dist < bestd) {\n                        a = p[2] - r;\n                        if (a < 0) a = -a;\n                        dist += a;\n                        if (dist < bestd) {\n                            bestd = dist;\n                            best = p[3];\n                        }\n                    }\n                }\n            }\n            if (j >= 0) {\n                p = network[j];\n                dist = g - p[1]; /* inx key - reverse dif */\n                if (dist >= bestd) j = -1; /* stop iter */\n                else {\n                    j--;\n                    if (dist < 0) dist = -dist;\n                    a = p[0] - b;\n                    if (a < 0) a = -a;\n                    dist += a;\n                    if (dist < bestd) {\n                        a = p[2] - r;\n                        if (a < 0) a = -a;\n                        dist += a;\n                        if (dist < bestd) {\n                            bestd = dist;\n                            best = p[3];\n                        }\n                    }\n                }\n            }\n        }\n        return (best);\n    }\n\n    public byte[] process() {\n        learn();\n        unbiasnet();\n        inxbuild();\n        return colorMap();\n    }\n\n    /* Unbias network to give byte values 0..255 and record position i to prepare for sort\n       ----------------------------------------------------------------------------------- */\n    public void unbiasnet() {\n        int i;\n        for (i = 0; i < netsize; i++) {\n            network[i][0] >>= netbiasshift;\n            network[i][1] >>= netbiasshift;\n            network[i][2] >>= netbiasshift;\n            network[i][3] = i; /* record colour no */\n        }\n    }\n\n    /* Move adjacent neurons by precomputed alpha*(1-((i-j)^2/[r]^2)) in radpower[|i-j|]\n       --------------------------------------------------------------------------------- */\n    protected void alterneigh(int rad, int i, int b, int g, int r) {\n\n        int j, k, lo, hi, a, m;\n        int[] p;\n\n        lo = i - rad;\n        if (lo < -1) lo = -1;\n        hi = i + rad;\n        if (hi > netsize) hi = netsize;\n\n        j = i + 1;\n        k = i - 1;\n        m = 1;\n        while ((j < hi) || (k > lo)) {\n            a = radpower[m++];\n            if (j < hi) {\n                p = network[j++];\n                try {\n                    p[0] -= (a * (p[0] - b)) / alpharadbias;\n                    p[1] -= (a * (p[1] - g)) / alpharadbias;\n                    p[2] -= (a * (p[2] - r)) / alpharadbias;\n                } catch (Exception e) {\n                } // prevents 1.3 miscompilation\n            }\n            if (k > lo) {\n                p = network[k--];\n                try {\n                    p[0] -= (a * (p[0] - b)) / alpharadbias;\n                    p[1] -= (a * (p[1] - g)) / alpharadbias;\n                    p[2] -= (a * (p[2] - r)) / alpharadbias;\n                } catch (Exception e) {\n                }\n            }\n        }\n    }\n\n    /* Move neuron i towards biased (b,g,r) by factor alpha\n       ---------------------------------------------------- */\n    protected void altersingle(int alpha, int i, int b, int g, int r) {\n\n        /* alter hit neuron */\n        int[] n = network[i];\n        n[0] -= (alpha * (n[0] - b)) / initalpha;\n        n[1] -= (alpha * (n[1] - g)) / initalpha;\n        n[2] -= (alpha * (n[2] - r)) / initalpha;\n    }\n\n    /* Search for biased BGR values\n       ---------------------------- */\n    protected int contest(int b, int g, int r) {\n\n        /* finds closest neuron (min dist) and updates freq */\n        /* finds best neuron (min dist-bias) and returns position */\n        /* for frequently chosen neurons, freq[i] is high and bias[i] is negative */\n        /* bias[i] = gamma*((1/netsize)-freq[i]) */\n\n        int i, dist, a, biasdist, betafreq;\n        int bestpos, bestbiaspos, bestd, bestbiasd;\n        int[] n;\n\n        bestd = ~(((int) 1) << 31);\n        bestbiasd = bestd;\n        bestpos = -1;\n        bestbiaspos = bestpos;\n\n        for (i = 0; i < netsize; i++) {\n            n = network[i];\n            dist = n[0] - b;\n            if (dist < 0) dist = -dist;\n            a = n[1] - g;\n            if (a < 0) a = -a;\n            dist += a;\n            a = n[2] - r;\n            if (a < 0) a = -a;\n            dist += a;\n            if (dist < bestd) {\n                bestd = dist;\n                bestpos = i;\n            }\n            biasdist = dist - ((bias[i]) >> (intbiasshift - netbiasshift));\n            if (biasdist < bestbiasd) {\n                bestbiasd = biasdist;\n                bestbiaspos = i;\n            }\n            betafreq = (freq[i] >> betashift);\n            freq[i] -= betafreq;\n            bias[i] += (betafreq << gammashift);\n        }\n        freq[bestpos] += beta;\n        bias[bestpos] -= betagamma;\n        return (bestbiaspos);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/SocialDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 66
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.plugin.SocialPlugin;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * \n *\n * @author yadong.zhang (yadong.zhang0415(a)gmail.com)\n * @version 1.0.0\n * @date 2020/6/25 0:07\n * @since 1.0.0\n */\n@Component\npublic class SocialDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private SocialPlugin socialPlugin;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"socialList\", builder.build().wrap(socialPlugin.getAllAvailableSocialPlatform()));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/NotificationApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 67
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.INotificationService;\nimport co.yiiu.pybbs.util.Result;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport javax.annotation.Resource;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@RestController\n@RequestMapping(\"/api/notification\")\npublic class NotificationApiController extends BaseApiController {\n\n    @Resource\n    private INotificationService notificationService;\n\n    @GetMapping(\"/notRead\")\n    public Result notRead() {\n        User user = getApiUser();\n        return success(notificationService.countNotRead(user.getId()));\n    }\n\n    @GetMapping(\"/markRead\")\n    public Result markRead() {\n        User user = getApiUser();\n        notificationService.markRead(user.getId());\n        return success();\n    }\n\n    // \n    @GetMapping(\"/list\")\n    public Result list() {\n        User user = getApiUser();\n        // \n        List<Map<String, Object>> notReadNotifications = notificationService.selectByUserId(user.getId(), false, 20);\n        // \n        List<Map<String, Object>> readNotifications = notificationService.selectByUserId(user.getId(), true, 20);\n        Map<String, Object> map = new HashMap<>();\n        map.put(\"notRead\", notReadNotifications);\n        map.put(\"read\", readNotifications);\n        return success(map);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/DataSourceHelper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 68
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport co.yiiu.pybbs.util.SpringContextUtil;\nimport org.springframework.context.annotation.Configuration;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.Resource;\nimport java.net.URI;\nimport java.net.URISyntaxException;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.SQLException;\nimport java.sql.Statement;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\npublic class DataSourceHelper {\n\n    @Resource\n    private SiteConfig siteConfig;\n\n    @PostConstruct\n    public void init() {\n        if (siteConfig == null) siteConfig = SpringContextUtil.getBean(SiteConfig.class);\n        try {\n            Class.forName(siteConfig.getDatasource_driver());\n            URI uri = new URI(siteConfig.getDatasource_url().replace(\"jdbc:\", \"\"));\n            String host = uri.getHost();\n            int port = uri.getPort();\n            String path = uri.getPath();\n            String query = uri.getQuery();\n            Connection connection = DriverManager.getConnection(\"jdbc:mysql://\" + host + \":\" + port + \"?\" + query,\n                    siteConfig.getDatasource_username(), siteConfig.getDatasource_password());\n            Statement statement = connection.createStatement();\n            statement.executeUpdate(\"CREATE DATABASE IF NOT EXISTS `\" + path.replace(\"/\", \"\") + \"` DEFAULT CHARACTER SET = \"\n                    + \"\" + \"`utf8` COLLATE `utf8_general_ci`;\");\n            statement.close();\n            connection.close();\n        } catch (URISyntaxException | ClassNotFoundException | SQLException e) {\n            e.printStackTrace();\n            System.exit(0);\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/AdminUserService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 69
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.AdminUserMapper;\nimport co.yiiu.pybbs.model.AdminUser;\nimport co.yiiu.pybbs.service.IAdminUserService;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class AdminUserService implements IAdminUserService {\n\n    @Resource\n    private AdminUserMapper adminUserMapper;\n\n    // \n    @Override\n    public AdminUser selectByUsername(String username) {\n        QueryWrapper<AdminUser> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(AdminUser::getUsername, username);\n        return adminUserMapper.selectOne(wrapper);\n    }\n\n    // \n    @Override\n    public List<Map<String, Object>> selectAll() {\n        return adminUserMapper.selectAll();\n    }\n\n    @Override\n    public void update(AdminUser adminUser) {\n        adminUserMapper.updateById(adminUser);\n    }\n\n    @Override\n    public void insert(AdminUser adminUser) {\n        adminUserMapper.insert(adminUser);\n    }\n\n    @Override\n    public void delete(Integer id) {\n        adminUserMapper.deleteById(id);\n    }\n\n    @Override\n    public AdminUser selectById(Integer id) {\n        return adminUserMapper.selectById(id);\n    }\n\n    // id\n    @Override\n    public List<AdminUser> selectByRoleId(Integer roleId) {\n        QueryWrapper<AdminUser> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(AdminUser::getRoleId, roleId);\n        return adminUserMapper.selectList(wrapper);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicTagService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 70
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.TopicTagMapper;\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.TopicTag;\nimport co.yiiu.pybbs.service.ITopicTagService;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class TopicTagService implements ITopicTagService {\n\n    @Resource\n    private TopicTagMapper topicTagMapper;\n\n    @Override\n    public List<TopicTag> selectByTopicId(Integer topicId) {\n        QueryWrapper<TopicTag> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(TopicTag::getTopicId, topicId);\n        return topicTagMapper.selectList(wrapper);\n    }\n\n    @Override\n    public List<TopicTag> selectByTagId(Integer tagId) {\n        QueryWrapper<TopicTag> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(TopicTag::getTagId, tagId);\n        return topicTagMapper.selectList(wrapper);\n    }\n\n    @Override\n    public void insertTopicTag(Integer topicId, List<Tag> tagList) {\n        // topicId\n        this.deleteByTopicId(topicId);\n        // \n        tagList.forEach(tag -> {\n            TopicTag topicTag = new TopicTag();\n            topicTag.setTopicId(topicId);\n            topicTag.setTagId(tag.getId());\n            topicTagMapper.insert(topicTag);\n        });\n    }\n\n    // \n    @Override\n    public void deleteByTopicId(Integer id) {\n        QueryWrapper<TopicTag> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(TopicTag::getTopicId, id);\n        topicTagMapper.delete(wrapper);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/front/IndexController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 71
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.front;\n\nimport co.yiiu.pybbs.model.Code;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICodeService;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.IUserService;\nimport co.yiiu.pybbs.util.CookieUtil;\nimport org.jsoup.Jsoup;\nimport org.jsoup.safety.Whitelist;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.Assert;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.servlet.i18n.SessionLocaleResolver;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\nimport java.util.Locale;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\npublic class IndexController extends BaseController {\n\n    private Logger log = LoggerFactory.getLogger(IndexController.class);\n\n    @Resource\n    private CookieUtil cookieUtil;\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private IUserService userService;\n    @Resource\n    private ICodeService codeService;\n\n    // \n    @GetMapping({\"/\", \"/index\", \"/index.html\"})\n    public String index(@RequestParam(defaultValue = \"all\") String tab, @RequestParam(defaultValue = \"1\") Integer\n            pageNo, Boolean active, Model model) {\n        model.addAttribute(\"tab\", tab);\n        model.addAttribute(\"active\", active);\n        model.addAttribute(\"pageNo\", pageNo);\n\n        return render(\"index\");\n    }\n\n    @GetMapping(\"/top100\")\n    public String top100() {\n        return render(\"top100\");\n    }\n\n    @GetMapping(\"/settings\")\n    public String settings(HttpSession session, Model model) {\n        // \n        User user = userService.selectById(getUser().getId());\n        model.addAttribute(\"user\", user);\n        return render(\"user/settings\");\n    }\n\n    @GetMapping(\"/tags\")\n    public String tags(@RequestParam(defaultValue = \"1\") Integer pageNo, Model model) {\n        model.addAttribute(\"pageNo\", pageNo);\n        return render(\"tag/tags\");\n    }\n\n    // \n    @GetMapping(\"/login\")\n    public String login() {\n        User user = getUser();\n        if (user != null) return redirect(\"/\");\n        return render(\"login\");\n    }\n\n    // \n    @GetMapping(\"/register\")\n    public String register() {\n        User user = getUser();\n        if (user != null) return redirect(\"/\");\n        return render(\"register\");\n    }\n\n    // \n    @GetMapping(\"/notifications\")\n    public String notifications() {\n        return render(\"notifications\");\n    }\n\n    // \n    @GetMapping(\"/logout\")\n    public String logout(HttpSession session) {\n        User user = getUser();\n        if (user != null) {\n            // redis\n            userService.delRedisUser(user);\n            // session\n            session.removeAttribute(\"_user\");\n            // cookietoken\n            cookieUtil.clearCookie(systemConfigService.selectAllConfig().get(\"cookie_name\").toString());\n        }\n        return redirect(\"/\");\n    }\n\n    @GetMapping(\"/search\")\n    public String search(@RequestParam(defaultValue = \"1\") Integer pageNo, @RequestParam String keyword, Model model) {\n        model.addAttribute(\"pageNo\", pageNo);\n//        model.addAttribute(\"keyword\", SecurityUtil.sanitizeInput(keyword));\n        keyword = Jsoup.clean(keyword, Whitelist.basic());\n        model.addAttribute(\"keyword\", keyword.replace(\"\\\"\", \"\").replace(\"'\", \"\"));\n        return render(\"search\");\n    }\n\n    // \n    @GetMapping(\"changeLanguage\")\n    public String changeLanguage(String lang, HttpSession session, HttpServletRequest request) {\n        String referer = request.getHeader(\"referer\");\n        if (\"zh\".equals(lang)) {\n            session.setAttribute(SessionLocaleResolver.LOCALE_SESSION_ATTRIBUTE_NAME, Locale.SIMPLIFIED_CHINESE);\n        } else if (\"en\".equals(lang)) {\n            session.setAttribute(SessionLocaleResolver.LOCALE_SESSION_ATTRIBUTE_NAME, Locale.US);\n        }\n        return StringUtils.isEmpty(referer) ? redirect(\"/\") : redirect(referer);\n    }\n\n    // \n    @GetMapping(\"/active\")\n    public String active(String email, String code) {\n        Assert.notNull(email, \"\");\n        Assert.notNull(code, \"\");\n        User user = getUser();\n        if (user == null) {\n            user = userService.selectByEmail(email);\n        } else {\n            Assert.isTrue(email.equals(user.getEmail()), \"\");\n        }\n        Assert.notNull(user, \"\");\n        Code code1 = codeService.validateCode(user.getId(), email, null, code);\n        Assert.notNull(code1, \"\");\n        // code\n        code1.setUsed(true);\n        codeService.update(code1);\n        // \n        user.setActive(true);\n        userService.update(user);\n        return redirect(\"/?active=true\");\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/ScoreDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 72
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.IUserService;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class ScoreDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private IUserService userService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        Integer limit = Integer.parseInt(map.get(\"limit\").toString());\n        if (limit > 100) limit = 100;\n        List<User> users = userService.selectTop(limit);\n\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"users\", builder.build().wrap(users));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/LocaleMessageSourceUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 73
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport org.springframework.context.MessageSource;\nimport org.springframework.context.i18n.LocaleContextHolder;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.util.Locale;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n//  https://github.com/zl736732419/spring-boot-i18n/blob/master/src/main/java/com/zheng/utils\n// /LocaleMessageSourceUtil.java\n@Component\npublic class LocaleMessageSourceUtil {\n\n    @Resource\n    private MessageSource messageSource;\n\n    public String getMessage(String code) {\n        return getMessage(code, null);\n    }\n\n    /**\n     * @param code messageskey.\n     * @param args : .\n     * @return\n     */\n    public String getMessage(String code, Object[] args) {\n        return getMessage(code, args, \"\");\n    }\n\n    /**\n     * @param code           messageskey.\n     * @param args           : .\n     * @param defaultMessage : key.\n     * @return\n     */\n    public String getMessage(String code, Object[] args, String defaultMessage) {\n        //request.\n        Locale locale = LocaleContextHolder.getLocale();\n        return messageSource.getMessage(code, args, defaultMessage, locale);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MyWebSocket.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 74
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.websocket;\n\nimport co.yiiu.pybbs.model.vo.UserWithWebSocketVO;\nimport co.yiiu.pybbs.service.INotificationService;\nimport co.yiiu.pybbs.service.impl.NotificationService;\nimport co.yiiu.pybbs.util.Message;\nimport co.yiiu.pybbs.util.SpringContextUtil;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\n\nimport javax.websocket.*;\nimport javax.websocket.server.ServerEndpoint;\nimport java.io.IOException;\nimport java.util.Map;\nimport java.util.concurrent.ConcurrentHashMap;\nimport java.util.concurrent.atomic.AtomicInteger;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@ServerEndpoint(value = \"/websocket\", encoders = MessageEncoder.class, decoders = MessageDecoder.class)\n@Component\npublic class MyWebSocket {\n\n    private final static Logger log = LoggerFactory.getLogger(MyWebSocket.class);\n\n    //\n    private final static AtomicInteger online = new AtomicInteger(0);\n    //\n    public static Map<Session, UserWithWebSocketVO> webSockets = new ConcurrentHashMap<>();\n\n    //\n    @OnOpen\n    public void onOpen(Session session) {\n        online.incrementAndGet();\n        webSockets.put(session, new UserWithWebSocketVO());\n    }\n\n    //\n    @OnClose\n    public void onClose(Session session) {\n        online.decrementAndGet();\n        webSockets.remove(session);\n    }\n\n    //\n    @OnMessage\n    public void onMessage(Message message, Session session) {\n        if (message != null) {\n            switch (message.getType()) {\n                case \"bind\":\n                    bind(message, session);\n                    break;\n                case \"notReadCount\":\n                    fetchNotReadCount(message, session);\n                    break;\n                default:\n                    break;\n            }\n        }\n    }\n\n    // websocket\n    private void bind(Message message, Session session) {\n        try {\n            Integer userId = Integer.parseInt(((Map) (message.getPayload())).get(\"userId\").toString());\n            String username = ((Map) (message.getPayload())).get(\"username\").toString();\n            UserWithWebSocketVO userWithWebSocketVO = webSockets.get(session);\n            userWithWebSocketVO.setUserId(userId);\n            userWithWebSocketVO.setUsername(username);\n            webSockets.put(session, userWithWebSocketVO);\n            session.getBasicRemote().sendObject(new Message(\"bind\", null));\n        } catch (IOException | EncodeException e) {\n            log.error(\"ws, : {}\", e.getMessage());\n        }\n    }\n\n    // \n    private static void fetchNotReadCount(Message message, Session session) {\n        try {\n            INotificationService notificationService = SpringContextUtil.getBean(NotificationService.class);\n            long countNotRead = notificationService.countNotRead(MyWebSocket.webSockets.get(session).getUserId());\n            session.getBasicRemote().sendObject(new Message(\"notification_notread\", countNotRead));\n        } catch (IOException | EncodeException e) {\n            log.error(\"ws, : {}\", e.getMessage());\n        }\n    }\n\n    // idsession\n    private static Session selectSessionByUserId(Integer userId) {\n        return webSockets.entrySet().stream().filter(x -> x.getValue().getUserId().equals(userId)).map(Map.Entry::getKey).findFirst().orElse(null);\n    }\n\n    public static void emit(Integer userId, Message message) {\n        try {\n            Session session = selectSessionByUserId(userId);\n            if (session != null) session.getBasicRemote().sendObject(message);\n        } catch (IOException | EncodeException e) {\n            log.error(\"ws, {}\", e.getMessage());\n        }\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/TopicAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 75
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.exception.ApiAssert;\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.service.IIndexedService;\nimport co.yiiu.pybbs.service.ITagService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.Result;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.jsoup.Jsoup;\nimport org.jsoup.safety.Whitelist;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/topic\")\npublic class TopicAdminController extends BaseAdminController {\n\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ITagService tagService;\n    @Resource\n    private IIndexedService indexedService;\n\n    @RequiresPermissions(\"topic:list\")\n    @GetMapping(\"/list\")\n    public String list(@RequestParam(defaultValue = \"1\") Integer pageNo, String startDate, String endDate, String username, Model model) {\n        if (username != null) username = username.replace(\"\\\"\", \"\").replace(\"'\", \"\");\n        if (StringUtils.isEmpty(startDate)) startDate = null;\n        if (StringUtils.isEmpty(endDate)) endDate = null;\n        if (StringUtils.isEmpty(username)) username = null;\n        MyPage<Map<String, Object>> page = topicService.selectAllForAdmin(pageNo, startDate, endDate, username);\n        model.addAttribute(\"page\", page);\n        model.addAttribute(\"startDate\", startDate);\n        model.addAttribute(\"endDate\", endDate);\n        model.addAttribute(\"username\", username);\n        return \"admin/topic/list\";\n    }\n\n    @RequiresPermissions(\"topic:edit\")\n    @GetMapping(\"/edit\")\n    public String edit(Integer id, Model model) {\n        model.addAttribute(\"topic\", topicService.selectById(id));\n        // \n        List<Tag> tagList = tagService.selectByTopicId(id);\n        String tags = StringUtils.collectionToCommaDelimitedString(tagList.stream().map(Tag::getName).collect(Collectors\n                .toList()));\n        model.addAttribute(\"tags\", tags);\n        return \"admin/topic/edit\";\n    }\n\n    @RequiresPermissions(\"topic:edit\")\n    @PostMapping(\"edit\")\n    @ResponseBody\n    public Result update(Integer id, String title, String content, String tags) {\n        title = Jsoup.clean(title, Whitelist.basic());\n        ApiAssert.notEmpty(title, \"\");\n\n        Topic topic = topicService.selectById(id);\n        topic.setTitle(title);\n        topic.setContent(content);\n        topic.setModifyTime(new Date());\n        topicService.update(topic, tags);\n        return success();\n    }\n\n    @RequiresPermissions(\"topic:good\")\n    @GetMapping(\"/good\")\n    @ResponseBody\n    public Result good(Integer id) {\n        Topic topic = topicService.selectById(id);\n        topic.setGood(!topic.getGood());\n        topicService.update(topic, null);\n        return success();\n    }\n\n    @RequiresPermissions(\"topic:top\")\n    @GetMapping(\"/top\")\n    @ResponseBody\n    public Result top(Integer id) {\n        Topic topic = topicService.selectById(id);\n        topic.setTop(!topic.getTop());\n        topicService.update(topic, null);\n        return success();\n    }\n\n    @RequiresPermissions(\"topic:delete\")\n    @GetMapping(\"/delete\")\n    @ResponseBody\n    public Result delete(Integer id) {\n        Topic topic = topicService.selectById(id);\n        topicService.delete(topic);\n        return success();\n    }\n\n    @RequiresPermissions(\"topic:index\")\n    @GetMapping(\"/index\")\n    @ResponseBody\n    public Result index(Integer id) {\n        Topic topic = topicService.selectById(id);\n        indexedService.indexTopic(String.valueOf(topic.getId()), topic.getTitle(), topic.getContent());\n        return success();\n    }\n\n    @RequiresPermissions(\"topic:index_all\")\n    @GetMapping(\"/index_all\")\n    @ResponseBody\n    public Result index_all() {\n        indexedService.indexAllTopic();\n        return success();\n    }\n\n    @RequiresPermissions(\"topic:delete_index\")\n    @GetMapping(\"/delete_index\")\n    @ResponseBody\n    public Result delete_index(String id) { // ajaxidString\n        indexedService.deleteTopicIndex(id);\n        return success();\n    }\n\n    @RequiresPermissions(\"topic:delete_all_index\")\n    @GetMapping(\"/delete_all_index\")\n    @ResponseBody\n    public Result delete_all_index() {\n        indexedService.batchDeleteIndex();\n        return success();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/PermissionService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 76
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.PermissionMapper;\nimport co.yiiu.pybbs.model.Permission;\nimport co.yiiu.pybbs.model.RolePermission;\nimport co.yiiu.pybbs.service.IPermissionService;\nimport co.yiiu.pybbs.service.IRolePermissionService;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.HashMap;\nimport java.util.LinkedHashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class PermissionService implements IPermissionService {\n\n    private static Map<String, List<Permission>> permissionsByRoleId = new HashMap<>();\n\n    @Resource\n    private PermissionMapper permissionMapper;\n    @Resource\n    private IRolePermissionService rolePermissionService;\n\n    public void clearRolePermissionCache() {\n        permissionsByRoleId.clear();\n    }\n\n    // id, \n    @Override\n    public List<Permission> selectByRoleId(Integer roleId) {\n        if (permissionsByRoleId.get(\"roleId_\" + roleId) != null) return permissionsByRoleId.get(\"roleId_\" + roleId);\n        List<RolePermission> rolePermissions = rolePermissionService.selectByRoleId(roleId);\n        List<Integer> permissionIds = rolePermissions.stream().map(RolePermission::getPermissionId).collect(Collectors.toList());\n        QueryWrapper<Permission> wrapper = new QueryWrapper<>();\n        wrapper.lambda().in(Permission::getId, permissionIds);\n        List<Permission> permissions = permissionMapper.selectList(wrapper);\n        permissionsByRoleId.put(\"roleId_\" + roleId, permissions);\n        return permissions;\n    }\n\n    // \n    @Override\n    public List<Permission> selectByPid(Integer pid) {\n        QueryWrapper<Permission> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Permission::getPid, pid);\n        return permissionMapper.selectList(wrapper);\n    }\n\n    @Override\n    public Map<String, List<Permission>> selectAll() {\n        Map<String, List<Permission>> map = new LinkedHashMap<>();\n        // \n        List<Permission> permissions = this.selectByPid(0);\n        // \n        permissions.forEach(permission -> map.put(permission.getName(), this.selectByPid(permission.getId())));\n        return map;\n    }\n\n    @Override\n    public Permission insert(Permission permission) {\n        this.clearPermissionsCache();\n        permissionMapper.insert(permission);\n        return permission;\n    }\n\n    @Override\n    public Permission update(Permission permission) {\n        this.clearPermissionsCache();\n        permissionMapper.updateById(permission);\n        return permission;\n    }\n\n    @Override\n    public void delete(Integer id) {\n        this.clearPermissionsCache();\n        Permission permission = permissionMapper.selectById(id);\n        // \n        if (permission.getPid() == 0) {\n            List<Permission> permissions = this.selectByPid(permission.getId());\n            permissions.forEach(permission1 -> {\n                // role_permission\n                rolePermissionService.deleteByPermissionId(permission1.getId());\n                // \n                permissionMapper.deleteById(permission1.getId());\n            });\n        } else {\n            // role_permission\n            rolePermissionService.deleteByPermissionId(id);\n        }\n        // \n        permissionMapper.deleteById(id);\n    }\n\n    private void clearPermissionsCache() {\n        permissionsByRoleId = new HashMap<>();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/UserMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 77
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.User;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Mapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Mapper\npublic interface UserMapper extends BaseMapper<User> {\n    int countToday();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/UserApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 78
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.model.OAuthUser;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.*;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.Result;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@RestController\n@RequestMapping(\"/api/user\")\npublic class UserApiController extends BaseApiController {\n\n    @Resource\n    private IUserService userService;\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private ICollectService collectService;\n    @Resource\n    private IOAuthUserService oAuthUserService;\n\n    // \n    @GetMapping(\"/{username}\")\n    public Result profile(@PathVariable String username) {\n        // \n        User user = userService.selectByUsername(username);\n        // oauth\n        List<OAuthUser> oAuthUsers = oAuthUserService.selectByUserId(user.getId());\n        // \n        MyPage<Map<String, Object>> topics = topicService.selectByUserId(user.getId(), 1, 10);\n        // \n        MyPage<Map<String, Object>> comments = commentService.selectByUserId(user.getId(), 1, 10);\n        // \n        Integer collectCount = collectService.countByUserId(user.getId());\n\n        Map<String, Object> map = new HashMap<>();\n        map.put(\"user\", user);\n        map.put(\"oAuthUsers\", oAuthUsers);\n        map.put(\"topics\", topics);\n        map.put(\"comments\", comments);\n        map.put(\"collectCount\", collectCount);\n        return success(map);\n    }\n\n    // \n    @GetMapping(\"/{username}/topics\")\n    public Result topics(@PathVariable String username, @RequestParam(defaultValue = \"1\") Integer pageNo) {\n        // \n        User user = userService.selectByUsername(username);\n        // \n        MyPage<Map<String, Object>> topics = topicService.selectByUserId(user.getId(), pageNo, null);\n        Map<String, Object> map = new HashMap<>();\n        map.put(\"user\", user);\n        map.put(\"topics\", topics);\n        return success(map);\n    }\n\n    // \n    @GetMapping(\"/{username}/comments\")\n    public Result comments(@PathVariable String username, @RequestParam(defaultValue = \"1\") Integer pageNo) {\n        // \n        User user = userService.selectByUsername(username);\n        // \n        MyPage<Map<String, Object>> comments = commentService.selectByUserId(user.getId(), pageNo, null);\n        Map<String, Object> map = new HashMap<>();\n        map.put(\"user\", user);\n        map.put(\"comments\", comments);\n        return success(map);\n    }\n\n    // \n    @GetMapping(\"/{username}/collects\")\n    public Result collects(@PathVariable String username, @RequestParam(defaultValue = \"1\") Integer pageNo) {\n        // \n        User user = userService.selectByUsername(username);\n        // \n        MyPage<Map<String, Object>> collects = collectService.selectByUserId(user.getId(), pageNo, null);\n        Map<String, Object> map = new HashMap<>();\n        map.put(\"user\", user);\n        map.put(\"collects\", collects);\n        return success(map);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/plugin/CommentLayerPlugin.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 79
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.plugin;\n\nimport co.yiiu.pybbs.model.vo.CommentsByTopic;\nimport co.yiiu.pybbs.service.impl.SystemConfigService;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.util.ArrayList;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\n@Aspect\npublic class CommentLayerPlugin {\n\n    @Resource\n    private SystemConfigService systemConfigService;\n\n    @Around(\"co.yiiu.pybbs.hook.CommentServiceHook.selectByTopicId()\")\n    public Object selectByTopicId(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        List<CommentsByTopic> newComments = (List<CommentsByTopic>) proceedingJoinPoint.proceed(proceedingJoinPoint.getArgs());\n        if (systemConfigService.selectAllConfig().get(\"comment_layer\").equals(\"1\")) {\n            // \n            return this.sortByLayer(newComments);\n        }\n        return newComments;\n    }\n\n    // \n    // for\n    private List<CommentsByTopic> sortByLayer(List<CommentsByTopic> comments) {\n        List<CommentsByTopic> newComments = new ArrayList<>();\n        for (CommentsByTopic comment : comments) {\n            if (comment.getCommentId() == null) {\n                newComments.add(comment);\n            } else {\n                int idIndex = -1, commentIdIndex = -1;\n                boolean idIndexFlag = false, commentIdIndexFlag = false;\n                for (int i = newComments.size() - 1; i >= 0; i--) {\n                    if (!idIndexFlag && comment.getCommentId().equals(newComments.get(i).getId())) {\n                        idIndex = i;\n                        idIndexFlag = true;\n                    }\n                    if (!commentIdIndexFlag && comment.getCommentId().equals(newComments.get(i).getCommentId())) {\n                        commentIdIndex = i;\n                        commentIdIndexFlag = true;\n                    }\n                }\n                if (idIndex == -1) {\n                    newComments.add(comment);\n                } else {\n                    int layer = newComments.get(idIndex).getLayer();\n                    comment.setLayer(layer + 1);\n                    int count = 0;\n                    if (commentIdIndex != -1) {\n                        for (CommentsByTopic newComment : newComments) {\n                            if (newComments.get(commentIdIndex).getId().equals(newComment.getCommentId())) count++;\n                        }\n                    }\n                    newComments.add(commentIdIndex == -1 ? idIndex + 1 : commentIdIndex + 1 + count, comment);\n                }\n            }\n        }\n        return newComments;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/BaseApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 80
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.controller.front.BaseController;\nimport co.yiiu.pybbs.exception.ApiAssert;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.IUserService;\nimport co.yiiu.pybbs.util.Result;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.context.request.RequestContextHolder;\nimport org.springframework.web.context.request.ServletRequestAttributes;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport java.util.Objects;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class BaseApiController extends BaseController {\n\n    @Resource\n    private IUserService userService;\n\n    protected Result success() {\n        return success(null);\n    }\n\n    protected Result success(Object detail) {\n        Result result = new Result();\n        result.setCode(200);\n        result.setDescription(\"SUCCESS\");\n        result.setDetail(detail);\n        return result;\n    }\n\n    protected Result error(String description) {\n        Result result = new Result();\n        result.setCode(201);\n        result.setDescription(description);\n        return result;\n    }\n\n    // tokengetApiUsertrue\n    protected User getApiUser() {\n        return getApiUser(true);\n    }\n\n    // requesttokenUserService\n    // required: boolean tokentokentoken\n    protected User getApiUser(boolean required) {\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder\n                .getRequestAttributes())).getRequest();\n        String token = request.getHeader(\"token\");\n        //    String token = request.getParameter(\"token\");\n        if (required) { // token\n            // token\n            ApiAssert.notEmpty(token, \"token\");\n            // token\n            User user = userService.selectByToken(token);\n            ApiAssert.notNull(user, \"tokentoken\");\n            return user;\n        } else { // token\n            // tokennull\n            if (StringUtils.isEmpty(token)) return null;\n            // token\n            return userService.selectByToken(token);\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/IndexAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 81
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.service.ICommentService;\nimport co.yiiu.pybbs.service.ITagService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.service.IUserService;\nimport com.sun.management.OperatingSystemMXBean;\nimport org.apache.shiro.SecurityUtils;\nimport org.apache.shiro.authc.AuthenticationException;\nimport org.apache.shiro.authc.IncorrectCredentialsException;\nimport org.apache.shiro.authc.UnknownAccountException;\nimport org.apache.shiro.authc.UsernamePasswordToken;\nimport org.apache.shiro.authz.annotation.RequiresUser;\nimport org.apache.shiro.subject.Subject;\nimport org.apache.shiro.web.util.WebUtils;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.servlet.mvc.support.RedirectAttributes;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\nimport java.lang.management.ManagementFactory;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\npublic class IndexAdminController extends BaseAdminController {\n\n    private final Logger log = LoggerFactory.getLogger(IndexAdminController.class);\n\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ITagService tagService;\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private IUserService userService;\n\n    @RequiresUser\n    @GetMapping({\"/admin/\", \"/admin/index\"})\n    public String index(Model model) {\n        // \n        model.addAttribute(\"topic_count\", topicService.countToday());\n        // \n        model.addAttribute(\"tag_count\", tagService.countToday());\n        // \n        model.addAttribute(\"comment_count\", commentService.countToday());\n        // \n        model.addAttribute(\"user_count\", userService.countToday());\n\n        // \n        model.addAttribute(\"os_name\", System.getProperty(\"os.name\"));\n\n        // \n        int kb = 1024;\n        OperatingSystemMXBean osmxb = (OperatingSystemMXBean) ManagementFactory.getOperatingSystemMXBean();\n        // \n        long totalMemorySize = osmxb.getTotalPhysicalMemorySize() / kb;\n        //\n        long usedMemory = (osmxb.getTotalPhysicalMemorySize() - osmxb.getFreePhysicalMemorySize()) / kb;\n        // cpu\n        double systemCpuLoad = osmxb.getSystemCpuLoad();\n        // jvm\n        double processCpuLoad = osmxb.getProcessCpuLoad();\n\n        model.addAttribute(\"totalMemorySize\", totalMemorySize);\n        model.addAttribute(\"usedMemory\", usedMemory);\n        model.addAttribute(\"systemCpuLoad\", systemCpuLoad);\n        model.addAttribute(\"processCpuLoad\", processCpuLoad);\n\n        return \"admin/index\";\n    }\n\n    // \n    @GetMapping(\"/adminlogin\")\n    public String adminlogin() {\n        return \"admin/login\";\n    }\n\n    // \n    @PostMapping(\"/admin/login\")\n    public String adminlogin(String username, String password, String code, HttpSession session,\n                             @RequestParam(defaultValue = \"0\") Boolean rememberMe,\n                             HttpServletRequest request, RedirectAttributes redirectAttributes) {\n        String url = WebUtils.getSavedRequest(request) == null ? \"/admin/index\" : WebUtils.getSavedRequest(request).getRequestUrl();\n        String captcha = (String) session.getAttribute(\"_captcha\");\n        if (captcha == null || StringUtils.isEmpty(code) || !captcha.equalsIgnoreCase(code)) {\n            redirectAttributes.addFlashAttribute(\"error\", \"\");\n            redirectAttributes.addFlashAttribute(\"username\", username);\n            url = \"/adminlogin\";\n        } else {\n            try {\n                // \n                Subject subject = SecurityUtils.getSubject();\n                UsernamePasswordToken token = new UsernamePasswordToken(username, password, rememberMe);\n                //\n                subject.login(token);\n            } catch (UnknownAccountException e) {\n                log.error(e.getMessage());\n                redirectAttributes.addFlashAttribute(\"error\", \"\");\n                redirectAttributes.addFlashAttribute(\"username\", username);\n                url = \"/adminlogin\";\n            } catch (IncorrectCredentialsException e) {\n                log.error(e.getMessage());\n                redirectAttributes.addFlashAttribute(\"error\", \"\");\n                redirectAttributes.addFlashAttribute(\"username\", username);\n                url = \"/adminlogin\";\n//            } catch (LockedAccountException e) {\n//                log.error(e.getMessage());\n//                redirectAttributes.addFlashAttribute(\"error\", \"\");\n//                redirectAttributes.addFlashAttribute(\"username\", username);\n//                url = \"/adminlogin\";\n//            } catch (ExcessiveAttemptsException e) {\n//                log.error(e.getMessage());\n//                redirectAttributes.addFlashAttribute(\"error\", \"\");\n//                redirectAttributes.addFlashAttribute(\"username\", username);\n//                url = \"/adminlogin\";\n            } catch (AuthenticationException e) {\n                log.error(e.getMessage());\n                redirectAttributes.addFlashAttribute(\"error\", \"\");\n                redirectAttributes.addFlashAttribute(\"username\", username);\n                url = \"/adminlogin\";\n            }\n        }\n        return redirect(url);\n    }\n\n    @GetMapping(\"/admin/logout\")\n    public String logout() {\n        SecurityUtils.getSubject().logout();\n        return redirect(\"/adminlogin\");\n    }\n\n    @GetMapping(\"/admin/no_auth\")\n    public String noAuth() {\n        return redirect(\"/adminlogin\");\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/front/OAuthController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 82
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.front;\n\nimport co.yiiu.pybbs.model.OAuthUser;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.plugin.SocialPlugin;\nimport co.yiiu.pybbs.service.IOAuthUserService;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.IUserService;\nimport co.yiiu.pybbs.util.CookieUtil;\nimport me.zhyd.oauth.model.AuthCallback;\nimport me.zhyd.oauth.model.AuthResponse;\nimport me.zhyd.oauth.model.AuthUser;\nimport me.zhyd.oauth.request.AuthRequest;\nimport me.zhyd.oauth.utils.AuthStateUtils;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpSession;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/oauth\")\npublic class OAuthController extends BaseController {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private IUserService userService;\n    @Resource\n    private IOAuthUserService oAuthUserService;\n    @Resource\n    private CookieUtil cookieUtil;\n    @Resource\n    private SocialPlugin socialPlugin;\n\n    @GetMapping(\"/redirect/{type}\")\n    public String github(@PathVariable(\"type\") String type, HttpSession session) {\n\n        AuthRequest request = socialPlugin.getRequest(type);\n\n        return redirect(request.authorize(AuthStateUtils.createState()));\n    }\n\n    @GetMapping(\"/{type}/callback\")\n    public String callback(@PathVariable(\"type\") String type, AuthCallback callback, HttpSession session) {\n\n        AuthRequest request = socialPlugin.getRequest(type);\n\n        AuthResponse<AuthUser> response = request.login(callback);\n        if (!response.ok()) {\n            throw new IllegalArgumentException(response.getMsg());\n        }\n        AuthUser authUser = response.getData();\n\n        String username = authUser.getUsername();\n        String githubId = authUser.getUuid();\n\n        // \n        String avatarUrl = authUser.getAvatar();\n        String bio = authUser.getRemark();\n        String email = authUser.getEmail();\n        String blog = authUser.getBlog();\n        String accessToken = authUser.getToken().getAccessToken();\n\n        OAuthUser oAuthUser = oAuthUserService.selectByTypeAndLogin(type.toUpperCase(), authUser.getUsername());\n        User user;\n        if (oAuthUser == null) {\n            if (userService.selectByUsername(username) != null) {\n                username = username + githubId;\n            }\n            // useroauthUser\n            user = userService.addUser(username, null, avatarUrl, email, bio, blog, StringUtils.isEmpty(email));\n            oAuthUserService.addOAuthUser(Integer.parseInt(githubId), type.toUpperCase(), authUser.getUsername(), accessToken, bio, email, user.getId\n                    (), null, null, null);\n        } else {\n            user = userService.selectById(oAuthUser.getUserId());\n            oAuthUser.setEmail(email);\n            oAuthUser.setBio(bio);\n            oAuthUser.setAccessToken(accessToken);\n            oAuthUserService.update(oAuthUser);\n        }\n\n        // session\n        session.setAttribute(\"_user\", user);\n        // tokencookie\n        cookieUtil.setCookie(systemConfigService.selectAllConfig().get(\"cookie_name\").toString(), user.getToken());\n\n        return redirect(\"/\");\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/SiteConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 83
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport org.springframework.boot.context.properties.ConfigurationProperties;\nimport org.springframework.context.annotation.Configuration;\n\nimport java.io.Serializable;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\n@ConfigurationProperties(value = \"site\")\npublic class SiteConfig implements Serializable {\n\n    private static final long serialVersionUID = -7632268193700036274L;\n\n    private String datasource_driver;\n    private String datasource_url;\n    private String datasource_username;\n    private String datasource_password;\n\n    public String getDatasource_driver() {\n        return datasource_driver;\n    }\n\n    public void setDatasource_driver(String datasource_driver) {\n        this.datasource_driver = datasource_driver;\n    }\n\n    public String getDatasource_url() {\n        return datasource_url;\n    }\n\n    public void setDatasource_url(String datasource_url) {\n        this.datasource_url = datasource_url;\n    }\n\n    public String getDatasource_username() {\n        return datasource_username;\n    }\n\n    public void setDatasource_username(String datasource_username) {\n        this.datasource_username = datasource_username;\n    }\n\n    public String getDatasource_password() {\n        return datasource_password;\n    }\n\n    public void setDatasource_password(String datasource_password) {\n        this.datasource_password = datasource_password;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/ServerRunner.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 84
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.boot.CommandLineRunner;\nimport org.springframework.stereotype.Component;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class ServerRunner implements CommandLineRunner {\n\n    private Logger log = LoggerFactory.getLogger(ServerRunner.class);\n\n    @Override\n    public void run(String... args) {\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/plugin/SocialPlugin.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 85
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.plugin;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport me.zhyd.oauth.config.AuthConfig;\nimport me.zhyd.oauth.exception.AuthException;\nimport me.zhyd.oauth.request.*;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.Assert;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.LinkedList;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n\n/**\n * \n *\n * @author yadong.zhang (yadong.zhang0415(a)gmail.com)\n * @version 1.0.0\n * @date 2020/6/25 13:42\n * @since 1.0.0\n */\n@Component\npublic class SocialPlugin {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    /**\n     *  JustAuth config\n     *\n     * @param source \n     * @return {@link AuthConfig}\n     */\n    private AuthConfig getConfig(String source) {\n        Map config = systemConfigService.selectAllConfig();\n        String clientId = (String) config.get(\"oauth_\" + source + \"_client_id\");\n        String clientSecret = (String) config.get(\"oauth_\" + source + \"_client_secret\");\n        String callback = (String) config.get(\"oauth_\" + source + \"_callback_url\");\n\n        Assert.isTrue(!StringUtils.isEmpty(clientId) && !StringUtils.isEmpty(clientSecret) && !StringUtils.isEmpty\n                (callback), source + \"\");\n\n        return AuthConfig.builder()\n                .clientId(clientId)\n                .clientSecret(clientSecret)\n                .redirectUri(callback)\n                .build();\n    }\n\n    /**\n     *  JustAuth Request\n     *\n     * @param source \n     * @return {@link AuthRequest}\n     */\n    public AuthRequest getRequest(String source) {\n        AuthConfig config = this.getConfig(source);\n        AuthRequest authRequest = null;\n        switch (source) {\n            case \"github\":\n                authRequest = new AuthGithubRequest(config);\n                break;\n            case \"gitee\":\n                authRequest = new AuthGiteeRequest(config);\n                break;\n            case \"weibo\":\n                authRequest = new AuthWeiboRequest(config);\n                break;\n            case \"oschina\":\n                authRequest = new AuthOschinaRequest(config);\n                break;\n            case \"wechat\":\n                authRequest = new AuthWeChatOpenRequest(config);\n                break;\n            default:\n                break;\n        }\n        if (null == authRequest) {\n            throw new AuthException(source + \"\");\n        }\n        return authRequest;\n    }\n\n    /**\n     * \n     *\n     * @return {@link List}\n     */\n    public List<String> getAllAvailableSocialPlatform() {\n        List<String> res = new LinkedList<>();\n        Map<String, String> config = systemConfigService.selectAllConfig();\n        Set<Map.Entry<String, String>> entrySet = config.entrySet();\n        for (Map.Entry<String, String> entry : entrySet) {\n            String key = entry.getKey();\n            if (key.startsWith(\"oauth_\")) {\n                String type = key.split(\"_\")[1];\n                if (res.contains(type)) {\n                    continue;\n                }\n                Object value = entry.getValue();\n                if (StringUtils.isEmpty(value)) {\n                    continue;\n                }\n                res.add(type);\n            }\n        }\n        return res;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/WebSocketConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 86
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.websocket;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.socket.config.annotation.EnableWebSocket;\nimport org.springframework.web.socket.server.standard.ServerEndpointExporter;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\n@EnableWebSocket\npublic class WebSocketConfig {\n\n    @Bean\n    public ServerEndpointExporter serverEndpoint() {\n        return new ServerEndpointExporter();\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/SystemConfigAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 87
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.config.service.TelegramBotService;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.Result;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/system\")\npublic class SystemConfigAdminController extends BaseAdminController {\n\n    private Logger log = LoggerFactory.getLogger(SystemConfigAdminController.class);\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private TelegramBotService telegramBotService;\n\n    @RequiresPermissions(\"system:edit\")\n    @GetMapping(\"/edit\")\n    public String edit(Model model) {\n        model.addAttribute(\"systems\", systemConfigService.selectAll());\n        return \"admin/system/edit\";\n    }\n\n    @RequiresPermissions(\"system:edit\")\n    @PostMapping(\"/edit\")\n    @ResponseBody\n    public Result edit(@RequestBody List<Map<String, String>> list) {\n        Map<String, String> flattenedMap = new HashMap<>();\n        list.forEach(map -> flattenedMap.put(map.get(\"name\"), map.get(\"value\")));\n        new Thread(() -> telegramBotService.init().setWebHook(flattenedMap)).start();\n\n        systemConfigService.update(list);\n        return success();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/GifCaptcha.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 88
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\nimport java.awt.*;\nimport java.awt.image.BufferedImage;\nimport java.io.OutputStream;\n\nimport static co.yiiu.pybbs.util.captcha.Randoms.num;\n\n/**\n * <p>Gif</p>\n *\n * @author: wuhongjun\n * @version:1.0\n */\npublic class GifCaptcha extends Captcha {\n    public GifCaptcha() {\n    }\n\n    public GifCaptcha(int width, int height) {\n        this.width = width;\n        this.height = height;\n    }\n\n    public GifCaptcha(int width, int height, int len) {\n        this(width, height);\n        this.len = len;\n    }\n\n    public GifCaptcha(int width, int height, int len, Font font) {\n        this(width, height, len);\n        this.font = font;\n    }\n\n    @Override\n    public void out(OutputStream os) {\n        try {\n            GifEncoder gifEncoder = new GifEncoder();   // gif\n            //\n            gifEncoder.start(os);\n            gifEncoder.setQuality(180);\n            gifEncoder.setDelay(100);\n            gifEncoder.setRepeat(0);\n            BufferedImage frame;\n            char[] rands = alphas();\n            Color fontcolor[] = new Color[len];\n            for (int i = 0; i < len; i++) {\n                fontcolor[i] = new Color(20 + num(110), 20 + num(110), 20 + num(110));\n            }\n            for (int i = 0; i < len; i++) {\n                frame = graphicsImage(fontcolor, rands, i);\n                gifEncoder.addFrame(frame);\n                frame.flush();\n            }\n            gifEncoder.finish();\n        } finally {\n            Streams.close(os);\n        }\n\n    }\n\n    /**\n     * \n     *\n     * @param fontcolor \n     * @param strs      \n     * @param flag      \n     * @return BufferedImage\n     */\n    private BufferedImage graphicsImage(Color[] fontcolor, char[] strs, int flag) {\n        BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);\n        //\n        //Graphics2D g2d=image.createGraphics();\n        Graphics2D g2d = (Graphics2D) image.getGraphics();\n        //\n        g2d.setColor(Color.WHITE);\n        g2d.fillRect(0, 0, width, height);\n        AlphaComposite ac3;\n        int h = height - ((height - font.getSize()) >> 1);\n        int w = width / len;\n        g2d.setFont(font);\n        for (int i = 0; i < len; i++) {\n            ac3 = AlphaComposite.getInstance(AlphaComposite.SRC_OVER, getAlpha(flag, i));\n            g2d.setComposite(ac3);\n            g2d.setColor(fontcolor[i]);\n            g2d.drawOval(num(width), num(height), 5 + num(10), 5 + num(10));\n            g2d.drawString(strs[i] + \"\", (width - (len - i) * w) + (w - font.getSize()) + 1, h - 4);\n        }\n        g2d.dispose();\n        return image;\n    }\n\n    /**\n     * ,01,\n     *\n     * @return float \n     */\n    private float getAlpha(int i, int j) {\n        int num = i + j;\n        float r = (float) 1 / len, s = (len + 1) * r;\n        return num > len ? (num * r - s) : num * r;\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/plugin/FileUploadPlugin.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 89
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.plugin;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.FileUtil;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.multipart.MultipartFile;\n\nimport javax.annotation.Resource;\n\n@Component\n@Aspect\npublic class FileUploadPlugin {\n\n    private final Logger log = LoggerFactory.getLogger(FileUploadPlugin.class);\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private FileUtil fileUtil;\n\n    @Around(\"co.yiiu.pybbs.hook.FileUtilHook.upload()\")\n    public Object upload(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {\n        String cloudStoragePlatform = systemConfigService.selectAllConfig().get(\"cloud_storage_platform\");\n        log.info(\"fileUtilHook.upload: {}\", cloudStoragePlatform);\n        Object[] args = proceedingJoinPoint.getArgs();\n        if (StringUtils.isEmpty(cloudStoragePlatform) || UploadPlatForm.LOCAL.name().equals(cloudStoragePlatform)) {\n            return proceedingJoinPoint.proceed(args);\n        } else if (UploadPlatForm.QINIU.name().equals(cloudStoragePlatform)) {\n            return fileUtil.qiniuUpload((MultipartFile) args[0], (String) args[1], (String) args[2]);\n        } else if (UploadPlatForm.OSS.name().equals(cloudStoragePlatform)) {\n            return fileUtil.ossUpload((MultipartFile) args[0], (String) args[1], (String) args[2]);\n        }\n        return null;\n    }\n\n    enum UploadPlatForm {\n        LOCAL, QINIU, OSS\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ISystemConfigService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 90
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.SystemConfig;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ISystemConfigService {\n    Map<String, String> selectAllConfig();\n\n    // \n    SystemConfig selectByKey(String key);\n\n    Map<String, Object> selectAll();\n\n    // selectAllConfig()\n    void update(List<Map<String, String>> list);\n\n    // key\n    void updateByKey(String key, SystemConfig systemConfig);\n\n    Map<String, String> selectAllConfigWithoutPassword();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/BaseAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 91
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.controller.api.BaseApiController;\nimport co.yiiu.pybbs.model.AdminUser;\nimport co.yiiu.pybbs.service.IAdminUserService;\nimport org.apache.shiro.SecurityUtils;\nimport org.apache.shiro.subject.Subject;\n\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class BaseAdminController extends BaseApiController {\n\n    @Resource\n    private IAdminUserService adminUserService;\n\n    // controllerDateStringDate\n    // StringDate\n    //  @InitBinder\n    //  public void initBinder(ServletRequestDataBinder binder) {\n    //    SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd\");\n    //    binder.registerCustomEditor(Date.class, new CustomDateEditor(sdf, true));\n    //  }\n\n    protected AdminUser getAdminUser() {\n        Subject subject = SecurityUtils.getSubject();\n        String principal = (String) subject.getPrincipal();\n        return adminUserService.selectByUsername(principal);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/front/CommonController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 92
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.front;\n\nimport co.yiiu.pybbs.controller.api.BaseApiController;\nimport co.yiiu.pybbs.util.FileUtil;\nimport co.yiiu.pybbs.util.captcha.Captcha;\nimport co.yiiu.pybbs.util.captcha.GifCaptcha;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\nimport java.io.IOException;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/common\")\npublic class CommonController extends BaseApiController {\n\n    @Resource\n    private FileUtil fileUtil;\n\n    // gif \n    @GetMapping(\"/captcha\")\n    public void captcha(HttpServletResponse response, HttpSession session) throws IOException {\n        Captcha captcha = new GifCaptcha();\n        captcha.out(response.getOutputStream());\n        String text = captcha.text();\n        session.setAttribute(\"_captcha\", text);\n    }\n\n    @GetMapping(\"/show_img\")\n    public String showOssImg(String name) {\n        return \"redirect:\" + fileUtil.generatorOssUrl(name);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/generator/impl/DefaultGenerator.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 93
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.identicon.generator.impl;\n\nimport co.yiiu.pybbs.util.identicon.generator.IBaseGenerator;\nimport com.google.common.base.Preconditions;\nimport com.google.common.math.DoubleMath;\nimport org.springframework.util.StringUtils;\n\nimport java.awt.*;\nimport java.math.RoundingMode;\nimport java.util.Random;\n\n/**\n * Author: Bryant Hang\n * Date: 15/1/10\n * Time: 2:44\n */\npublic class DefaultGenerator implements IBaseGenerator {\n    private String hash;\n    private boolean[][] booleanValueArray;\n    private Random random = new Random();\n\n    @Override\n    public boolean[][] getBooleanValueArray(String hash) {\n        Preconditions.checkArgument(!StringUtils.isEmpty(hash) && hash.length() >= 16, \"illegal argument hash:not null \"\n                + \"and size >= 16\");\n\n        this.hash = hash;\n\n        boolean[][] array = new boolean[6][5];\n\n        //\n        for (int i = 0; i < 6; i++) {\n            for (int j = 0; j < 5; j++) {\n                array[i][j] = false;\n            }\n        }\n\n        for (int i = 0; i < hash.length(); i += 2) {\n            int s = i / 2; //hash0\n\n            boolean v = DoubleMath.roundToInt(Integer.parseInt(hash.charAt(i) + \"\", 16) / 10.0, RoundingMode.HALF_UP) > 0 ?\n                    true : false;\n            if (s % 3 == 0) {\n                array[s / 3][0] = v;\n                array[s / 3][4] = v;\n            } else if (s % 3 == 1) {\n                array[s / 3][1] = v;\n                array[s / 3][3] = v;\n            } else {\n                array[s / 3][2] = v;\n            }\n        }\n\n        this.booleanValueArray = array;\n\n        return this.booleanValueArray;\n    }\n\n    @Override\n    public Color getBackgroundColor() {\n        //        int r = Integer.parseInt(String.valueOf(this.hash.charAt(0)), 16) * 16;\n        //        int g = Integer.parseInt(String.valueOf(this.hash.charAt(1)), 16) * 16;\n        //        int b = Integer.parseInt(String.valueOf(this.hash.charAt(2)), 16) * 16;\n\n        //        return new Color(r, g, b);\n        return new Color(236, 236, 236);\n    }\n\n    @Override\n    public Color getForegroundColor() {\n        //        int r = Integer.parseInt(String.valueOf(hash.charAt(hash.length() - 1)), 16) * 16;\n        //        int g = Integer.parseInt(String.valueOf(hash.charAt(hash.length() - 2)), 16) * 16;\n        //        int b = Integer.parseInt(String.valueOf(hash.charAt(hash.length() - 3)), 16) * 16;\n        //\n        //        return new Color(r, g, b);\n\n        int r = random.nextInt(256);\n        int g = random.nextInt(256);\n        int b = random.nextInt(256);\n        return new Color(r, g, b);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/UserAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 94
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.IUserService;\nimport co.yiiu.pybbs.util.Result;\nimport co.yiiu.pybbs.util.StringUtil;\nimport co.yiiu.pybbs.util.bcrypt.BCryptPasswordEncoder;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/user\")\npublic class UserAdminController extends BaseAdminController {\n\n    @Resource\n    private IUserService userService;\n\n    // \n    @RequiresPermissions(\"user:list\")\n    @GetMapping(\"/list\")\n    public String list(@RequestParam(defaultValue = \"1\") Integer pageNo, String username, Model model) {\n        if (username != null) username = username.replace(\"\\\"\", \"\").replace(\"'\", \"\");\n//        username= SecurityUtil.sanitizeInput(username);\n        IPage<User> iPage = userService.selectAll(pageNo, username);\n        model.addAttribute(\"page\", iPage);\n        model.addAttribute(\"username\", username);\n        return \"admin/user/list\";\n    }\n\n    // \n    @RequiresPermissions(\"user:edit\")\n    @GetMapping(\"/edit\")\n    public String edit(Integer id, Model model) {\n        model.addAttribute(\"user\", userService.selectByIdNoCatch(id));\n        return \"admin/user/edit\";\n    }\n\n    // \n    @RequiresPermissions(\"user:edit\")\n    @PostMapping(\"/edit\")\n    @ResponseBody\n    public Result update(User user) {\n        // \n        if (!StringUtils.isEmpty(user.getPassword())) {\n            user.setPassword(new BCryptPasswordEncoder().encode(user.getPassword()));\n        } else {\n            user.setPassword(null);\n        }\n        // usernullfalse\n        if (user.getEmailNotification() == null) user.setEmailNotification(false);\n        userService.update(user);\n        return success();\n    }\n\n    // \n    @RequiresPermissions(\"user:delete\")\n    @GetMapping(\"/delete\")\n    @ResponseBody\n    public Result delete(Integer id) {\n        userService.deleteUser(id);\n        return success();\n    }\n\n    // token\n    @RequiresPermissions(\"user:refresh_token\")\n    @GetMapping(\"/refreshToken\")\n    @ResponseBody\n    public Result refreshToken(Integer id) {\n        User user = userService.selectByIdNoCatch(id);\n        user.setToken(StringUtil.uuid());\n        userService.update(user);\n        return success(user.getToken());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/WebMvcConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 95
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport co.yiiu.pybbs.interceptor.CommonInterceptor;\nimport co.yiiu.pybbs.interceptor.UserInterceptor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.servlet.LocaleResolver;\nimport org.springframework.web.servlet.config.annotation.CorsRegistry;\nimport org.springframework.web.servlet.config.annotation.InterceptorRegistry;\nimport org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport;\nimport org.springframework.web.servlet.i18n.SessionLocaleResolver;\n\nimport javax.annotation.Resource;\nimport java.util.Locale;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\npublic class WebMvcConfig extends WebMvcConfigurationSupport {\n\n    @Resource\n    private CommonInterceptor commonInterceptor;\n    @Resource\n    private UserInterceptor userInterceptor;\n\n    @Override\n    protected void addCorsMappings(CorsRegistry registry) {\n        super.addCorsMappings(registry);\n        registry.addMapping(\"/api/**\").allowedHeaders(\"*\").allowedMethods(\"*\").allowedOrigins(\"*\").allowCredentials(false);\n    }\n\n    @Override\n    protected void addInterceptors(InterceptorRegistry registry) {\n        // \n        registry.addInterceptor(commonInterceptor).addPathPatterns(\"/**\");\n        // \n        registry.addInterceptor(userInterceptor).addPathPatterns(\"/settings\", \"/settings/*\", \"/topic/create\", \"/topic/edit/*\");\n    }\n\n    @Override\n    protected void addResourceHandlers(ResourceHandlerRegistry registry) {\n        registry.addResourceHandler(\"/static/**\").addResourceLocations(\"classpath:/static/\", \"file:./static/\");\n    }\n\n    // \n    @Bean\n    public LocaleResolver localeResolver() {\n        SessionLocaleResolver sessionLocaleResolver = new SessionLocaleResolver();\n        sessionLocaleResolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);\n        return sessionLocaleResolver;\n    }\n\n    // put delete\n    //  @Bean\n    //  public FormContentFilter formContentFilter() {\n    //    return new FormContentFilter();\n    //  }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyShiroRealm.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 96
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.realm;\n\nimport co.yiiu.pybbs.model.AdminUser;\nimport co.yiiu.pybbs.model.Permission;\nimport co.yiiu.pybbs.model.Role;\nimport co.yiiu.pybbs.service.IAdminUserService;\nimport co.yiiu.pybbs.service.IPermissionService;\nimport co.yiiu.pybbs.service.IRoleService;\nimport org.apache.shiro.authc.*;\nimport org.apache.shiro.authz.AuthorizationInfo;\nimport org.apache.shiro.authz.SimpleAuthorizationInfo;\nimport org.apache.shiro.realm.AuthorizingRealm;\nimport org.apache.shiro.subject.PrincipalCollection;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class MyShiroRealm extends AuthorizingRealm {\n\n    private final Logger log = LoggerFactory.getLogger(MyShiroRealm.class);\n\n    @Resource\n    private IAdminUserService adminUserService;\n    @Resource\n    private IRoleService roleService;\n    @Resource\n    private IPermissionService permissionService;\n\n    // \n    @Override\n    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) {\n        //@RequirePermissionurl\n        SimpleAuthorizationInfo simpleAuthorizationInfo = new SimpleAuthorizationInfo();\n        AdminUser adminUser = adminUserService.selectByUsername(principals.toString());\n        //\n        Role role = roleService.selectById(adminUser.getRoleId());\n        // \n        // AuthorizationInfo\n        simpleAuthorizationInfo.addRole(role.getName());\n        // \n        List<Permission> permissions = permissionService.selectByRoleId(adminUser.getRoleId());\n        // String\n        List<String> permissionValues = permissions.stream().map(Permission::getValue).collect(Collectors.toList());\n        // StringAuthorizationInfo\n        simpleAuthorizationInfo.addStringPermissions(permissionValues);\n        return simpleAuthorizationInfo;\n    }\n\n    // \n    @Override\n    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException {\n        String username = (String) token.getPrincipal();\n        log.info(\"{} ...\", username);\n        AdminUser adminUser = adminUserService.selectByUsername(username);\n        // \n        if (adminUser == null) throw new UnknownAccountException();\n        return new SimpleAuthenticationInfo(username, adminUser.getPassword(), getName());\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/PermissionMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 97
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Permission;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface PermissionMapper extends BaseMapper<Permission> {\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/TagMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 98
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Param;\n\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface TagMapper extends BaseMapper<Tag> {\n\n    MyPage<Map<String, Object>> selectTopicByTagId(MyPage<Map<String, Object>> iPage, @Param(\"tagId\") Integer tagId);\n\n    int countToday();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/exception/ApiAssert.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 99
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.exception;\n\nimport org.springframework.util.Assert;\nimport org.springframework.util.StringUtils;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class ApiAssert extends Assert {\n\n    public static void isNull(Object object, String message) {\n        if (object != null) {\n            throw new ApiException(message);\n        }\n    }\n\n    public static void isNull(Object object, int code, String message) {\n        if (object != null) {\n            throw new ApiException(code, message);\n        }\n    }\n\n    public static void notNull(Object object, String message) {\n        if (object == null) {\n            throw new ApiException(message);\n        }\n    }\n\n    public static void notNull(Object object, int code, String message) {\n        if (object == null) {\n            throw new ApiException(code, message);\n        }\n    }\n\n    public static void isTrue(boolean expression, String message) {\n        if (!expression) {\n            throw new ApiException(message);\n        }\n    }\n\n    public static void isTrue(boolean expression, int code, String message) {\n        if (!expression) {\n            throw new ApiException(code, message);\n        }\n    }\n\n    public static void notTrue(boolean expression, String message) {\n        if (expression) {\n            throw new ApiException(message);\n        }\n    }\n\n    public static void notTrue(boolean expression, int code, String message) {\n        if (expression) {\n            throw new ApiException(code, message);\n        }\n    }\n\n    public static void isEmpty(String txt, String message) {\n        if (!StringUtils.isEmpty(txt)) {\n            throw new ApiException(message);\n        }\n    }\n\n    public static void isEmpty(String txt, int code, String message) {\n        if (!StringUtils.isEmpty(txt)) {\n            throw new ApiException(code, message);\n        }\n    }\n\n    public static void notEmpty(String txt, String message) {\n        if (StringUtils.isEmpty(txt)) {\n            throw new ApiException(message);\n        }\n    }\n\n    public static void notEmpty(String txt, int code, String message) {\n        if (StringUtils.isEmpty(txt)) {\n            throw new ApiException(code, message);\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/front/UserController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 100
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.front;\n\nimport co.yiiu.pybbs.model.OAuthUser;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICollectService;\nimport co.yiiu.pybbs.service.IOAuthUserService;\nimport co.yiiu.pybbs.service.IUserService;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestParam;\n\nimport javax.annotation.Resource;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/user\")\npublic class UserController extends BaseController {\n\n    @Resource\n    private IUserService userService;\n    @Resource\n    private ICollectService collectService;\n    @Resource\n    private IOAuthUserService oAuthUserService;\n\n    @GetMapping(\"/{username}\")\n    public String profile(@PathVariable String username, Model model) {\n        // \n        User user = userService.selectByUsername(username);\n        // oauth\n        List<OAuthUser> oAuthUsers = oAuthUserService.selectByUserId(user.getId());\n        // \n        Integer collectCount = collectService.countByUserId(user.getId());\n\n        // oauthgithubgithublogin\n        List<String> logins = oAuthUsers.stream().filter(oAuthUser -> oAuthUser.getType().equals(\"GITHUB\")).map\n                (OAuthUser::getLogin).collect(Collectors.toList());\n        if (logins.size() > 0) {\n            model.addAttribute(\"githubLogin\", logins.get(0));\n        }\n\n        model.addAttribute(\"user\", user);\n        model.addAttribute(\"username\", username);\n        model.addAttribute(\"oAuthUsers\", oAuthUsers);\n        model.addAttribute(\"collectCount\", collectCount);\n        return render(\"user/profile\");\n    }\n\n    @GetMapping(\"/{username}/topics\")\n    public String topics(@PathVariable String username, @RequestParam(defaultValue = \"1\") Integer pageNo, Model model) {\n        model.addAttribute(\"username\", username);\n        model.addAttribute(\"pageNo\", pageNo);\n        return render(\"user/topics\");\n    }\n\n    @GetMapping(\"/{username}/comments\")\n    public String comments(@PathVariable String username, @RequestParam(defaultValue = \"1\") Integer pageNo, Model model) {\n        model.addAttribute(\"username\", username);\n        model.addAttribute(\"pageNo\", pageNo);\n        return render(\"user/comments\");\n    }\n\n    @GetMapping(\"/{username}/collects\")\n    public String collects(@PathVariable String username, @RequestParam(defaultValue = \"1\") Integer pageNo, Model model) {\n        model.addAttribute(\"username\", username);\n        model.addAttribute(\"pageNo\", pageNo);\n        return render(\"user/collects\");\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CollectService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 101
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.config.service.EmailService;\nimport co.yiiu.pybbs.config.websocket.MyWebSocket;\nimport co.yiiu.pybbs.mapper.CollectMapper;\nimport co.yiiu.pybbs.model.Collect;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.*;\nimport co.yiiu.pybbs.util.Message;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.SensitiveWordUtil;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.context.annotation.Lazy;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class CollectService implements ICollectService {\n\n    @Resource\n    private CollectMapper collectMapper;\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private ITagService tagService;\n    @Resource\n    @Lazy\n    private ITopicService topicService;\n    @Resource\n    private INotificationService notificationService;\n    @Resource\n    private EmailService emailService;\n    @Resource\n    @Lazy\n    private IUserService userService;\n\n    // \n    @Override\n    public List<Collect> selectByTopicId(Integer topicId) {\n        QueryWrapper<Collect> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Collect::getTopicId, topicId);\n        return collectMapper.selectList(wrapper);\n    }\n\n    // \n    @Override\n    public Collect selectByTopicIdAndUserId(Integer topicId, Integer userId) {\n        QueryWrapper<Collect> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Collect::getTopicId, topicId).eq(Collect::getUserId, userId);\n        List<Collect> collects = collectMapper.selectList(wrapper);\n        if (collects.size() > 0) return collects.get(0);\n        return null;\n    }\n\n    // \n    @Override\n    public Collect insert(Integer topicId, User user) {\n        Collect collect = new Collect();\n        collect.setTopicId(topicId);\n        collect.setUserId(user.getId());\n        collect.setInTime(new Date());\n        collectMapper.insert(collect);\n\n        // \n        Topic topic = topicService.selectById(topicId);\n        topic.setCollectCount(topic.getCollectCount() + 1);\n        topicService.update(topic, null);\n        // \n        if (!user.getId().equals(topic.getUserId())) {\n            notificationService.insert(user.getId(), topic.getUserId(), topicId, \"COLLECT\", null);\n            // \n            String emailTitle = \" %s  %s \";\n            // websocket\n            if (systemConfigService.selectAllConfig().get(\"websocket\").toString().equals(\"1\")) {\n                MyWebSocket.emit(topic.getUserId(), new Message(\"notifications\", String.format(emailTitle, topic.getTitle(),\n                        user.getUsername())));\n            }\n            User targetUser = userService.selectById(topic.getUserId());\n            if (!StringUtils.isEmpty(targetUser.getEmail()) && targetUser.getEmailNotification()) {\n                String emailContent = \"<a href='%s/notifications' target='_blank'></a>\";\n                new Thread(() -> emailService.sendEmail(targetUser.getEmail(), String.format(emailTitle, topic.getTitle(),\n                        user.getUsername()), String.format(emailContent, systemConfigService.selectAllConfig().get(\"base_url\")\n                        .toString()))).start();\n            }\n        }\n\n        return collect;\n    }\n\n    // \n    @Override\n    public void delete(Integer topicId, Integer userId) {\n        QueryWrapper<Collect> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Collect::getTopicId, topicId).eq(Collect::getUserId, userId);\n        collectMapper.delete(wrapper);\n        // collectCount-1\n        Topic topic = topicService.selectById(topicId);\n        topic.setCollectCount(topic.getCollectCount() - 1);\n        topicService.update(topic, null);\n    }\n\n    // id\n    @Override\n    public void deleteByTopicId(Integer topicId) {\n        QueryWrapper<Collect> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Collect::getTopicId, topicId);\n        collectMapper.delete(wrapper);\n    }\n\n    // id\n    @Override\n    public void deleteByUserId(Integer userId) {\n        QueryWrapper<Collect> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Collect::getUserId, userId);\n        collectMapper.delete(wrapper);\n    }\n\n    // \n    @Override\n    public int countByUserId(Integer userId) {\n        QueryWrapper<Collect> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Collect::getUserId, userId);\n        return collectMapper.selectCount(wrapper);\n    }\n\n    // \n    @Override\n    public MyPage<Map<String, Object>> selectByUserId(Integer userId, Integer pageNo, Integer pageSize) {\n        MyPage<Map<String, Object>> page = new MyPage<>(pageNo, pageSize == null ? Integer.parseInt(systemConfigService\n                .selectAllConfig().get(\"page_size\").toString()) : pageSize);\n        page = collectMapper.selectByUserId(page, userId);\n        for (Map<String, Object> map : page.getRecords()) {\n            Object content = map.get(\"content\");\n            map.put(\"content\", StringUtils.isEmpty(content) ? null : SensitiveWordUtil.replaceSensitiveWord(content\n                    .toString(), \"*\", SensitiveWordUtil.MinMatchType));\n        }\n        tagService.selectTagsByTopicId(page);\n        return page;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/SystemConfigMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 102
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.SystemConfig;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface SystemConfigMapper extends BaseMapper<SystemConfig> {\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/TopicTag.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 103
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport java.io.Serializable;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class TopicTag implements Serializable {\n    private static final long serialVersionUID = -5028599844989220715L;\n    private Integer tagId;\n    private Integer topicId;\n\n    public static long getSerialVersionUID() {\n        return serialVersionUID;\n    }\n\n    public Integer getTagId() {\n        return tagId;\n    }\n\n    public void setTagId(Integer tagId) {\n        this.tagId = tagId;\n    }\n\n    public Integer getTopicId() {\n        return topicId;\n    }\n\n    public void setTopicId(Integer topicId) {\n        this.topicId = topicId;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/AdminUser.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 104
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class AdminUser implements Serializable {\n\n    private static final long serialVersionUID = 8264158018518861440L;\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private String username;\n    private String password;\n    private Date inTime;\n    private Integer roleId;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public Integer getRoleId() {\n        return roleId;\n    }\n\n    public void setRoleId(Integer roleId) {\n        this.roleId = roleId;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/service/TelegramBotService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 105
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.service;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.JsonUtil;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.context.annotation.Lazy;\nimport org.springframework.http.*;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.LinkedMultiValueMap;\nimport org.springframework.util.MultiValueMap;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.client.RestTemplate;\n\nimport javax.annotation.Resource;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n@Component\n@DependsOn(\"mybatisPlusConfig\")\npublic class TelegramBotService {\n\n    private Logger log = LoggerFactory.getLogger(TelegramBotService.class);\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    @Lazy\n    private RestTemplate restTemplate;\n\n    private String accessToken;\n    private String webhookSecretToken;\n    private String chatId;\n    private String contentStyle;\n\n    private TelegramBotService() {\n    }\n\n    public TelegramBotService init() {\n        if (StringUtils.isEmpty(accessToken)) {\n            accessToken = systemConfigService.selectAllConfig().get(\"tg_access_token\");\n        }\n        if (StringUtils.isEmpty(webhookSecretToken)) {\n            webhookSecretToken = systemConfigService.selectAllConfig().get(\"tg_webhook_secret_token\");\n        }\n        if (StringUtils.isEmpty(chatId)) {\n            chatId = systemConfigService.selectAllConfig().get(\"tg_to_chat_id\");\n        }\n        if (StringUtils.isEmpty(contentStyle)) {\n            contentStyle = systemConfigService.selectAllConfig().get(\"content_style\");\n        }\n        return this;\n    }\n\n    private String getStyle() {\n        if (!StringUtils.isEmpty(contentStyle) && contentStyle.equals(\"RICH\")) return \"HTML\";\n        return \"MarkdownV2\";\n    }\n\n    public Integer sendMessage(String message, boolean btn, Integer reply_to_message_id) {\n        if (StringUtils.isEmpty(accessToken) || StringUtils.isEmpty(chatId)) {\n            log.info(\"Telegram Bot\");\n            return null;\n        }\n\n        HttpHeaders headers = new HttpHeaders();\n        headers.set(\"Content-Type\", \"application/json;charset=utf-8\");\n\n        Map<String, Object> dataMap = new HashMap<>();\n        dataMap.put(\"chat_id\", chatId);\n        dataMap.put(\"text\", message);\n        dataMap.put(\"parse_mode\", getStyle());\n        if (reply_to_message_id != null) {\n            dataMap.put(\"reply_to_message_id\", reply_to_message_id);\n        }\n\n        if (btn) {\n            List<List<Map<String, Object>>> inline_keyboard = new ArrayList<>();\n            List<Map<String, Object>> inline_keyboard2 = new ArrayList<>();\n\n            if (systemConfigService.selectAllConfig().get(\"comment_need_examine\").equals(\"1\")) {\n                Map<String, Object> passBtnMap = new HashMap<>();\n                passBtnMap.put(\"text\", \"\");\n                passBtnMap.put(\"callback_data\", \"pass_btn\");\n                inline_keyboard2.add(passBtnMap);\n            }\n\n            Map<String, Object> delBtnMap = new HashMap<>();\n            delBtnMap.put(\"text\", \"\");\n            delBtnMap.put(\"callback_data\", \"del_btn\");\n            inline_keyboard2.add(delBtnMap);\n\n            inline_keyboard.add(inline_keyboard2);\n\n            Map<String, Object> reply_markup = new HashMap<>();\n            reply_markup.put(\"inline_keyboard\", inline_keyboard);\n            dataMap.put(\"reply_markup\", reply_markup);\n        }\n\n        HttpEntity<String> entity = new HttpEntity<>(JsonUtil.objectToJson(dataMap), headers);\n        ResponseEntity<String> exchange = restTemplate.exchange(\"https://api.telegram.org/bot\" + accessToken + \"/sendMessage\", HttpMethod.POST, entity, String.class);\n        if (exchange.getStatusCodeValue() != 200) {\n            log.error(\"TG: {}\", exchange.getStatusCodeValue());\n        } else {\n            Map map1 = JsonUtil.jsonToObject(exchange.getBody(), Map.class);\n            return (Integer) ((Map) map1.get(\"result\")).get(\"message_id\");\n        }\n        return null;\n    }\n\n    public void setWebHook(Map<String, String> map) {\n        String baseUrl = map.get(\"base_url\");\n        String secretToken = map.get(\"tg_webhook_secret_token\");\n        String token = map.get(\"tg_access_token\");\n        if (!StringUtils.isEmpty(baseUrl) && !StringUtils.isEmpty(secretToken) && !StringUtils.isEmpty(token)) {\n            if (secretToken.equals(\"*******\")) {\n                secretToken = systemConfigService.selectAllConfig().get(\"tg_webhook_secret_token\");\n            }\n            if (token.equals(\"*******\")) {\n                token = systemConfigService.selectAllConfig().get(\"tg_access_token\");\n            }\n            HttpHeaders headers = new HttpHeaders();\n            headers.setContentType(MediaType.MULTIPART_FORM_DATA);\n\n            MultiValueMap<String, String> data = new LinkedMultiValueMap<>();\n            data.add(\"url\", baseUrl + \"/bot/tg/webhook\");\n            data.add(\"secret_token\", secretToken);\n            HttpEntity<MultiValueMap<String, String>> entity = new HttpEntity<>(data, headers);\n\n            ResponseEntity<String> exchange = restTemplate.exchange(\"https://api.telegram.org/bot\" + token + \"/setWebhook\", HttpMethod.POST, entity, String.class);\n            if (exchange.getStatusCodeValue() != 200) {\n                log.info(\"Telegram setWebhookerrorCode: {}\", exchange.getStatusCode());\n            } else {\n                log.info(\"Telegram setWebhook\");\n            }\n        } else {\n            log.info(\"TelegramsetWebhook\");\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/SensitiveWord.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 106
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class SensitiveWord {\n\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private String word;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getWord() {\n        return word;\n    }\n\n    public void setWord(String word) {\n        this.word = word;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/bcrypt/BCryptPasswordEncoder.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 107
      },
      "contents" : {
        "text" : "/*\n * Copyright 2002-2011 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\npackage co.yiiu.pybbs.util.bcrypt;\n\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\n\nimport java.security.SecureRandom;\nimport java.util.regex.Pattern;\n\n/**\n * Implementation of PasswordEncoder that uses the BCrypt strong hashing function. Clients\n * can optionally supply a \"strength\" (a.k.a. log rounds in BCrypt) and a SecureRandom\n * instance. The larger the strength parameter the more work will have to be done\n * (exponentially) to hash the passwords. The default value is 10.\n *\n * @author Dave Syer\n */\npublic class BCryptPasswordEncoder {\n    private Pattern BCRYPT_PATTERN = Pattern.compile(\"\\\\A\\\\$2a?\\\\$\\\\d\\\\d\\\\$[./0-9A-Za-z]{53}\");\n    private final Log logger = LogFactory.getLog(getClass());\n\n    private final int strength;\n\n    private final SecureRandom random;\n\n    public BCryptPasswordEncoder() {\n        this(-1);\n    }\n\n    /**\n     * @param strength the log rounds to use, between 4 and 31\n     */\n    public BCryptPasswordEncoder(int strength) {\n        this(strength, null);\n    }\n\n    /**\n     * @param strength the log rounds to use, between 4 and 31\n     * @param random   the secure random instance to use\n     */\n    public BCryptPasswordEncoder(int strength, SecureRandom random) {\n        if (strength != -1 && (strength < BCrypt.MIN_LOG_ROUNDS || strength > BCrypt.MAX_LOG_ROUNDS)) {\n            throw new IllegalArgumentException(\"Bad strength\");\n        }\n        this.strength = strength;\n        this.random = random;\n    }\n\n    public String encode(CharSequence rawPassword) {\n        String salt;\n        if (strength > 0) {\n            if (random != null) {\n                salt = BCrypt.gensalt(strength, random);\n            } else {\n                salt = BCrypt.gensalt(strength);\n            }\n        } else {\n            salt = BCrypt.gensalt();\n        }\n        return BCrypt.hashpw(rawPassword.toString(), salt);\n    }\n\n    public boolean matches(CharSequence rawPassword, String encodedPassword) {\n        if (encodedPassword == null || encodedPassword.length() == 0) {\n            logger.warn(\"Empty encoded password\");\n            return false;\n        }\n\n        if (!BCRYPT_PATTERN.matcher(encodedPassword).matches()) {\n            logger.warn(\"Encoded password does not look like BCrypt\");\n            return false;\n        }\n\n        return BCrypt.checkpw(rawPassword.toString(), encodedPassword);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Tag.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 108
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Tag implements Serializable {\n    private static final long serialVersionUID = 3257790983905872243L;\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private String name;\n    private String description;\n    private String icon;\n    // \n    private Integer topicCount;\n    private Date inTime;\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getIcon() {\n        return icon;\n    }\n\n    public void setIcon(String icon) {\n        this.icon = icon;\n    }\n\n    public Integer getTopicCount() {\n        return topicCount;\n    }\n\n    public void setTopicCount(Integer topicCount) {\n        this.topicCount = topicCount;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CodeService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 109
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.config.service.EmailService;\nimport co.yiiu.pybbs.config.service.SmsService;\nimport co.yiiu.pybbs.mapper.CodeMapper;\nimport co.yiiu.pybbs.model.Code;\nimport co.yiiu.pybbs.service.ICodeService;\nimport co.yiiu.pybbs.util.DateUtil;\nimport co.yiiu.pybbs.util.StringUtil;\nimport com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.Date;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class CodeService implements ICodeService {\n\n    @Resource\n    private CodeMapper codeMapper;\n    @Resource\n    private EmailService emailService;\n    @Resource\n    private SmsService smsService;\n\n    // codecode\n    private String generateToken() {\n        String _code = StringUtil.randomNumber(6);\n        Code code = this.selectByCode(_code);\n        if (code != null) {\n            return this.generateToken();\n        }\n        return _code;\n    }\n\n    @Override\n    public Code selectByCode(String _code) {\n        QueryWrapper<Code> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Code::getCode, _code);\n        return codeMapper.selectOne(wrapper);\n    }\n\n    // code\n    @Override\n    public Code selectNotUsedCode(Integer userId, String email, String mobile) {\n        QueryWrapper<Code> wrapper = new QueryWrapper<>();\n        LambdaQueryWrapper<Code> lambda = wrapper.lambda();\n        if (email != null) {\n            lambda.eq(Code::getEmail, email);\n            lambda.eq(Code::getUserId, userId);\n        } else if (mobile != null) {\n            lambda.eq(Code::getMobile, mobile);\n        }\n        lambda.eq(Code::getUsed, false);\n        lambda.gt(Code::getExpireTime, new Date());\n        List<Code> codes = codeMapper.selectList(wrapper);\n        if (codes.isEmpty()) return null;\n        return codes.get(0);\n    }\n\n    // \n    @Override\n    public Code createCode(Integer userId, String email, String mobile) {\n        Code code = this.selectNotUsedCode(userId, email, mobile);\n        if (code == null) {\n            code = new Code();\n            String _code = generateToken();\n            code.setUserId(userId);\n            code.setCode(_code);\n            code.setEmail(email);\n            code.setMobile(mobile);\n            code.setInTime(new Date());\n            code.setExpireTime(DateUtil.getMinuteAfter(new Date(), 30));\n            codeMapper.insert(code);\n        }\n        return code;\n    }\n\n    // \n    @Override\n    public Code validateCode(Integer userId, String email, String mobile, String _code) {\n        QueryWrapper<Code> wrapper = new QueryWrapper<>();\n        LambdaQueryWrapper<Code> lambda = wrapper.lambda();\n        if (email != null) {\n            lambda.eq(Code::getEmail, email);\n            lambda.eq(Code::getUserId, userId);\n        } else if (mobile != null) {\n            lambda.eq(Code::getMobile, mobile);\n        }\n        lambda.eq(Code::getCode, _code);\n        lambda.eq(Code::getUsed, false);\n        lambda.gt(Code::getExpireTime, new Date());\n        return codeMapper.selectOne(wrapper);\n    }\n\n    // \n    @Override\n    public boolean sendEmail(Integer userId, String email, String title, String content) {\n        Code code = this.createCode(userId, email, null);\n        return emailService.sendEmail(email, title, content.replace(\"${code}\", code.getCode()));\n    }\n\n    // \n    @Override\n    public boolean sendSms(String mobile) {\n        // code\n        Code code = this.createCode(null, null, mobile);\n        return smsService.sendSms(mobile, code.getCode());\n    }\n\n    @Override\n    public void update(Code code) {\n        codeMapper.updateById(code);\n    }\n\n    // id\n    @Override\n    public void deleteByUserId(Integer userId) {\n        QueryWrapper<Code> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Code::getUserId, userId);\n        codeMapper.delete(wrapper);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ICodeService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 110
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Code;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ICodeService {\n    Code selectByCode(String _code);\n\n    // code\n    Code selectNotUsedCode(Integer userId, String email, String mobile);\n\n    // \n    Code createCode(Integer userId, String email, String mobile);\n\n    // \n    Code validateCode(Integer userId, String email, String mobile, String _code);\n\n    // \n    boolean sendEmail(Integer userId, String email, String title, String content);\n\n    // \n    boolean sendSms(String mobile);\n\n    void update(Code code);\n\n    // id\n    void deleteByUserId(Integer userId);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/RolePermissionMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 111
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.RolePermission;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface RolePermissionMapper extends BaseMapper<RolePermission> {\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/OAuthUserMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 112
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.OAuthUser;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface OAuthUserMapper extends BaseMapper<OAuthUser> {\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/Constants.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 113
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Constants {\n\n    private Constants() {\n    }\n\n    public static final String REDIS_SYSTEM_CONFIG_KEY = \"pybbs_system_config\";\n\n    public static final String REDIS_TOPIC_KEY = \"pybbs_topic_\"; // id\n\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/IOAuthUserService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 114
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.OAuthUser;\n\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface IOAuthUserService {\n    OAuthUser selectByTypeAndLogin(String type, String login);\n\n    List<OAuthUser> selectByUserId(Integer userId);\n\n    void addOAuthUser(Integer oauthId, String type, String login, String accessToken, String bio, String email, Integer\n            userId, String refreshToken, String unionId, String openId);\n\n    void update(OAuthUser oAuthUser);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ISensitiveWordService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 115
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.SensitiveWord;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\n\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ISensitiveWordService {\n    void save(SensitiveWord sensitiveWord);\n\n    void update(SensitiveWord sensitiveWord);\n\n    List<SensitiveWord> selectAll();\n\n    void deleteById(Integer id);\n\n    IPage<SensitiveWord> page(Integer pageNo, String word);\n\n    void updateWordById(Integer id, String word);\n\n    SensitiveWord selectByWord(String word);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/plugin/RedisService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 116
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.plugin;\n\nimport co.yiiu.pybbs.config.service.BaseService;\nimport co.yiiu.pybbs.model.SystemConfig;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\nimport redis.clients.jedis.Jedis;\nimport redis.clients.jedis.JedisPool;\nimport redis.clients.jedis.JedisPoolConfig;\nimport redis.clients.jedis.params.SetParams;\n\nimport javax.annotation.Resource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\n@DependsOn(\"mybatisPlusConfig\")\npublic class RedisService implements BaseService<JedisPool> {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n    private JedisPool jedisPool;\n    private final Logger log = LoggerFactory.getLogger(RedisService.class);\n\n    public void setJedis(JedisPool jedisPool) {\n        this.jedisPool = jedisPool;\n    }\n\n    public JedisPool instance() {\n        try {\n            if (this.jedisPool != null) return this.jedisPool;\n            // redis\n            // host\n            SystemConfig systemConfigHost = systemConfigService.selectByKey(\"redis_host\");\n            String host = systemConfigHost.getValue();\n            // port\n            SystemConfig systemConfigPort = systemConfigService.selectByKey(\"redis_port\");\n            String port = systemConfigPort.getValue();\n            // password\n            SystemConfig systemConfigPassword = systemConfigService.selectByKey(\"redis_password\");\n            String password = systemConfigPassword.getValue();\n            password = StringUtils.isEmpty(password) ? null : password;\n            // database\n            SystemConfig systemConfigDatabase = systemConfigService.selectByKey(\"redis_database\");\n            String database = systemConfigDatabase.getValue();\n            // timeout\n            SystemConfig systemConfigTimeout = systemConfigService.selectByKey(\"redis_timeout\");\n            String timeout = systemConfigTimeout.getValue();\n\n            if (!this.isRedisConfig()) {\n                log.info(\"redis...\");\n                return null;\n            }\n            JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();\n            // jedis 8\n            jedisPoolConfig.setMaxIdle(7);\n            // jedis 8\n            jedisPoolConfig.setMaxTotal(20);\n            //borrow()jedisvalidatetruejedis\n            jedisPoolConfig.setTestOnBorrow(true);\n            //return jedispoolping()\n            jedisPoolConfig.setTestOnReturn(true);\n            jedisPool = new JedisPool(jedisPoolConfig, host, Integer.parseInt(port), Integer.parseInt(timeout), password,\n                    Integer.parseInt(database));\n            log.info(\"redis...\");\n            return this.jedisPool;\n        } catch (Exception e) {\n            log.error(\"redis: {}\", e.getMessage());\n            return null;\n        }\n    }\n\n    // redis\n    public boolean isRedisConfig() {\n        SystemConfig systemConfigHost = systemConfigService.selectByKey(\"redis_host\");\n        String host = systemConfigHost.getValue();\n        // port\n        SystemConfig systemConfigPort = systemConfigService.selectByKey(\"redis_port\");\n        String port = systemConfigPort.getValue();\n        // database\n        SystemConfig systemConfigDatabase = systemConfigService.selectByKey(\"redis_database\");\n        String database = systemConfigDatabase.getValue();\n        // timeout\n        SystemConfig systemConfigTimeout = systemConfigService.selectByKey(\"redis_timeout\");\n        String timeout = systemConfigTimeout.getValue();\n\n        return !StringUtils.isEmpty(host) && !StringUtils.isEmpty(port) && !StringUtils.isEmpty(database) && !StringUtils\n                .isEmpty(timeout);\n    }\n\n    // String\n    public String getString(String key) {\n        JedisPool instance = this.instance();\n        if (StringUtils.isEmpty(key) || instance == null) return null;\n        Jedis jedis = instance.getResource();\n        String value = jedis.get(key);\n        jedis.close();\n        return value;\n    }\n\n    public void setString(String key, String value) {\n        this.setString(key, value, 300); // 5\n    }\n\n    /**\n     * redis\n     *\n     * @param key\n     * @param value\n     * @param expireTime  \n     */\n    public void setString(String key, String value, int expireTime) {\n        JedisPool instance = this.instance();\n        if (StringUtils.isEmpty(key) || StringUtils.isEmpty(value) || instance == null) return;\n        Jedis jedis = instance.getResource();\n        SetParams params = new SetParams();\n        params.px(expireTime * 1000);\n        jedis.set(key, value, params);\n        jedis.close();\n    }\n\n    public void delString(String key) {\n        JedisPool instance = this.instance();\n        if (StringUtils.isEmpty(key) || instance == null) return;\n        Jedis jedis = instance.getResource();\n        jedis.del(key); //  1\n        jedis.close();\n    }\n\n    // TODO  list, map \n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/vo/CommentsByTopic.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 117
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model.vo;\n\nimport co.yiiu.pybbs.model.Comment;\n\nimport java.io.Serializable;\nimport java.util.LinkedHashMap;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class CommentsByTopic extends Comment implements Serializable {\n    private static final long serialVersionUID = 8082073760910701836L;\n    // \n\n    private String username;\n    private String avatar;\n    // layer0layerlayer+1\n    private Integer layer;\n\n    private LinkedHashMap<Integer, List<CommentsByTopic>> children;\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getAvatar() {\n        return avatar;\n    }\n\n    public void setAvatar(String avatar) {\n        this.avatar = avatar;\n    }\n\n    public Integer getLayer() {\n        return layer;\n    }\n\n    public void setLayer(Integer layer) {\n        this.layer = layer;\n    }\n\n    public LinkedHashMap<Integer, List<CommentsByTopic>> getChildren() {\n        return children;\n    }\n\n    public void setChildren(LinkedHashMap<Integer, List<CommentsByTopic>> children) {\n        this.children = children;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/RolePermissionService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 118
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.RolePermissionMapper;\nimport co.yiiu.pybbs.model.RolePermission;\nimport co.yiiu.pybbs.service.IRolePermissionService;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport javax.annotation.Resource;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class RolePermissionService implements IRolePermissionService {\n\n    @Resource\n    private RolePermissionMapper rolePermissionMapper;\n\n    // id\n    @Override\n    public List<RolePermission> selectByRoleId(Integer roleId) {\n        QueryWrapper<RolePermission> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(RolePermission::getRoleId, roleId);\n        return rolePermissionMapper.selectList(wrapper);\n    }\n\n    // id\n    @Override\n    public void deleteByRoleId(Integer roleId) {\n        QueryWrapper<RolePermission> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(RolePermission::getRoleId, roleId);\n        rolePermissionMapper.delete(wrapper);\n    }\n\n    // id\n    @Override\n    public void deleteByPermissionId(Integer permissionId) {\n        QueryWrapper<RolePermission> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(RolePermission::getPermissionId, permissionId);\n        rolePermissionMapper.delete(wrapper);\n    }\n\n    @Override\n    public void insert(RolePermission rolePermission) {\n        rolePermissionMapper.insert(rolePermission);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/CommentAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 119
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.service.ICommentService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.Result;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/comment\")\npublic class CommentAdminController extends BaseAdminController {\n\n    @Resource\n    private ICommentService commentService;\n    @Resource\n    private ITopicService topicService;\n\n    @RequiresPermissions(\"comment:list\")\n    @GetMapping(\"/list\")\n    public String list(@RequestParam(defaultValue = \"1\") Integer pageNo, String startDate, String endDate, String username, Model model) {\n        if (username != null) username = username.replace(\"\\\"\", \"\").replace(\"'\", \"\");\n//        startDate= SecurityUtil.sanitizeInput(startDate);\n//        endDate= SecurityUtil.sanitizeInput(endDate);\n//        username=SecurityUtil.sanitizeInput(username);\n        if (StringUtils.isEmpty(startDate)) startDate = null;\n        if (StringUtils.isEmpty(endDate)) endDate = null;\n        if (StringUtils.isEmpty(username)) username = null;\n        MyPage<Map<String, Object>> page = commentService.selectAllForAdmin(pageNo, startDate, endDate, username);\n        model.addAttribute(\"page\", page);\n        model.addAttribute(\"startDate\", startDate);\n        model.addAttribute(\"endDate\", endDate);\n        model.addAttribute(\"username\", username);\n        return \"admin/comment/list\";\n    }\n\n    @RequiresPermissions(\"comment:edit\")\n    @GetMapping(\"/edit\")\n    public String edit(Integer id, Model model) {\n        Comment comment = commentService.selectById(id);\n        Topic topic = topicService.selectById(comment.getTopicId());\n        model.addAttribute(\"comment\", comment);\n        model.addAttribute(\"topic\", topic);\n        return \"admin/comment/edit\";\n    }\n\n    @RequiresPermissions(\"comment:edit\")\n    @PostMapping(\"/edit\")\n    @ResponseBody\n    public Result update(Integer id, String content) {\n        Comment comment = commentService.selectById(id);\n        comment.setContent(content);\n        commentService.update(comment);\n        return success();\n    }\n\n    @RequiresPermissions(\"comment:examine\")\n    @GetMapping(\"/examine\")\n    @ResponseBody\n    public Result examine(Integer id) {\n        Comment comment = commentService.selectById(id);\n        comment.setStatus(true);\n        commentService.update(comment);\n        return success();\n    }\n\n    @RequiresPermissions(\"comment:delete\")\n    @GetMapping(\"/delete\")\n    @ResponseBody\n    public Result delete(Integer id) {\n        Comment comment = commentService.selectById(id);\n        commentService.delete(comment);\n        return success();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/RolePermission.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 120
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class RolePermission {\n\n    private Integer roleId;\n    private Integer permissionId;\n\n    public Integer getRoleId() {\n        return roleId;\n    }\n\n    public void setRoleId(Integer roleId) {\n        this.roleId = roleId;\n    }\n\n    public Integer getPermissionId() {\n        return permissionId;\n    }\n\n    public void setPermissionId(Integer permissionId) {\n        this.permissionId = permissionId;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/BaseModel.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 121
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport org.jsoup.Jsoup;\nimport org.jsoup.nodes.Document;\nimport org.jsoup.parser.Parser;\nimport org.jsoup.safety.Whitelist;\nimport org.jsoup.select.Elements;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.net.MalformedURLException;\nimport java.net.URL;\nimport java.util.*;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class BaseModel {\n\n    private final Logger log = LoggerFactory.getLogger(BaseModel.class);\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    private static final long MINUTE = 60 * 1000;\n    private static final long HOUR = 60 * MINUTE;\n    private static final long DAY = 24 * HOUR;\n    private static final long WEEK = 7 * DAY;\n    private static final long MONTH = 31 * DAY;\n    private static final long YEAR = 12 * MONTH;\n\n    /**\n     * \n     *\n     * @param date\n     * @return\n     */\n    public String formatDate(Date date) {\n        if (date == null) return \"\";\n\n        long offset = System.currentTimeMillis() - date.getTime();\n        if (offset > YEAR) {\n            return (offset / YEAR) + \"\";\n        } else if (offset > MONTH) {\n            return (offset / MONTH) + \"\";\n        } else if (offset > WEEK) {\n            return (offset / WEEK) + \"\";\n        } else if (offset > DAY) {\n            return (offset / DAY) + \"\";\n        } else if (offset > HOUR) {\n            return (offset / HOUR) + \"\";\n        } else if (offset > MINUTE) {\n            return (offset / MINUTE) + \"\";\n        } else {\n            return \"\";\n        }\n    }\n\n    public String formatContent(String content) {\n        if (StringUtils.isEmpty(content)) return \"\";\n        List<String> atUsers = StringUtil.fetchAtUser(content);\n        if (!atUsers.isEmpty()) {\n            for (String atUser : atUsers) {\n                content = content.replace(atUser, \"[\" + atUser + \"](\" + systemConfigService.selectAllConfig().get(\"base_url\")\n                        .toString() + \"/user/\" + atUser.replace(\"@\", \"\") + \")\");\n            }\n        }\n        content = MarkdownUtil.render(content);\n        // \n        content = Jsoup.clean(content, Whitelist.relaxed().addTags(\"code\", \"pre\", \"video\", \"source\")\n                .addAttributes(\"code\", \"class\")\n                .addAttributes(\"video\", \"class\", \"controls\")\n                .addAttributes(\"source\", \"src\", \"type\")\n        );\n        Document parse = Jsoup.parse(content, \"\", Parser.xmlParser());\n        Elements tableElements = parse.select(\"table\");\n        tableElements.forEach(element -> element.addClass(\"table table-bordered\"));\n        Elements aElements = parse.select(\"p\");\n        if (!aElements.isEmpty()) {\n            aElements.forEach(element -> {\n                try {\n                    String href = element.text();\n                    if (href.contains(\"//www.youtube.com/watch\")) {\n                        URL aUrl = new URL(href);\n                        String query = aUrl.getQuery();\n                        Map<String, Object> querys = StringUtil.formatParams(query);\n                        element.text(\"\");\n                        element.addClass(\"embed-responsive embed-responsive-16by9\");\n                        element.append(\"<iframe class='embedded_video' src='https://www.youtube.com/embed/\" + querys.get(\"v\") +\n                                \"' frameborder='0' allowfullscreen></iframe>\");\n                    } else if (href.contains(\"//v.youku.com/v_show/\")) {\n                        element.text(\"\");\n                        URL aUrl = new URL(href);\n                        String _href = \"https://player.youku.com/embed/\" + aUrl.getPath().replace(\"/v_show/id_\", \"\").replace(\"\" +\n                                \".html\", \"\");\n                        element.addClass(\"embed-responsive embed-responsive-16by9\");\n                        element.append(\"<iframe class='embedded_video' src='\" + _href + \"' frameborder='0' \" +\n                                \"allowfullscreen></iframe>\");\n                    } else if (href.contains(\"//www.bilibili.com/video/\")) {\n                        element.text(\"\");\n                        URL aUrl = new URL(href);\n                        String _href = \"//player.bilibili.com/player.html?aid=\" + aUrl.getPath().replace(\"/video/av\", \"\");\n                        element.addClass(\"embed-responsive embed-responsive-16by9\");\n                        element.append(\"<iframe class='embedded_video' src='\" + _href + \"' frameborder='0' \" +\n                                \"allowfullscreen></iframe>\");\n                    } else if (href.contains(\"//v.qq.com/x/cover/\")) {\n                        element.text(\"\");\n                        URL aUrl = new URL(href);\n                        String _href = \"https://v.qq.com/txp/iframe/player.html?vid=\" + aUrl.getPath().substring(aUrl.getPath().lastIndexOf(\"/\") + 1).replace(\".html\", \"\");\n                        element.addClass(\"embed-responsive embed-responsive-16by9\");\n                        element.append(\"<iframe class='embedded_video' src='\" + _href + \"' frameborder='0' \" +\n                                \"allowfullscreen></iframe>\");\n                    }\n                } catch (MalformedURLException e) {\n                    log.error(e.getMessage());\n                }\n            });\n        }\n        return parse.outerHtml();\n    }\n\n    // id\n    public Set<String> getUpIds(String upIds) {\n        if (StringUtils.isEmpty(upIds)) return new HashSet<>();\n        return StringUtils.commaDelimitedListToSet(upIds);\n    }\n\n    public boolean isEmpty(String txt) {\n        return StringUtils.isEmpty(txt);\n    }\n\n    public long commentSize(List<Comment> comments, User user) {\n        return comments.stream().filter(comment -> comment.getStatus() || (user != null && comment.getUserId().equals(user.getId()) && !comment.getStatus())).count();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/FlywayConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 122
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport org.flywaydb.core.Flyway;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.DependsOn;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.Resource;\nimport javax.sql.DataSource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\npublic class FlywayConfig {\n\n    @Resource\n    private DataSource dataSource;\n\n    @PostConstruct\n    @DependsOn(\"dataSourceHelper\")\n    public void migrate() {\n        Flyway flyway = Flyway.configure().dataSource(dataSource).locations(\"classpath:db/migration\",\n                \"filesystem:db/migration\").baselineOnMigrate(true).load();\n        flyway.migrate();\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/JsonUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 123
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport com.fasterxml.jackson.core.JsonProcessingException;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.type.TypeFactory;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class JsonUtil {\n\n    private final static Logger log = LoggerFactory.getLogger(JsonUtil.class);\n\n    private static ObjectMapper objectMapper = new ObjectMapper();\n\n    public static <T> List<T> jsonToListObject(String json, Class<T> clazz) {\n        try {\n            TypeFactory typeFactory = objectMapper.getTypeFactory();\n            return objectMapper.readValue(json, typeFactory.constructCollectionType(List.class, clazz));\n        } catch (JsonProcessingException e) {\n            log.error(\"json to list error: {}\", e.getMessage());\n            return null;\n        }\n    }\n\n    public static <T> T jsonToObject(String json, Class<T> clazz) {\n        try {\n            return objectMapper.readValue(json, clazz);\n        } catch (JsonProcessingException e) {\n            log.error(\"json to object error: {}\", e.getMessage());\n            return null;\n        }\n    }\n\n    public static String objectToJson(Object obj) {\n        try {\n            return objectMapper.writeValueAsString(obj);\n        } catch (JsonProcessingException e) {\n            log.error(\"object to json string error: {}\", e.getMessage());\n            return null;\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/vo/package-info.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 124
      },
      "contents" : {
        "text" : "/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npackage co.yiiu.pybbs.model.vo;\n\n/**\n * MapjsonMap\n */\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/service/SensitiveWordFilterService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 125
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.service;\n\nimport co.yiiu.pybbs.model.SensitiveWord;\nimport co.yiiu.pybbs.service.ISensitiveWordService;\nimport co.yiiu.pybbs.util.SensitiveWordUtil;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.Resource;\nimport java.util.HashSet;\nimport java.util.List;\nimport java.util.Set;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\n@DependsOn(\"mybatisPlusConfig\")\npublic class SensitiveWordFilterService {\n\n    @Resource\n    private ISensitiveWordService sensitiveWordService;\n\n    // \n    @PostConstruct\n    public void init() {\n        List<SensitiveWord> sensitiveWords = sensitiveWordService.selectAll();\n        Set<String> sensitiveWordSet = new HashSet<>();\n        for (SensitiveWord sensitiveWord : sensitiveWords) {\n            sensitiveWordSet.add(sensitiveWord.getWord());\n        }\n        SensitiveWordUtil.init(sensitiveWordSet);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/NotificationsDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 126
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.service.INotificationService;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class NotificationsDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private INotificationService notificationService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        Integer userId = Integer.parseInt(map.get(\"userId\").toString());\n        Boolean read = Integer.parseInt(map.get(\"read\").toString()) == 1;\n        // limit   -1\n        Integer limit = Integer.parseInt(map.get(\"limit\").toString());\n        List<Map<String, Object>> notifications = notificationService.selectByUserId(userId, read, limit);\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"notifications\", builder.build().wrap(notifications));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/hook/TopicServiceHook.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 127
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.hook;\n\nimport org.aspectj.lang.annotation.Pointcut;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class TopicServiceHook {\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ITopicService.search(..))\")\n    public void search() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ITopicService.selectById(..))\")\n    public void selectById() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ITopicService.update(..))\")\n    public void update() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ITopicService.vote(..))\")\n    public void vote() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ITopicService.updateViewCount(..))\")\n    public void updateViewCount() {\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/exception/GlobalExceptionHandler.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 128
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.exception;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.HttpUtil;\nimport co.yiiu.pybbs.util.JsonUtil;\nimport co.yiiu.pybbs.util.Result;\nimport org.apache.shiro.authz.AuthorizationException;\nimport org.apache.shiro.authz.UnauthenticatedException;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.MediaType;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.ControllerAdvice;\nimport org.springframework.web.bind.annotation.ExceptionHandler;\nimport org.springframework.web.bind.annotation.ResponseBody;\nimport org.springframework.web.servlet.ModelAndView;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\nimport java.util.Optional;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2016, All Rights Reserved.\n * https://atjiu.github.io\n */\n@ControllerAdvice\npublic class GlobalExceptionHandler {\n\n    private Logger log = LoggerFactory.getLogger(GlobalExceptionHandler.class);\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    private HttpStatus getStatus(HttpServletRequest request) {\n        Integer statusCode = (Integer) request.getAttribute(\"javax.servlet.error.status_code\");\n        if (statusCode == null) {\n            return HttpStatus.INTERNAL_SERVER_ERROR;\n        }\n        return HttpStatus.valueOf(statusCode);\n    }\n\n    /**\n     * \n     *\n     * @param request\n     * @param e\n     * @return\n     * @throws Exception\n     */\n    @ExceptionHandler(value = Exception.class)\n    public ModelAndView defaultErrorHandler(HttpServletRequest request, HttpServletResponse response, Exception e) throws Exception {\n        // \n        e.printStackTrace();\n//        log.error(e.getMessage());\n        if (!HttpUtil.isApiRequest(request)) {\n            response.setCharacterEncoding(\"utf-8\");\n            ModelAndView mav = new ModelAndView();\n            mav.addObject(\"exception\", e);\n            mav.addObject(\"errorCode\", getStatus(request));\n            mav.setViewName(\"theme/\" + systemConfigService.selectAllConfig().get(\"theme\").toString() + \"/error\");\n            return mav;\n        } else /*if (accept.contains(\"application/json\"))*/ {\n            Result result = new Result();\n            result.setCode(201);\n            result.setDescription(\"~\");\n            response.setContentType(\"application/json;charset=utf-8\");\n            response.getWriter().write(Optional.ofNullable(JsonUtil.objectToJson(result)).orElse(\"\"));\n        }\n        return null;\n    }\n\n    /**\n     * \n     *\n     * @param e\n     * @return\n     * @throws Exception\n     */\n    @ExceptionHandler(value = ApiException.class)\n    @ResponseBody\n    public Result jsonErrorHandler(ApiException e) {\n        log.info(\"api exception: {}\", e.getMessage());\n        Result result = new Result();\n        result.setCode(e.getCode());\n        result.setDescription(e.getMessage());\n        return result;\n    }\n\n    /**\n     * \n     *\n     * @param e\n     * @return\n     * @throws UnauthenticatedException\n     */\n    @ExceptionHandler(value = UnauthenticatedException.class)\n    @ResponseBody\n    public ResponseEntity<String> jsonErrorHandler(HttpServletRequest request, HttpServletResponse response, UnauthenticatedException e) throws IOException {\n        log.error(e.getMessage());\n        if (HttpUtil.isApiRequest(request)) {\n            return ResponseEntity.status(HttpStatus.UNAUTHORIZED).contentType(MediaType.APPLICATION_JSON).build();\n        } else {\n            response.sendRedirect(\"/adminlogin\");\n            return null;\n        }\n    }\n\n    /**\n     * \n     *\n     * @param e\n     * @return\n     * @throws AuthorizationException\n     */\n    @ExceptionHandler(value = AuthorizationException.class)\n    @ResponseBody\n    public Result jsonErrorHandler(HttpServletRequest request, HttpServletResponse response, AuthorizationException e) throws IOException {\n        log.error(e.getMessage());\n        if (HttpUtil.isApiRequest(request)) {\n            Result result = new Result();\n            result.setCode(201);\n            result.setDescription(\"\");\n            return result;\n        } else {\n            response.sendRedirect(\"/adminlogin\");\n            return null;\n        }\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/websocket/MessageDecoder.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 129
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.websocket;\n\nimport co.yiiu.pybbs.util.Message;\nimport com.alibaba.fastjson.JSON;\n\nimport javax.websocket.Decoder;\nimport javax.websocket.EndpointConfig;\n\npublic class MessageDecoder implements Decoder.Text<Message> {\n    @Override\n    public Message decode(String s) {\n        return JSON.parseObject(s, Message.class);\n    }\n\n    @Override\n    public boolean willDecode(String s) {\n        // jsondecode()\n        return JSON.isValid(s);\n    }\n\n    @Override\n    public void init(EndpointConfig endpointConfig) {\n\n    }\n\n    @Override\n    public void destroy() {\n\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/front/TopicController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 130
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.front;\n\nimport co.yiiu.pybbs.model.Collect;\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICollectService;\nimport co.yiiu.pybbs.service.ITagService;\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.service.IUserService;\nimport co.yiiu.pybbs.util.IpUtil;\nimport co.yiiu.pybbs.util.MyPage;\nimport co.yiiu.pybbs.util.SensitiveWordUtil;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.Assert;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestParam;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/topic\")\npublic class TopicController extends BaseController {\n\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private ITagService tagService;\n    @Resource\n    private IUserService userService;\n    @Resource\n    private ICollectService collectService;\n\n    // \n    @GetMapping(\"/{id}\")\n    public String detail(@PathVariable Integer id, Model model, HttpServletRequest request) {\n        // \n        Topic topic = topicService.selectById(id);\n        Assert.notNull(topic, \"\");\n        // \n        List<Tag> tags = tagService.selectByTopicId(id);\n        // \n        User topicUser = userService.selectById(topic.getUserId());\n        // \n        List<Collect> collects = collectService.selectByTopicId(id);\n        // \n        if (getUser() != null) {\n            Collect collect = collectService.selectByTopicIdAndUserId(id, getUser().getId());\n            model.addAttribute(\"collect\", collect);\n        }\n        // +1\n        String ip = IpUtil.getIpAddr(request);\n        ip = ip.replace(\":\", \"_\").replace(\".\", \"_\");\n        topic = topicService.updateViewCount(topic, ip);\n\n        // \n        topic.setContent(SensitiveWordUtil.replaceSensitiveWord(topic.getContent(), \"*\", SensitiveWordUtil.MinMatchType));\n\n        model.addAttribute(\"topic\", topic);\n        model.addAttribute(\"tags\", tags);\n        model.addAttribute(\"topicUser\", topicUser);\n        model.addAttribute(\"collects\", collects);\n        return render(\"topic/detail\");\n    }\n\n    @GetMapping(\"/create\")\n    public String create(String tag, Model model) {\n        Tag tag1 = tagService.selectByName(tag);\n        if (tag1 != null) model.addAttribute(\"tag\", tag);\n        return render(\"topic/create\");\n    }\n\n    // \n    @GetMapping(\"/edit/{id}\")\n    public String edit(@PathVariable Integer id, Model model) {\n        Topic topic = topicService.selectById(id);\n        Assert.isTrue(topic.getUserId().equals(getUser().getId()), \"\");\n        // \n        List<Tag> tagList = tagService.selectByTopicId(id);\n        // \n        String tags = StringUtils.collectionToCommaDelimitedString(tagList.stream().map(Tag::getName).collect(Collectors\n                .toList()));\n\n        model.addAttribute(\"topic\", topic);\n        model.addAttribute(\"tags\", tags);\n        return render(\"topic/edit\");\n    }\n\n    @GetMapping(\"/tag/{name}\")\n    public String tag(@PathVariable String name, @RequestParam(defaultValue = \"1\") Integer pageNo, Model model) {\n        Tag tag = tagService.selectByName(name);\n        Assert.notNull(tag, \"\");\n        // \n        MyPage<Map<String, Object>> iPage = tagService.selectTopicByTagId(tag.getId(), pageNo);\n        model.addAttribute(\"tag\", tag);\n        model.addAttribute(\"page\", iPage);\n        return render(\"tag/tag\");\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ICollectService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 131
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Collect;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.util.MyPage;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ICollectService {\n    // \n    List<Collect> selectByTopicId(Integer topicId);\n\n    // \n    Collect selectByTopicIdAndUserId(Integer topicId, Integer userId);\n\n    // \n    Collect insert(Integer topicId, User user);\n\n    // \n    void delete(Integer topicId, Integer userId);\n\n    // id\n    void deleteByTopicId(Integer topicId);\n\n    // id\n    void deleteByUserId(Integer userId);\n\n    // \n    int countByUserId(Integer userId);\n\n    // \n    MyPage<Map<String, Object>> selectByUserId(Integer userId, Integer pageNo, Integer pageSize);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/CommentMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 132
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.vo.CommentsByTopic;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Param;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface CommentMapper extends BaseMapper<Comment> {\n\n    List<CommentsByTopic> selectByTopicId(@Param(\"topicId\") Integer topicId);\n\n    MyPage<Map<String, Object>> selectByUserId(MyPage<Map<String, Object>> iPage, @Param(\"userId\") Integer userId);\n\n    MyPage<Map<String, Object>> selectAllForAdmin(MyPage<Map<String, Object>> iPage, @Param(\"startDate\") String\n            startDate, @Param(\"endDate\") String endDate, @Param(\"username\") String username);\n\n    int countToday();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/GifEncoder.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 133
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\nimport java.awt.*;\nimport java.awt.image.BufferedImage;\nimport java.awt.image.DataBufferByte;\nimport java.io.*;\n\n/**\n * Class AnimatedGifEncoder - Encodes a GIF file consisting of one or\n * more frames.\n * <pre>\n * Example:\n *    AnimatedGifEncoder e = new AnimatedGifEncoder();\n *    e.start(outputFileName);\n *    e.setDelay(1000);   // 1 frame per sec\n *    e.addFrame(image1);\n *    e.addFrame(image2);\n *    e.finish();\n * </pre>\n * No copyright asserted on the source code of this class.  May be used\n * for any purpose, however, refer to the Unisys LZW patent for restrictions\n * on use of the associated Encoder class.  Please forward any corrections\n * to questions at fmsware.com.\n *\n * @author wuhongjun\n * @version 1.03 November 2003\n */\npublic class GifEncoder {\n    protected int width; // image size\n    protected int height;\n    protected Color transparent = null; // transparent color if given\n    protected int transIndex; // transparent index in color table\n    protected int repeat = -1; // no repeat\n    protected int delay = 0; // frame delay (hundredths)\n    protected boolean started = false; // ready to output frames\n    protected OutputStream out;\n    protected BufferedImage image; // current frame\n    protected byte[] pixels; // BGR byte array from frame\n    protected byte[] indexedPixels; // converted frame indexed to palette\n    protected int colorDepth; // number of bit planes\n    protected byte[] colorTab; // RGB palette\n    protected boolean[] usedEntry = new boolean[256]; // active palette entries\n    protected int palSize = 7; // color table size (bits-1)\n    protected int dispose = -1; // disposal code (-1 = use default)\n    protected boolean closeStream = false; // close stream when finished\n    protected boolean firstFrame = true;\n    protected boolean sizeSet = false; // if false, get size from first frame\n    protected int sample = 10; // default sample interval for quantizer\n\n    /**\n     * Sets the delay time between each frame, or changes it\n     * for subsequent frames (applies to last frame added).\n     *\n     * @param ms int delay time in milliseconds\n     */\n    public void setDelay(int ms) {\n        delay = Math.round(ms / 10.0f);\n    }\n\n    /**\n     * Sets the GIF frame disposal code for the last added frame\n     * and any subsequent frames.  Default is 0 if no transparent\n     * color has been set, otherwise 2.\n     *\n     * @param code int disposal code.\n     */\n    public void setDispose(int code) {\n        if (code >= 0) {\n            dispose = code;\n        }\n    }\n\n    /**\n     * Sets the number of times the set of GIF frames\n     * should be played.  Default is 1; 0 means play\n     * indefinitely.  Must be invoked before the first\n     * image is added.\n     *\n     * @param iter int number of iterations.\n     * @return\n     */\n    public void setRepeat(int iter) {\n        if (iter >= 0) {\n            repeat = iter;\n        }\n    }\n\n    /**\n     * Sets the transparent color for the last added frame\n     * and any subsequent frames.\n     * Since all colors are subject to modification\n     * in the quantization process, the color in the final\n     * palette for each frame closest to the given color\n     * becomes the transparent color for that frame.\n     * May be set to null to indicate no transparent color.\n     *\n     * @param c Color to be treated as transparent on display.\n     */\n    public void setTransparent(Color c) {\n        transparent = c;\n    }\n\n    /**\n     * Adds next GIF frame.  The frame is not written immediately, but is\n     * actually deferred until the next frame is received so that timing\n     * data can be inserted.  Invoking <code>finish()</code> flushes all\n     * frames.  If <code>setSize</code> was not invoked, the size of the\n     * first image is used for all subsequent frames.\n     *\n     * @param im BufferedImage containing frame to write.\n     * @return true if successful.\n     */\n    public boolean addFrame(BufferedImage im) {\n        if ((im == null) || !started) {\n            return false;\n        }\n        boolean ok = true;\n        try {\n            if (!sizeSet) {\n                // use first frame's size\n                setSize(im.getWidth(), im.getHeight());\n            }\n            image = im;\n            getImagePixels(); // convert to correct format if necessary\n            analyzePixels(); // build color table & map pixels\n            if (firstFrame) {\n                writeLSD(); // logical screen descriptior\n                writePalette(); // global color table\n                if (repeat >= 0) {\n                    // use NS app extension to indicate reps\n                    writeNetscapeExt();\n                }\n            }\n            writeGraphicCtrlExt(); // write graphic control extension\n            writeImageDesc(); // image descriptor\n            if (!firstFrame) {\n                writePalette(); // local color table\n            }\n            writePixels(); // encode and write pixel data\n            firstFrame = false;\n        } catch (IOException e) {\n            ok = false;\n        }\n\n        return ok;\n    }\n\n    //added by alvaro\n    public boolean outFlush() {\n        boolean ok = true;\n        try {\n            out.flush();\n            return ok;\n        } catch (IOException e) {\n            ok = false;\n        }\n\n        return ok;\n    }\n\n    public byte[] getFrameByteArray() {\n        return ((ByteArrayOutputStream) out).toByteArray();\n    }\n\n    /**\n     * Flushes any pending data and closes output file.\n     * If writing to an OutputStream, the stream is not\n     * closed.\n     */\n    public boolean finish() {\n        if (!started) return false;\n        boolean ok = true;\n        started = false;\n        try {\n            out.write(0x3b); // gif trailer\n            out.flush();\n            if (closeStream) {\n                out.close();\n            }\n        } catch (IOException e) {\n            ok = false;\n        }\n\n        return ok;\n    }\n\n    public void reset() {\n        // reset for subsequent use\n        transIndex = 0;\n        out = null;\n        image = null;\n        pixels = null;\n        indexedPixels = null;\n        colorTab = null;\n        closeStream = false;\n        firstFrame = true;\n    }\n\n    /**\n     * Sets frame rate in frames per second.  Equivalent to\n     * <code>setDelay(1000/fps)</code>.\n     *\n     * @param fps float frame rate (frames per second)\n     */\n    public void setFrameRate(float fps) {\n        if (fps != 0f) {\n            delay = Math.round(100f / fps);\n        }\n    }\n\n    /**\n     * Sets quality of color quantization (conversion of images\n     * to the maximum 256 colors allowed by the GIF specification).\n     * Lower values (minimum = 1) produce better colors, but slow\n     * processing significantly.  10 is the default, and produces\n     * good color mapping at reasonable speeds.  Values greater\n     * than 20 do not yield significant improvements in speed.\n     *\n     * @param quality int greater than 0.\n     * @return\n     */\n    public void setQuality(int quality) {\n        if (quality < 1) quality = 1;\n        sample = quality;\n    }\n\n    /**\n     * Sets the GIF frame size.  The default size is the\n     * size of the first frame added if this method is\n     * not invoked.\n     *\n     * @param w int frame width.\n     * @param h int frame width.\n     */\n    public void setSize(int w, int h) {\n        if (started && !firstFrame) return;\n        width = w;\n        height = h;\n        if (width < 1) width = 320;\n        if (height < 1) height = 240;\n        sizeSet = true;\n    }\n\n    /**\n     * Initiates GIF file creation on the given stream.  The stream\n     * is not closed automatically.\n     *\n     * @param os OutputStream on which GIF images are written.\n     * @return false if initial write failed.\n     */\n    public boolean start(OutputStream os) {\n        if (os == null) return false;\n        boolean ok = true;\n        closeStream = false;\n        out = os;\n        try {\n            writeString(\"GIF89a\"); // header\n        } catch (IOException e) {\n            ok = false;\n        }\n        return started = ok;\n    }\n\n    /**\n     * Initiates writing of a GIF file with the specified name.\n     *\n     * @param file String containing output file name.\n     * @return false if open or initial write failed.\n     */\n    public boolean start(String file) {\n        boolean ok = true;\n        try {\n            out = new BufferedOutputStream(new FileOutputStream(file));\n            ok = start(out);\n            closeStream = true;\n        } catch (IOException e) {\n            ok = false;\n        }\n        return started = ok;\n    }\n\n    /**\n     * Analyzes image colors and creates color map.\n     */\n    protected void analyzePixels() {\n        int len = pixels.length;\n        int nPix = len / 3;\n        indexedPixels = new byte[nPix];\n        Quant nq = new Quant(pixels, len, sample);\n        // initialize quantizer\n        colorTab = nq.process(); // create reduced palette\n        // convert map from BGR to RGB\n        for (int i = 0; i < colorTab.length; i += 3) {\n            byte temp = colorTab[i];\n            colorTab[i] = colorTab[i + 2];\n            colorTab[i + 2] = temp;\n            usedEntry[i / 3] = false;\n        }\n        // map image pixels to new palette\n        int k = 0;\n        for (int i = 0; i < nPix; i++) {\n            int index = nq.map(pixels[k++] & 0xff, pixels[k++] & 0xff, pixels[k++] & 0xff);\n            usedEntry[index] = true;\n            indexedPixels[i] = (byte) index;\n        }\n        pixels = null;\n        colorDepth = 8;\n        palSize = 7;\n        // get closest match to transparent color if specified\n        if (transparent != null) {\n            transIndex = findClosest(transparent);\n        }\n    }\n\n    /**\n     * Returns index of palette color closest to c\n     */\n    protected int findClosest(Color c) {\n        if (colorTab == null) return -1;\n        int r = c.getRed();\n        int g = c.getGreen();\n        int b = c.getBlue();\n        int minpos = 0;\n        int dmin = 256 * 256 * 256;\n        int len = colorTab.length;\n        for (int i = 0; i < len; ) {\n            int dr = r - (colorTab[i++] & 0xff);\n            int dg = g - (colorTab[i++] & 0xff);\n            int db = b - (colorTab[i] & 0xff);\n            int d = dr * dr + dg * dg + db * db;\n            int index = i / 3;\n            if (usedEntry[index] && (d < dmin)) {\n                dmin = d;\n                minpos = index;\n            }\n            i++;\n        }\n        return minpos;\n    }\n\n    /**\n     * Extracts image pixels into byte array \"pixels\"\n     */\n    protected void getImagePixels() {\n        int w = image.getWidth();\n        int h = image.getHeight();\n        int type = image.getType();\n        if ((w != width) || (h != height) || (type != BufferedImage.TYPE_3BYTE_BGR)) {\n            // create new image with right size/format\n            BufferedImage temp = new BufferedImage(width, height, BufferedImage.TYPE_3BYTE_BGR);\n            Graphics2D g = temp.createGraphics();\n            g.drawImage(image, 0, 0, null);\n            image = temp;\n        }\n        pixels = ((DataBufferByte) image.getRaster().getDataBuffer()).getData();\n    }\n\n    /**\n     * Writes Graphic Control Extension\n     */\n    protected void writeGraphicCtrlExt() throws IOException {\n        out.write(0x21); // extension introducer\n        out.write(0xf9); // GCE label\n        out.write(4); // data block size\n        int transp, disp;\n        if (transparent == null) {\n            transp = 0;\n            disp = 0; // dispose = no action\n        } else {\n            transp = 1;\n            disp = 2; // force clear if using transparent color\n        }\n        if (dispose >= 0) {\n            disp = dispose & 7; // user override\n        }\n        disp <<= 2;\n\n        // packed fields\n        out.write(0 | // 1:3 reserved\n                disp | // 4:6 disposal\n                0 | // 7   user input - 0 = none\n                transp); // 8   transparency flag\n\n        writeShort(delay); // delay x 1/100 sec\n        out.write(transIndex); // transparent color index\n        out.write(0); // block terminator\n    }\n\n    /**\n     * Writes Image Descriptor\n     */\n    protected void writeImageDesc() throws IOException {\n        out.write(0x2c); // image separator\n        writeShort(0); // image position x,y = 0,0\n        writeShort(0);\n        writeShort(width); // image size\n        writeShort(height);\n        // packed fields\n        if (firstFrame) {\n            // no LCT  - GCT is used for first (or only) frame\n            out.write(0);\n        } else {\n            // specify normal LCT\n            out.write(0x80 | // 1 local color table  1=yes\n                    0 | // 2 interlace - 0=no\n                    0 | // 3 sorted - 0=no\n                    0 | // 4-5 reserved\n                    palSize); // 6-8 size of color table\n        }\n    }\n\n    /**\n     * Writes Logical Screen Descriptor\n     */\n    protected void writeLSD() throws IOException {\n        // logical screen size\n        writeShort(width);\n        writeShort(height);\n        // packed fields\n        out.write((0x80 | // 1   : global color table flag = 1 (gct used)\n                0x70 | // 2-4 : color resolution = 7\n                0x00 | // 5   : gct sort flag = 0\n                palSize)); // 6-8 : gct size\n\n        out.write(0); // background color index\n        out.write(0); // pixel aspect ratio - assume 1:1\n    }\n\n    /**\n     * Writes Netscape application extension to define\n     * repeat count.\n     */\n    protected void writeNetscapeExt() throws IOException {\n        out.write(0x21); // extension introducer\n        out.write(0xff); // app extension label\n        out.write(11); // block size\n        writeString(\"NETSCAPE\" + \"2.0\"); // app id + auth code\n        out.write(3); // sub-block size\n        out.write(1); // loop sub-block id\n        writeShort(repeat); // loop count (extra iterations, 0=repeat forever)\n        out.write(0); // block terminator\n    }\n\n    /**\n     * Writes color table\n     */\n    protected void writePalette() throws IOException {\n        out.write(colorTab, 0, colorTab.length);\n        int n = (3 * 256) - colorTab.length;\n        for (int i = 0; i < n; i++) {\n            out.write(0);\n        }\n    }\n\n    /**\n     * Encodes and writes pixel data\n     */\n    protected void writePixels() throws IOException {\n        Encoder encoder = new Encoder(width, height, indexedPixels, colorDepth);\n        encoder.encode(out);\n    }\n\n    /**\n     * Write 16-bit value to output stream, LSB first\n     */\n    protected void writeShort(int value) throws IOException {\n        out.write(value & 0xff);\n        out.write((value >> 8) & 0xff);\n    }\n\n    /**\n     * Writes string to output stream\n     */\n    protected void writeString(String s) throws IOException {\n        for (int i = 0; i < s.length(); i++) {\n            out.write((byte) s.charAt(i));\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/hook/UserServiceHook.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 134
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.hook;\n\nimport org.aspectj.lang.annotation.Pointcut;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class UserServiceHook {\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IUserService.selectByUsername(..))\")\n    public void selectByUsername() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IUserService.selectByToken(..))\")\n    public void selectByToken() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IUserService.selectById(..))\")\n    public void selectById() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.IUserService.delRedisUser(..))\")\n    public void delRedisUser() {\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ITopicTagService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 135
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.TopicTag;\n\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ITopicTagService {\n    List<TopicTag> selectByTopicId(Integer topicId);\n\n    List<TopicTag> selectByTagId(Integer tagId);\n\n    void insertTopicTag(Integer topicId, List<Tag> tagList);\n\n    // \n    void deleteByTopicId(Integer id);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/DataSourceConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 136
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport co.yiiu.pybbs.util.SpringContextUtil;\nimport com.zaxxer.hikari.HikariConfig;\nimport com.zaxxer.hikari.HikariDataSource;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.DependsOn;\n\nimport javax.annotation.Resource;\nimport javax.sql.DataSource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\npublic class DataSourceConfig {\n\n    @Resource\n    private SiteConfig siteConfig;\n\n    private HikariDataSource dataSource;\n\n    public HikariDataSource instance() {\n        if (siteConfig == null) siteConfig = SpringContextUtil.getBean(SiteConfig.class);\n        if (dataSource != null) return dataSource;\n        HikariConfig config = new HikariConfig();\n        config.setDriverClassName(siteConfig.getDatasource_driver());\n        config.setJdbcUrl(siteConfig.getDatasource_url());\n        config.setUsername(siteConfig.getDatasource_username());\n        config.setPassword(siteConfig.getDatasource_password());\n        config.addDataSourceProperty(\"cachePrepStmts\", true);\n        config.addDataSourceProperty(\"prepStmtCacheSize\", 500);\n        config.addDataSourceProperty(\"prepStmtCacheSqlLimit\", 2048);\n        config.setConnectionTestQuery(\"SELECT 1\");\n        config.setAutoCommit(true);\n        //\n        config.setMinimumIdle(10);\n        //\n        config.setMaximumPoolSize(50);\n        dataSource = new HikariDataSource(config);\n//        HikariDataSource dataSource = new HikariDataSource();\n//        dataSource.setMaximumPoolSize(100);\n//        dataSource.setMinimumIdle(10);\n//        dataSource.setDataSourceClassName(\"oracle.jdbc.pool.OracleDataSource\");\n//\n//        Properties properties = new Properties();\n//        properties.put(\"user\", \"\");\n//        properties.put(\"password\", \"\");\n//        properties.put(\"databaseName\", \"\");\n//        properties.put(\"serverName\", \"192.168.xx.xx\");\n//        properties.put(\"portNumber\", \"1521\");\n//        properties.put(\"driverType\", \"thin\");\n//        dataSource.setDataSourceProperties(properties);\n        return dataSource;\n    }\n\n    @Bean(name = \"dataSource\")\n    @DependsOn(\"dataSourceHelper\")\n    public DataSource dataSource() {\n        return instance();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/RoleAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 137
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.model.AdminUser;\nimport co.yiiu.pybbs.service.IAdminUserService;\nimport co.yiiu.pybbs.service.IPermissionService;\nimport co.yiiu.pybbs.service.IRoleService;\nimport co.yiiu.pybbs.util.Result;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.ResponseBody;\n\nimport javax.annotation.Resource;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/role\")\npublic class RoleAdminController extends BaseAdminController {\n\n    @Resource\n    private IRoleService roleService;\n    @Resource\n    private IPermissionService permissionService;\n    @Resource\n    private IAdminUserService adminUserService;\n\n    @RequiresPermissions(\"role:list\")\n    @GetMapping(\"/list\")\n    public String list(Model model) {\n        model.addAttribute(\"roles\", roleService.selectAll());\n        return \"admin/role/list\";\n    }\n\n    @RequiresPermissions(\"role:add\")\n    @GetMapping(\"/add\")\n    public String add(Model model) {\n        // \n        model.addAttribute(\"permissions\", permissionService.selectAll());\n        return \"admin/role/add\";\n    }\n\n    @RequiresPermissions(\"role:add\")\n    @PostMapping(\"/add\")\n    public String save(String name, Integer[] permissionIds) {\n        roleService.insert(name, permissionIds);\n        return redirect(\"/admin/role/list\");\n    }\n\n    @RequiresPermissions(\"role:edit\")\n    @GetMapping(\"/edit\")\n    public String edit(Integer id, Model model) {\n        model.addAttribute(\"role\", roleService.selectById(id));\n        // \n        model.addAttribute(\"currentPermissions\", permissionService.selectByRoleId(id));\n        // \n        model.addAttribute(\"permissions\", permissionService.selectAll());\n        return \"admin/role/edit\";\n    }\n\n    @RequiresPermissions(\"role:edit\")\n    @PostMapping(\"/edit\")\n    public String update(Integer id, String name, Integer[] permissionIds) {\n        roleService.update(id, name, permissionIds);\n        return redirect(\"/admin/role/list\");\n    }\n\n    @RequiresPermissions(\"role:delete\")\n    @GetMapping(\"/delete\")\n    @ResponseBody\n    public Result delete(Integer id) {\n        // ,\n        // \n        List<AdminUser> adminUsers = adminUserService.selectByRoleId(id);\n        if (adminUsers.size() > 0) {\n            List<String> usernames = adminUsers.stream().map(AdminUser::getUsername).collect(Collectors.toList());\n            String s = StringUtils.collectionToCommaDelimitedString(usernames);\n            return error(\"\" + s + \" \");\n        } else {\n            roleService.delete(id);\n            return success();\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/ICommentService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 138
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Comment;\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.model.vo.CommentsByTopic;\nimport co.yiiu.pybbs.util.MyPage;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface ICommentService {\n    // id\n    List<CommentsByTopic> selectByTopicId(Integer topicId);\n\n    // \n    void deleteByTopicId(Integer topicId);\n\n    // id\n    void deleteByUserId(Integer userId);\n\n    // \n    Comment insert(Comment comment, Topic topic, User user);\n\n    Comment selectById(Integer id);\n\n    Comment selectByTgMessageId(Integer messageId);\n\n    // \n    void update(Comment comment);\n\n    // \n    int vote(Comment comment, User user);\n\n    // \n    void delete(Comment comment);\n\n    // \n    MyPage<Map<String, Object>> selectByUserId(Integer userId, Integer pageNo, Integer pageSize);\n\n    MyPage<Map<String, Object>> selectAllForAdmin(Integer pageNo, String startDate, String endDate, String username);\n\n    // \n    int countToday();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/service/EmailService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 139
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.service;\n\nimport co.yiiu.pybbs.model.SystemConfig;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport javax.mail.*;\nimport javax.mail.internet.InternetAddress;\nimport javax.mail.internet.MimeMessage;\nimport java.util.Properties;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n// https://www.cnblogs.com/whgk/p/6506027.html\n@Component\n@DependsOn(\"mybatisPlusConfig\")\npublic class EmailService implements BaseService<Session> {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    private Session session;\n    private final Logger log = LoggerFactory.getLogger(EmailService.class);\n\n    @Override\n    public Session instance() {\n        // session\n        if (session != null) return session;\n        // session\n        SystemConfig systemConfigHost = systemConfigService.selectByKey(\"mail_host\");\n        String host = systemConfigHost.getValue();\n        SystemConfig systemConfigUsername = systemConfigService.selectByKey(\"mail_username\");\n        String username = systemConfigUsername.getValue();\n        SystemConfig systemConfigPassword = systemConfigService.selectByKey(\"mail_password\");\n        String password = systemConfigPassword.getValue();\n        if (StringUtils.isEmpty(host) || StringUtils.isEmpty(username) || StringUtils.isEmpty(password)) return null;\n        Properties properties = new Properties();\n        properties.setProperty(\"mail.host\", host);\n        //\n        properties.setProperty(\"mail.smtp.auth\", \"true\");\n        //0.2\n        Authenticator authenticator = new Authenticator() {\n            @Override\n            protected PasswordAuthentication getPasswordAuthentication() {\n                return new PasswordAuthentication(username, password);\n            }\n        };\n        //1 \n    /*\n      propsProperties\n              ()\n      authenticator()\n      \n     */\n        this.session = Session.getDefaultInstance(properties, authenticator);\n        return this.session;\n    }\n\n    public boolean sendEmail(String email, String title, String content) {\n        // session\n        if (this.instance() == null) return false;\n        try {\n            //2 \n            Message message = new MimeMessage(this.session);\n            String from = systemConfigService.selectAllConfig().get(\"mail_username\").toString();\n            // 2.1  xxx@163.com \n            message.setFrom(new InternetAddress(from));\n      /*\n        2.2 \n          \n            RecipientType.TO    \n            RecipientType.CC    \n            RecipientType.BCC    \n          ABACB\n          CCBAC\n          ()CBAC\n          \n            Address[]\n            qq\n       */\n            message.setRecipient(Message.RecipientType.TO, new InternetAddress(email));\n            // 2.3 \n            message.setSubject(title + \" - \" + systemConfigService.selectAllConfig().get(\"name\").toString());\n            // 2.4 \n            //\n            message.setContent(content, \"text/html;charset=UTF-8\");\n            //3\n            Transport.send(message);\n            return true;\n        } catch (MessagingException e) {\n            log.error(e.getMessage());\n            return false;\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TagService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 140
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.TagMapper;\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.model.TopicTag;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.ITagService;\nimport co.yiiu.pybbs.service.ITopicTagService;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\nimport com.google.common.collect.Lists;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class TagService implements ITagService {\n\n    @Resource\n    private TagMapper tagMapper;\n    @Resource\n    private ITopicTagService topicTagService;\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    @Override\n    public void selectTagsByTopicId(MyPage<Map<String, Object>> page) {\n        page.getRecords().forEach(map -> {\n            List<TopicTag> topicTags = topicTagService.selectByTopicId((Integer) map.get(\"id\"));\n            if (!topicTags.isEmpty()) {\n                List<Integer> tagIds = topicTags.stream().map(TopicTag::getTagId).collect(Collectors.toList());\n                List<Tag> tags = this.selectByIds(tagIds);\n                map.put(\"tags\", tags);\n            }\n        });\n    }\n\n    @Override\n    public Tag selectById(Integer id) {\n        return tagMapper.selectById(id);\n    }\n\n    @Override\n    public Tag selectByName(String name) {\n        QueryWrapper<Tag> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(Tag::getName, name);\n        return tagMapper.selectOne(wrapper);\n    }\n\n    @Override\n    public List<Tag> selectByIds(List<Integer> ids) {\n        QueryWrapper<Tag> wrapper = new QueryWrapper<>();\n        wrapper.lambda().in(Tag::getId, ids);\n        return tagMapper.selectList(wrapper);\n    }\n\n    // \n    @Override\n    public List<Tag> selectByTopicId(Integer topicId) {\n        List<TopicTag> topicTags = topicTagService.selectByTopicId(topicId);\n        if (!topicTags.isEmpty()) {\n            List<Integer> tagIds = topicTags.stream().map(TopicTag::getTagId).collect(Collectors.toList());\n            QueryWrapper<Tag> wrapper = new QueryWrapper<>();\n            wrapper.lambda().in(Tag::getId, tagIds);\n            return tagMapper.selectList(wrapper);\n        }\n        return Lists.newArrayList();\n    }\n\n    // tag\n    @Override\n    public List<Tag> insertTag(String newTags) {\n        // \n        String[] _tags = StringUtils.commaDelimitedListToStringArray(newTags);\n        List<Tag> tagList = new ArrayList<>();\n        for (String _tag : _tags) {\n            Tag tag = this.selectByName(_tag);\n            if (tag == null) {\n                tag = new Tag();\n                tag.setName(_tag);\n                tag.setTopicCount(1);\n                tag.setInTime(new Date());\n                tagMapper.insert(tag);\n            } else {\n                tag.setTopicCount(tag.getTopicCount() + 1);\n                tagMapper.updateById(tag);\n            }\n            tagList.add(tag);\n        }\n        return tagList;\n    }\n\n    // -1\n    @Override\n    public void reduceTopicCount(Integer id) {\n        List<Tag> tags = this.selectByTopicId(id);\n        tags.forEach(tag -> {\n            tag.setTopicCount(tag.getTopicCount() - 1);\n            tagMapper.updateById(tag);\n        });\n    }\n\n    // \n    @Override\n    public MyPage<Map<String, Object>> selectTopicByTagId(Integer tagId, Integer pageNo) {\n        MyPage<Map<String, Object>> iPage = new MyPage<>(pageNo, Integer.parseInt(systemConfigService.selectAllConfig()\n                .get(\"page_size\").toString()));\n        return tagMapper.selectTopicByTagId(iPage, tagId);\n    }\n\n    // \n    @Override\n    public IPage<Tag> selectAll(Integer pageNo, Integer pageSize, String name) {\n        IPage<Tag> iPage = new MyPage<>(pageNo, pageSize == null ? Integer.parseInt(systemConfigService.selectAllConfig()\n                .get(\"page_size\").toString()) : pageSize);\n        QueryWrapper<Tag> wrapper = new QueryWrapper<>();\n        // namenullname\n        if (!StringUtils.isEmpty(name)) {\n            wrapper.lambda().eq(Tag::getName, name);\n        }\n        wrapper.orderByDesc(\"topic_count\");\n        return tagMapper.selectPage(iPage, wrapper);\n    }\n\n    @Override\n    public void update(Tag tag) {\n        tagMapper.updateById(tag);\n    }\n\n    //  topic_tag \n    @Override\n    public void delete(Integer id) {\n        tagMapper.deleteById(id);\n    }\n\n    // ---------------------------- admin ----------------------------\n\n\n    //\n    @Override\n    public void async() {\n        List<Tag> tags = tagMapper.selectList(null);\n        tags.forEach(tag -> {\n            List<TopicTag> topicTags = topicTagService.selectByTagId(tag.getId());\n            tag.setTopicCount(topicTags.size());\n            this.update(tag);\n        });\n    }\n\n    // \n    @Override\n    public int countToday() {\n        return tagMapper.countToday();\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/IPermissionService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 141
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.Permission;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface IPermissionService {\n\n    // \n    void clearRolePermissionCache();\n\n    // id\n    List<Permission> selectByRoleId(Integer roleId);\n\n    // \n    List<Permission> selectByPid(Integer pid);\n\n    Map<String, List<Permission>> selectAll();\n\n    Permission insert(Permission permission);\n\n    Permission update(Permission permission);\n\n    void delete(Integer id);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/TagsDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 142
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.model.Tag;\nimport co.yiiu.pybbs.service.ITagService;\nimport com.baomidou.mybatisplus.core.metadata.IPage;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class TagsDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ITagService tagService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        Integer pageNo = Integer.parseInt(map.get(\"pageNo\").toString());\n        Integer pageSize = Integer.parseInt(map.get(\"pageSize\").toString());\n        IPage<Tag> page = tagService.selectAll(pageNo, pageSize, null);\n\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"page\", builder.build().wrap(page));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/MybatisPlusConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 143
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport com.baomidou.mybatisplus.core.MybatisConfiguration;\nimport com.baomidou.mybatisplus.core.MybatisXMLLanguageDriver;\nimport com.baomidou.mybatisplus.extension.MybatisMapWrapperFactory;\nimport com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor;\nimport com.baomidou.mybatisplus.extension.plugins.pagination.optimize.JsqlParserCountOptimize;\nimport com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean;\nimport org.apache.ibatis.plugin.Interceptor;\nimport org.apache.ibatis.session.SqlSessionFactory;\nimport org.apache.ibatis.type.JdbcType;\nimport org.mybatis.spring.annotation.MapperScan;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.DependsOn;\n\nimport javax.sql.DataSource;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\n@MapperScan(\"co.yiiu.pybbs.mapper\")\npublic class MybatisPlusConfig {\n\n    // \n    //  @Bean\n    //  public PaginationInterceptor paginationInterceptor() {\n    //    return new PaginationInterceptor();\n    //  }\n\n    @Bean(\"mybatisSqlSession\")\n    @DependsOn(\"flywayConfig\")\n    public SqlSessionFactory sqlSessionFactory(@Qualifier(\"dataSource\") DataSource dataSource) throws Exception {\n        MybatisSqlSessionFactoryBean sqlSessionFactory = new MybatisSqlSessionFactoryBean();\n        MybatisConfiguration configuration = new MybatisConfiguration();\n        configuration.setDefaultScriptingLanguage(MybatisXMLLanguageDriver.class);\n        configuration.setJdbcTypeForNull(JdbcType.NULL);\n        //*Map *\n        configuration.setObjectWrapperFactory(new MybatisMapWrapperFactory());\n\n        // \n        sqlSessionFactory.setDataSource(dataSource);\n\n        sqlSessionFactory.setConfiguration(configuration);\n\n        // \n        // Map \n        // MybatisSqlSessionFactoryBeanMybatisConfiguration\n        //  Interceptor\n        // MybatisSqlSessionFactoryBeanplugins Interceptor\n        // \n        // \n        PaginationInterceptor paginationInterceptor = new PaginationInterceptor();\n        paginationInterceptor.setSqlParser(new JsqlParserCountOptimize());\n        sqlSessionFactory.setPlugins(new Interceptor[]{paginationInterceptor});\n\n        return sqlSessionFactory.getObject();\n    }\n\n  /*\n  \n\n  @Resource\n  private MybatisPlusProperties mybatisPlusProperties;\n\n  @Bean\n  public PaginationInterceptor paginationInterceptor() {\n    return new PaginationInterceptor();\n  }\n\n  @PostConstruct\n  public void mybatisConfigration() {\n    MybatisConfiguration configuration = mybatisPlusProperties.getConfiguration();\n    // \n    configuration.setObjectWrapperFactory(new MybatisMapWrapperFactory());\n  }\n  */\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/UserTopicsDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 144
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ITopicService;\nimport co.yiiu.pybbs.service.IUserService;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class UserTopicsDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ITopicService topicService;\n    @Resource\n    private IUserService userService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        String username = String.valueOf(map.get(\"username\"));\n        Integer pageNo = Integer.parseInt(map.get(\"pageNo\").toString());\n        Integer pageSize = map.get(\"pageSize\") == null ? null : Integer.parseInt(map.get(\"pageSize\").toString());\n        User user = userService.selectByUsername(username);\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"topics\", builder.build().wrap(topicService.selectByUserId(user.getId(), pageNo,\n                pageSize)));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/front/BaseController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 145
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.front;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport org.springframework.web.context.request.RequestContextHolder;\nimport org.springframework.web.context.request.ServletRequestAttributes;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\nimport java.util.Objects;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class BaseController {\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    protected String redirect(String path) {\n        return \"redirect:\" + path;\n    }\n\n    protected User getUser() {\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder\n                .getRequestAttributes())).getRequest();\n        HttpSession session = request.getSession();\n        return (User) session.getAttribute(\"_user\");\n    }\n\n    // \n    protected String render(String path) {\n        return String.format(\"theme/%s/%s\", systemConfigService.selectAllConfig().get(\"theme\").toString(), path);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/admin/SensitiveWordAdminController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 146
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.admin;\n\nimport co.yiiu.pybbs.model.SensitiveWord;\nimport co.yiiu.pybbs.service.ISensitiveWordService;\nimport co.yiiu.pybbs.util.Result;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.*;\nimport org.springframework.web.multipart.MultipartFile;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Controller\n@RequestMapping(\"/admin/sensitive_word\")\npublic class SensitiveWordAdminController extends BaseAdminController {\n\n    private final Logger log = LoggerFactory.getLogger(SensitiveWordAdminController.class);\n\n    @Autowired\n    @Resource\n    private ISensitiveWordService sensitiveWordService;\n\n    @RequiresPermissions(\"sensitive_word:list\")\n    @GetMapping(\"/list\")\n    public String list(@RequestParam(defaultValue = \"1\") Integer pageNo, String word, Model model) {\n//        word= SecurityUtil.sanitizeInput(word);\n        model.addAttribute(\"page\", sensitiveWordService.page(pageNo, word));\n        model.addAttribute(\"word\", word);\n        return \"admin/sensitive_word/list\";\n    }\n\n    @RequiresPermissions(\"sensitive_word:add\")\n    @PostMapping(\"/add\")\n    @ResponseBody\n    public Result add(String word) {\n        SensitiveWord sensitiveWord = new SensitiveWord();\n        sensitiveWord.setWord(word);\n        sensitiveWordService.save(sensitiveWord);\n        return success();\n    }\n\n    @RequiresPermissions(\"sensitive_word:edit\")\n    @PostMapping(\"/edit\")\n    @ResponseBody\n    public Result edit(Integer id, String word) {\n        sensitiveWordService.updateWordById(id, word);\n        return success();\n    }\n\n    @RequiresPermissions(\"sensitive_word:delete\")\n    @GetMapping(\"/delete\")\n    @ResponseBody\n    public Result delete(Integer id) {\n        sensitiveWordService.deleteById(id);\n        return success();\n    }\n\n    @RequiresPermissions(\"sensitive_word:import\")\n    @PostMapping(\"import\")\n    @ResponseBody\n    public Result _import(@RequestParam(\"file\") MultipartFile file) {\n        try {\n            HSSFWorkbook workbook = new HSSFWorkbook(file.getInputStream());\n            HSSFSheet worksheet = workbook.getSheetAt(0);\n            int i = 0;\n            while (i <= worksheet.getLastRowNum()) {\n                HSSFRow row = worksheet.getRow(i++);\n                String word = row.getCell(0).getStringCellValue();\n                SensitiveWord sensitiveWord = sensitiveWordService.selectByWord(word);\n                if (sensitiveWord == null) {\n                    sensitiveWord = new SensitiveWord();\n                    sensitiveWord.setWord(word);\n                    sensitiveWordService.save(sensitiveWord);\n                }\n            }\n            return success();\n        } catch (IOException e) {\n            //      e.printStackTrace();\n            log.error(e.getMessage());\n            return error(e.getMessage());\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/SystemConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 147
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class SystemConfig implements Serializable {\n\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n\n    // \n    @TableField(\"`key`\")\n    private String key;\n    // \n    @TableField(\"`value`\")\n    private String value;\n    // \n    private String description;\n    private Integer pid;\n\n    //  select, input[type=text,url,number,radio,password,email]\n    @TableField(\"`type`\")\n    private String type;\n\n    //  radioselect option\n    @TableField(\"`option`\")\n    private String option;\n\n    // \n    @TableField(\"`reboot`\")\n    private String reboot;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public Integer getPid() {\n        return pid;\n    }\n\n    public void setPid(Integer pid) {\n        this.pid = pid;\n    }\n\n    public String getKey() {\n        return key;\n    }\n\n    public void setKey(String key) {\n        this.key = key;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getType() {\n        return type;\n    }\n\n    public void setType(String type) {\n        this.type = type;\n    }\n\n    public String getOption() {\n        return option;\n    }\n\n    public void setOption(String option) {\n        this.option = option;\n    }\n\n    public String getReboot() {\n        return reboot;\n    }\n\n    public void setReboot(String reboot) {\n        this.reboot = reboot;\n    }\n\n    @Override\n    public String toString() {\n        return \"SystemConfig{\" + \"id=\" + id + \", key='\" + key + '\\'' + \", value='\" + value + '\\'' + \", description='\" +\n                description + '\\'' + \", pid=\" + pid + \", type='\" + type + '\\'' + \", option='\" + option + '\\'' + \", reboot='\"\n                + reboot + '\\'' + '}';\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/ShiroTag.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 148
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport org.apache.shiro.SecurityUtils;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class ShiroTag {\n\n    // \n    public boolean isAuthenticated() {\n        return SecurityUtils.getSubject().isAuthenticated();\n    }\n\n    // \n    public String getPrincipal() {\n        return (String) SecurityUtils.getSubject().getPrincipal();\n    }\n\n    //  xx \n    public boolean hasRole(String name) {\n        return SecurityUtils.getSubject().hasRole(name);\n    }\n\n    //  xx \n    public boolean hasPermission(String name) {\n        return !StringUtils.isEmpty(name) && SecurityUtils.getSubject().isPermitted(name);\n    }\n\n    //  xx \n    public boolean hasPermissionOr(String... name) {\n        boolean[] permitted = SecurityUtils.getSubject().isPermitted(name);\n        for (boolean b : permitted) {\n            // \n            if (b) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    //  xx \n    public boolean hasPermissionAnd(String... name) {\n        boolean[] permitted = SecurityUtils.getSubject().isPermitted(name);\n        for (boolean b : permitted) {\n            // \n            if (!b) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    //  xx \n    public boolean hasAllPermission(String... name) {\n        return SecurityUtils.getSubject().isPermittedAll(name);\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Code.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 149
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Code implements Serializable {\n\n    private static final long serialVersionUID = -6008460350253418202L;\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    // \n    private Integer userId;\n    // \n    private String code;\n    private Date inTime;\n    // \n    private Date expireTime;\n    // \n    private String email;\n    // \n    private String mobile;\n    // \n    private Boolean used;\n\n    public Integer getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Integer userId) {\n        this.userId = userId;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getCode() {\n        return code;\n    }\n\n    public void setCode(String code) {\n        this.code = code;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public Date getExpireTime() {\n        return expireTime;\n    }\n\n    public void setExpireTime(Date expireTime) {\n        this.expireTime = expireTime;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public String getMobile() {\n        return mobile;\n    }\n\n    public void setMobile(String mobile) {\n        this.mobile = mobile;\n    }\n\n    public Boolean getUsed() {\n        return used;\n    }\n\n    public void setUsed(Boolean used) {\n        this.used = used;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/service/SmsService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 150
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.service;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.util.JsonUtil;\nimport com.aliyuncs.CommonRequest;\nimport com.aliyuncs.CommonResponse;\nimport com.aliyuncs.DefaultAcsClient;\nimport com.aliyuncs.IAcsClient;\nimport com.aliyuncs.exceptions.ClientException;\nimport com.aliyuncs.http.MethodType;\nimport com.aliyuncs.profile.DefaultProfile;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.Map;\n\n@Component\n@DependsOn(\"mybatisPlusConfig\")\npublic class SmsService {\n\n    private Logger log = LoggerFactory.getLogger(SmsService.class);\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    private IAcsClient client;\n    private String signName;\n    private String templateCode;\n    private String regionId;\n\n    private SmsService() {\n    }\n\n    public IAcsClient instance() {\n        if (client != null) return client;\n        String accessKeyId = (String) systemConfigService.selectAllConfig().get(\"sms_access_key_id\");\n        String secret = (String) systemConfigService.selectAllConfig().get(\"sms_secret\");\n        signName = (String) systemConfigService.selectAllConfig().get(\"sms_sign_name\");\n        templateCode = (String) systemConfigService.selectAllConfig().get(\"sms_template_code\");\n        regionId = (String) systemConfigService.selectAllConfig().get(\"sms_region_id\");\n        if (StringUtils.isEmpty(accessKeyId) || StringUtils.isEmpty(secret) || StringUtils.isEmpty(signName) ||\n                StringUtils.isEmpty(templateCode) || StringUtils.isEmpty(regionId)) {\n            return null;\n        }\n        DefaultProfile profile = DefaultProfile.getProfile(regionId, accessKeyId, secret);\n        IAcsClient client = new DefaultAcsClient(profile);\n        this.client = client;\n        return client;\n    }\n\n    // \n    public boolean sendSms(String mobile, String code) {\n        try {\n            if (StringUtils.isEmpty(mobile)) return false;\n            // \n            if (this.instance() == null) return false;\n            // \n            CommonRequest request = new CommonRequest();\n            //request.setProtocol(ProtocolType.HTTPS);\n            request.setMethod(MethodType.POST);\n            request.setDomain(\"dysmsapi.aliyuncs.com\");\n            request.setVersion(\"2017-05-25\");\n            request.setAction(\"SendSms\");\n            request.putQueryParameter(\"RegionId\", regionId);\n            request.putQueryParameter(\"PhoneNumbers\", mobile);\n            request.putQueryParameter(\"SignName\", signName);\n            request.putQueryParameter(\"TemplateCode\", templateCode);\n            request.putQueryParameter(\"TemplateParam\", String.format(\"{\\\"code\\\": \\\"%s\\\"}\", code));\n            CommonResponse response = client.getCommonResponse(request);\n            //{\"Message\":\"OK\",\"RequestId\":\"93E35E66-B2B2-4D7A-8AC9-2BDD97F5FB18\",\"BizId\":\"689615750980282428^0\",\"Code\":\"OK\"}\n            Map responseMap = JsonUtil.jsonToObject(response.getData(), Map.class);\n            if (responseMap.get(\"Code\").equals(\"OK\")) return true;\n        } catch (ClientException e) {\n            log.error(e.getMessage());\n        }\n        return false;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/impl/SystemConfigService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 151
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service.impl;\n\nimport co.yiiu.pybbs.mapper.SystemConfigMapper;\nimport co.yiiu.pybbs.model.SystemConfig;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport org.springframework.util.StringUtils;\n\nimport javax.annotation.Resource;\nimport java.util.LinkedHashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.stream.Collectors;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Service\n@Transactional\npublic class SystemConfigService implements ISystemConfigService {\n\n    @Resource\n    private SystemConfigMapper systemConfigMapper;\n\n    private static Map<String, String> SYSTEM_CONFIG;\n    private static Map<String, String> SYSTEM_CONFIG_WITHOUT_PASSWORD;\n\n    @Override\n    public Map<String, String> selectAllConfig() {\n        if (SYSTEM_CONFIG != null) {\n            return SYSTEM_CONFIG;\n        }\n        List<SystemConfig> systemConfigs = systemConfigMapper.selectList(null);\n        SYSTEM_CONFIG = systemConfigs.stream()\n                .filter(systemConfig -> systemConfig.getPid() != 0)\n                .collect(Collectors.toMap(SystemConfig::getKey, SystemConfig::getValue));\n        return SYSTEM_CONFIG;\n    }\n\n    // \n    @Override\n    public SystemConfig selectByKey(String key) {\n        QueryWrapper<SystemConfig> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(SystemConfig::getKey, key);\n        return systemConfigMapper.selectOne(wrapper);\n    }\n\n    @Override\n    public Map<String, Object> selectAll() {\n        Map<String, Object> map = new LinkedHashMap<>();\n        List<SystemConfig> systemConfigs = systemConfigMapper.selectList(null);\n        // \n        List<SystemConfig> p = systemConfigs.stream().filter(systemConfig -> systemConfig.getPid() == 0).collect\n                (Collectors.toList());\n        // \n        p.forEach(systemConfig -> {\n            List<SystemConfig> collect = systemConfigs.stream()\n                    .filter(systemConfig1 -> systemConfig1.getPid().equals(systemConfig.getId()))\n                    .collect(Collectors.toList());\n            map.put(systemConfig.getDescription(), collect);\n        });\n        return map;\n    }\n\n    // selectAllConfig()\n    @Override\n    public void update(List<Map<String, String>> list) {\n        for (Map<String, String> map : list) {\n            String key = map.get(\"name\");\n            String value = map.get(\"value\");\n            // \n            String type = this.selectByKey(key).getType();\n            if (!StringUtils.isEmpty(type) && type.equals(\"password\") && value.equals(\"*******\")) {\n                continue;\n            }\n            SystemConfig systemConfig = new SystemConfig();\n            systemConfig.setKey(key);\n            systemConfig.setValue(value);\n            QueryWrapper<SystemConfig> wrapper = new QueryWrapper<>();\n            wrapper.lambda().eq(SystemConfig::getKey, systemConfig.getKey());\n            systemConfigMapper.update(systemConfig, wrapper);\n        }\n        // SYSTEM_CONFIG\n        SYSTEM_CONFIG = null;\n        SYSTEM_CONFIG_WITHOUT_PASSWORD = null;\n    }\n\n    // key\n    @Override\n    public void updateByKey(String key, SystemConfig systemConfig) {\n        QueryWrapper<SystemConfig> wrapper = new QueryWrapper<>();\n        wrapper.lambda().eq(SystemConfig::getKey, key);\n        systemConfigMapper.update(systemConfig, wrapper);\n        // SYSTEM_CONFIG\n        SYSTEM_CONFIG = null;\n        SYSTEM_CONFIG_WITHOUT_PASSWORD = null;\n    }\n\n    @Override\n    public Map<String, String> selectAllConfigWithoutPassword() {\n        if (SYSTEM_CONFIG_WITHOUT_PASSWORD != null) {\n            return SYSTEM_CONFIG_WITHOUT_PASSWORD;\n        }\n        List<SystemConfig> systemConfigs = systemConfigMapper.selectList(null);\n        SYSTEM_CONFIG_WITHOUT_PASSWORD = systemConfigs.stream()\n                .filter(systemConfig -> systemConfig.getPid() != 0 && !systemConfig.getType().equals(\"password\"))\n                .collect(Collectors.toMap(SystemConfig::getKey, SystemConfig::getValue));\n        return SYSTEM_CONFIG_WITHOUT_PASSWORD;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/User.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 152
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\nimport com.fasterxml.jackson.annotation.JsonIgnore;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class User implements Serializable {\n\n    private static final long serialVersionUID = -5051120337175047163L;\n\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private String username;\n    private String telegramName;\n    private String avatar;\n    @JsonIgnore\n    private String password;\n    private String email;\n    private String mobile;\n    // \n    private String website;\n    // \n    private String bio;\n    private Integer score;\n    private Date inTime;\n    //    @JsonIgnore\n    private String token;\n    // \n    private Boolean emailNotification;\n    // \n    private Boolean active;\n\n    // telegram\n    // usernameuserIduserId\n    // \n    // private Boolean telegramNotification;\n\n    public Boolean getEmailNotification() {\n        return emailNotification;\n    }\n\n    public void setEmailNotification(Boolean emailNotification) {\n        this.emailNotification = emailNotification;\n    }\n\n    public String getTelegramName() {\n        return telegramName;\n    }\n\n    public void setTelegramName(String telegramName) {\n        this.telegramName = telegramName;\n    }\n\n    public String getToken() {\n        return token;\n    }\n\n    public void setToken(String token) {\n        this.token = token;\n    }\n\n    public String getAvatar() {\n        return avatar;\n    }\n\n    public void setAvatar(String avatar) {\n        this.avatar = avatar;\n    }\n\n    public String getWebsite() {\n        return website;\n    }\n\n    public void setWebsite(String website) {\n        this.website = website;\n    }\n\n    public String getBio() {\n        return bio;\n    }\n\n    public void setBio(String bio) {\n        this.bio = bio;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public Integer getScore() {\n        return score;\n    }\n\n    public void setScore(Integer score) {\n        this.score = score;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public Boolean getActive() {\n        return active;\n    }\n\n    public void setActive(Boolean active) {\n        this.active = active;\n    }\n\n    public String getMobile() {\n        return mobile;\n    }\n\n    public void setMobile(String mobile) {\n        this.mobile = mobile;\n    }\n\n    @Override\n    public String toString() {\n        return \"User{\" + \"id=\" + id + \", username='\" + username + '\\'' + \", telegramName='\" + telegramName + '\\'' + \", \"\n                + \"avatar='\" + avatar + '\\'' + \", password='\" + password + '\\'' + \", email='\" + email + '\\'' + \", mobile='\" +\n                mobile + '\\'' + \", website='\" + website + '\\'' + \", bio='\" + bio + '\\'' + \", score=\" + score + \", inTime=\" +\n                inTime + \", token='\" + token + '\\'' + \", emailNotification=\" + emailNotification + \", active=\" + active + '}';\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/OAuthUser.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 153
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.baomidou.mybatisplus.annotation.TableId;\nimport com.baomidou.mybatisplus.annotation.TableName;\nimport com.fasterxml.jackson.annotation.JsonIgnore;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@TableName(\"oauth_user\")\npublic class OAuthUser implements Serializable {\n\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    // oauthid\n    private Integer oauthId;\n    // GITHUB, QQ, WECHAT, WEIBO \n    @TableField(\"`type`\")\n    private String type;\n    // oauth\n    private String login;\n    @JsonIgnore\n    private String accessToken;\n    private Date inTime;\n    // \n    private String bio;\n    private String email;\n    // id\n    private Integer userId;\n    // token\n    private String refreshToken;\n    // id\n    private String unionId;\n    // tokenString\n    // StringString..\n    private String expiresIn;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public Integer getOauthId() {\n        return oauthId;\n    }\n\n    public void setOauthId(Integer oauthId) {\n        this.oauthId = oauthId;\n    }\n\n    public String getType() {\n        return type;\n    }\n\n    public void setType(String type) {\n        this.type = type;\n    }\n\n    public String getLogin() {\n        return login;\n    }\n\n    public void setLogin(String login) {\n        this.login = login;\n    }\n\n    public String getAccessToken() {\n        return accessToken;\n    }\n\n    public void setAccessToken(String accessToken) {\n        this.accessToken = accessToken;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public String getBio() {\n        return bio;\n    }\n\n    public void setBio(String bio) {\n        this.bio = bio;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public Integer getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Integer userId) {\n        this.userId = userId;\n    }\n\n    public String getRefreshToken() {\n        return refreshToken;\n    }\n\n    public void setRefreshToken(String refreshToken) {\n        this.refreshToken = refreshToken;\n    }\n\n    public String getUnionId() {\n        return unionId;\n    }\n\n    public void setUnionId(String unionId) {\n        this.unionId = unionId;\n    }\n\n    public String getExpiresIn() {\n        return expiresIn;\n    }\n\n    public void setExpiresIn(String expiresIn) {\n        this.expiresIn = expiresIn;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/IRolePermissionService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 154
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.RolePermission;\n\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface IRolePermissionService {\n    // id\n    List<RolePermission> selectByRoleId(Integer roleId);\n\n    // id\n    void deleteByRoleId(Integer roleId);\n\n    // id\n    void deleteByPermissionId(Integer permissionId);\n\n    void insert(RolePermission rolePermission);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/TopicMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 155
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Param;\n\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface TopicMapper extends BaseMapper<Topic> {\n\n    MyPage<Map<String, Object>> selectAll(MyPage<Map<String, Object>> iPage, @Param(\"tab\") String tab);\n\n    MyPage<Map<String, Object>> selectByTag(MyPage<Map<String, Object>> iPage, @Param(\"tag\") String tag);\n\n    MyPage<Map<String, Object>> selectByUserId(MyPage<Map<String, Object>> iPage, @Param(\"userId\") Integer userId);\n\n    MyPage<Map<String, Object>> selectAllForAdmin(MyPage<Map<String, Object>> iPage, @Param(\"startDate\") String\n            startDate, @Param(\"endDate\") String endDate, @Param(\"username\") String username);\n\n    int countToday();\n\n    MyPage<Map<String, Object>> search(MyPage<Map<String, Object>> iPage, @Param(\"keyword\") String keyword);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/interceptor/UserInterceptor.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 156
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.interceptor;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.impl.UserService;\nimport co.yiiu.pybbs.util.CookieUtil;\nimport co.yiiu.pybbs.util.HttpUtil;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.servlet.HandlerInterceptor;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class UserInterceptor implements HandlerInterceptor {\n\n    @Resource\n    private CookieUtil cookieUtil;\n    @Resource\n    private ISystemConfigService systemConfigService;\n    @Resource\n    private UserService userService;\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        HttpSession session = request.getSession();\n        User user = (User) session.getAttribute(\"_user\");\n        if (user == null) {\n            String token = cookieUtil.getCookie(systemConfigService.selectAllConfig().get(\"cookie_name\").toString());\n            if (!StringUtils.isEmpty(token)) {\n                user = userService.selectByToken(token);\n                session.setAttribute(\"_user\", user);\n            }\n        }\n        if (user == null) {\n            HttpUtil.responseWrite(request, response);\n            return false;\n        } else {\n            return true;\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/IAdminUserService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 157
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\nimport co.yiiu.pybbs.model.AdminUser;\n\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface IAdminUserService {\n    // \n    AdminUser selectByUsername(String username);\n\n    // \n    List<Map<String, Object>> selectAll();\n\n    void update(AdminUser adminUser);\n\n    void insert(AdminUser adminUser);\n\n    void delete(Integer id);\n\n    AdminUser selectById(Integer id);\n\n    // id\n    List<AdminUser> selectByRoleId(Integer roleId);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/bcrypt/BCrypt.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 158
      },
      "contents" : {
        "text" : "// Copyright (c) 2006 Damien Miller <djm@mindrot.org>\n//\n// Permission to use, copy, modify, and distribute this software for any\n// purpose with or without fee is hereby granted, provided that the above\n// copyright notice and this permission notice appear in all copies.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\n// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\n// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\n// ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\n// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\n// ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF\n// OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\npackage co.yiiu.pybbs.util.bcrypt;\n\nimport java.io.ByteArrayOutputStream;\nimport java.io.UnsupportedEncodingException;\nimport java.security.SecureRandom;\n\n/**\n * BCrypt implements OpenBSD-style Blowfish password hashing using the scheme described in\n * \"A Future-Adaptable Password Scheme\" by Niels Provos and David Mazieres.\n * <p>\n * This password hashing system tries to thwart off-line password cracking using a\n * computationally-intensive hashing algorithm, based on Bruce Schneier's Blowfish cipher.\n * The work factor of the algorithm is parameterised, so it can be increased as computers\n * get faster.\n * <p>\n * Usage is really simple. To hash a password for the first time, call the hashpw method\n * with a random salt, like this:\n * <p>\n * <code>\n * String pw_hash = BCrypt.hashpw(plain_password, BCrypt.gensalt()); <br>\n * </code>\n * <p>\n * To check whether a plaintext password matches one that has been hashed previously, use\n * the checkpw method:\n * <p>\n * <code>\n * if (BCrypt.checkpw(candidate_password, stored_hash))<br>\n * &nbsp;&nbsp;&nbsp;&nbsp;System.out.println(\"It matches\");<br>\n * else<br>\n * &nbsp;&nbsp;&nbsp;&nbsp;System.out.println(\"It does not match\");<br>\n * </code>\n * <p>\n * The gensalt() method takes an optional parameter (log_rounds) that determines the\n * computational complexity of the hashing:\n * <p>\n * <code>\n * String strong_salt = BCrypt.gensalt(10)<br>\n * String stronger_salt = BCrypt.gensalt(12)<br>\n * </code>\n * <p>\n * The amount of work increases exponentially (2**log_rounds), so each increment is twice\n * as much work. The default log_rounds is 10, and the valid range is 4 to 31.\n *\n * @author Damien Miller\n */\npublic class BCrypt {\n    // BCrypt parameters\n\n    private static final int GENSALT_DEFAULT_LOG2_ROUNDS = 10;\n    private static final int BCRYPT_SALT_LEN = 16;\n    // Blowfish parameters\n    private static final int BLOWFISH_NUM_ROUNDS = 16;\n    // Initial contents of key schedule\n    private static final int P_orig[] = {0x243f6a88, 0x85a308d3, 0x13198a2e, 0x03707344, 0xa4093822, 0x299f31d0,\n            0x082efa98, 0xec4e6c89, 0x452821e6, 0x38d01377, 0xbe5466cf, 0x34e90c6c, 0xc0ac29b7, 0xc97c50dd, 0x3f84d5b5,\n            0xb5470917, 0x9216d5d9, 0x8979fb1b};\n    private static final int S_orig[] = {0xd1310ba6, 0x98dfb5ac, 0x2ffd72db, 0xd01adfb7, 0xb8e1afed, 0x6a267e96,\n            0xba7c9045, 0xf12c7f99, 0x24a19947, 0xb3916cf7, 0x0801f2e2, 0x858efc16, 0x636920d8, 0x71574e69, 0xa458fea3,\n            0xf4933d7e, 0x0d95748f, 0x728eb658, 0x718bcd58, 0x82154aee, 0x7b54a41d, 0xc25a59b5, 0x9c30d539, 0x2af26013,\n            0xc5d1b023, 0x286085f0, 0xca417918, 0xb8db38ef, 0x8e79dcb0, 0x603a180e, 0x6c9e0e8b, 0xb01e8a3e, 0xd71577c1,\n            0xbd314b27, 0x78af2fda, 0x55605c60, 0xe65525f3, 0xaa55ab94, 0x57489862, 0x63e81440, 0x55ca396a, 0x2aab10b6,\n            0xb4cc5c34, 0x1141e8ce, 0xa15486af, 0x7c72e993, 0xb3ee1411, 0x636fbc2a, 0x2ba9c55d, 0x741831f6, 0xce5c3e16,\n            0x9b87931e, 0xafd6ba33, 0x6c24cf5c, 0x7a325381, 0x28958677, 0x3b8f4898, 0x6b4bb9af, 0xc4bfe81b, 0x66282193,\n            0x61d809cc, 0xfb21a991, 0x487cac60, 0x5dec8032, 0xef845d5d, 0xe98575b1, 0xdc262302, 0xeb651b88, 0x23893e81,\n            0xd396acc5, 0x0f6d6ff3, 0x83f44239, 0x2e0b4482, 0xa4842004, 0x69c8f04a, 0x9e1f9b5e, 0x21c66842, 0xf6e96c9a,\n            0x670c9c61, 0xabd388f0, 0x6a51a0d2, 0xd8542f68, 0x960fa728, 0xab5133a3, 0x6eef0b6c, 0x137a3be4, 0xba3bf050,\n            0x7efb2a98, 0xa1f1651d, 0x39af0176, 0x66ca593e, 0x82430e88, 0x8cee8619, 0x456f9fb4, 0x7d84a5c3, 0x3b8b5ebe,\n            0xe06f75d8, 0x85c12073, 0x401a449f, 0x56c16aa6, 0x4ed3aa62, 0x363f7706, 0x1bfedf72, 0x429b023d, 0x37d0d724,\n            0xd00a1248, 0xdb0fead3, 0x49f1c09b, 0x075372c9, 0x80991b7b, 0x25d479d8, 0xf6e8def7, 0xe3fe501a, 0xb6794c3b,\n            0x976ce0bd, 0x04c006ba, 0xc1a94fb6, 0x409f60c4, 0x5e5c9ec2, 0x196a2463, 0x68fb6faf, 0x3e6c53b5, 0x1339b2eb,\n            0x3b52ec6f, 0x6dfc511f, 0x9b30952c, 0xcc814544, 0xaf5ebd09, 0xbee3d004, 0xde334afd, 0x660f2807, 0x192e4bb3,\n            0xc0cba857, 0x45c8740f, 0xd20b5f39, 0xb9d3fbdb, 0x5579c0bd, 0x1a60320a, 0xd6a100c6, 0x402c7279, 0x679f25fe,\n            0xfb1fa3cc, 0x8ea5e9f8, 0xdb3222f8, 0x3c7516df, 0xfd616b15, 0x2f501ec8, 0xad0552ab, 0x323db5fa, 0xfd238760,\n            0x53317b48, 0x3e00df82, 0x9e5c57bb, 0xca6f8ca0, 0x1a87562e, 0xdf1769db, 0xd542a8f6, 0x287effc3, 0xac6732c6,\n            0x8c4f5573, 0x695b27b0, 0xbbca58c8, 0xe1ffa35d, 0xb8f011a0, 0x10fa3d98, 0xfd2183b8, 0x4afcb56c, 0x2dd1d35b,\n            0x9a53e479, 0xb6f84565, 0xd28e49bc, 0x4bfb9790, 0xe1ddf2da, 0xa4cb7e33, 0x62fb1341, 0xcee4c6e8, 0xef20cada,\n            0x36774c01, 0xd07e9efe, 0x2bf11fb4, 0x95dbda4d, 0xae909198, 0xeaad8e71, 0x6b93d5a0, 0xd08ed1d0, 0xafc725e0,\n            0x8e3c5b2f, 0x8e7594b7, 0x8ff6e2fb, 0xf2122b64, 0x8888b812, 0x900df01c, 0x4fad5ea0, 0x688fc31c, 0xd1cff191,\n            0xb3a8c1ad, 0x2f2f2218, 0xbe0e1777, 0xea752dfe, 0x8b021fa1, 0xe5a0cc0f, 0xb56f74e8, 0x18acf3d6, 0xce89e299,\n            0xb4a84fe0, 0xfd13e0b7, 0x7cc43b81, 0xd2ada8d9, 0x165fa266, 0x80957705, 0x93cc7314, 0x211a1477, 0xe6ad2065,\n            0x77b5fa86, 0xc75442f5, 0xfb9d35cf, 0xebcdaf0c, 0x7b3e89a0, 0xd6411bd3, 0xae1e7e49, 0x00250e2d, 0x2071b35e,\n            0x226800bb, 0x57b8e0af, 0x2464369b, 0xf009b91e, 0x5563911d, 0x59dfa6aa, 0x78c14389, 0xd95a537f, 0x207d5ba2,\n            0x02e5b9c5, 0x83260376, 0x6295cfa9, 0x11c81968, 0x4e734a41, 0xb3472dca, 0x7b14a94a, 0x1b510052, 0x9a532915,\n            0xd60f573f, 0xbc9bc6e4, 0x2b60a476, 0x81e67400, 0x08ba6fb5, 0x571be91f, 0xf296ec6b, 0x2a0dd915, 0xb6636521,\n            0xe7b9f9b6, 0xff34052e, 0xc5855664, 0x53b02d5d, 0xa99f8fa1, 0x08ba4799, 0x6e85076a, 0x4b7a70e9, 0xb5b32944,\n            0xdb75092e, 0xc4192623, 0xad6ea6b0, 0x49a7df7d, 0x9cee60b8, 0x8fedb266, 0xecaa8c71, 0x699a17ff, 0x5664526c,\n            0xc2b19ee1, 0x193602a5, 0x75094c29, 0xa0591340, 0xe4183a3e, 0x3f54989a, 0x5b429d65, 0x6b8fe4d6, 0x99f73fd6,\n            0xa1d29c07, 0xefe830f5, 0x4d2d38e6, 0xf0255dc1, 0x4cdd2086, 0x8470eb26, 0x6382e9c6, 0x021ecc5e, 0x09686b3f,\n            0x3ebaefc9, 0x3c971814, 0x6b6a70a1, 0x687f3584, 0x52a0e286, 0xb79c5305, 0xaa500737, 0x3e07841c, 0x7fdeae5c,\n            0x8e7d44ec, 0x5716f2b8, 0xb03ada37, 0xf0500c0d, 0xf01c1f04, 0x0200b3ff, 0xae0cf51a, 0x3cb574b2, 0x25837a58,\n            0xdc0921bd, 0xd19113f9, 0x7ca92ff6, 0x94324773, 0x22f54701, 0x3ae5e581, 0x37c2dadc, 0xc8b57634, 0x9af3dda7,\n            0xa9446146, 0x0fd0030e, 0xecc8c73e, 0xa4751e41, 0xe238cd99, 0x3bea0e2f, 0x3280bba1, 0x183eb331, 0x4e548b38,\n            0x4f6db908, 0x6f420d03, 0xf60a04bf, 0x2cb81290, 0x24977c79, 0x5679b072, 0xbcaf89af, 0xde9a771f, 0xd9930810,\n            0xb38bae12, 0xdccf3f2e, 0x5512721f, 0x2e6b7124, 0x501adde6, 0x9f84cd87, 0x7a584718, 0x7408da17, 0xbc9f9abc,\n            0xe94b7d8c, 0xec7aec3a, 0xdb851dfa, 0x63094366, 0xc464c3d2, 0xef1c1847, 0x3215d908, 0xdd433b37, 0x24c2ba16,\n            0x12a14d43, 0x2a65c451, 0x50940002, 0x133ae4dd, 0x71dff89e, 0x10314e55, 0x81ac77d6, 0x5f11199b, 0x043556f1,\n            0xd7a3c76b, 0x3c11183b, 0x5924a509, 0xf28fe6ed, 0x97f1fbfa, 0x9ebabf2c, 0x1e153c6e, 0x86e34570, 0xeae96fb1,\n            0x860e5e0a, 0x5a3e2ab3, 0x771fe71c, 0x4e3d06fa, 0x2965dcb9, 0x99e71d0f, 0x803e89d6, 0x5266c825, 0x2e4cc978,\n            0x9c10b36a, 0xc6150eba, 0x94e2ea78, 0xa5fc3c53, 0x1e0a2df4, 0xf2f74ea7, 0x361d2b3d, 0x1939260f, 0x19c27960,\n            0x5223a708, 0xf71312b6, 0xebadfe6e, 0xeac31f66, 0xe3bc4595, 0xa67bc883, 0xb17f37d1, 0x018cff28, 0xc332ddef,\n            0xbe6c5aa5, 0x65582185, 0x68ab9802, 0xeecea50f, 0xdb2f953b, 0x2aef7dad, 0x5b6e2f84, 0x1521b628, 0x29076170,\n            0xecdd4775, 0x619f1510, 0x13cca830, 0xeb61bd96, 0x0334fe1e, 0xaa0363cf, 0xb5735c90, 0x4c70a239, 0xd59e9e0b,\n            0xcbaade14, 0xeecc86bc, 0x60622ca7, 0x9cab5cab, 0xb2f3846e, 0x648b1eaf, 0x19bdf0ca, 0xa02369b9, 0x655abb50,\n            0x40685a32, 0x3c2ab4b3, 0x319ee9d5, 0xc021b8f7, 0x9b540b19, 0x875fa099, 0x95f7997e, 0x623d7da8, 0xf837889a,\n            0x97e32d77, 0x11ed935f, 0x16681281, 0x0e358829, 0xc7e61fd6, 0x96dedfa1, 0x7858ba99, 0x57f584a5, 0x1b227263,\n            0x9b83c3ff, 0x1ac24696, 0xcdb30aeb, 0x532e3054, 0x8fd948e4, 0x6dbc3128, 0x58ebf2ef, 0x34c6ffea, 0xfe28ed61,\n            0xee7c3c73, 0x5d4a14d9, 0xe864b7e3, 0x42105d14, 0x203e13e0, 0x45eee2b6, 0xa3aaabea, 0xdb6c4f15, 0xfacb4fd0,\n            0xc742f442, 0xef6abbb5, 0x654f3b1d, 0x41cd2105, 0xd81e799e, 0x86854dc7, 0xe44b476a, 0x3d816250, 0xcf62a1f2,\n            0x5b8d2646, 0xfc8883a0, 0xc1c7b6a3, 0x7f1524c3, 0x69cb7492, 0x47848a0b, 0x5692b285, 0x095bbf00, 0xad19489d,\n            0x1462b174, 0x23820e00, 0x58428d2a, 0x0c55f5ea, 0x1dadf43e, 0x233f7061, 0x3372f092, 0x8d937e41, 0xd65fecf1,\n            0x6c223bdb, 0x7cde3759, 0xcbee7460, 0x4085f2a7, 0xce77326e, 0xa6078084, 0x19f8509e, 0xe8efd855, 0x61d99735,\n            0xa969a7aa, 0xc50c06c2, 0x5a04abfc, 0x800bcadc, 0x9e447a2e, 0xc3453484, 0xfdd56705, 0x0e1e9ec9, 0xdb73dbd3,\n            0x105588cd, 0x675fda79, 0xe3674340, 0xc5c43465, 0x713e38d8, 0x3d28f89e, 0xf16dff20, 0x153e21e7, 0x8fb03d4a,\n            0xe6e39f2b, 0xdb83adf7, 0xe93d5a68, 0x948140f7, 0xf64c261c, 0x94692934, 0x411520f7, 0x7602d4f7, 0xbcf46b2e,\n            0xd4a20068, 0xd4082471, 0x3320f46a, 0x43b7d4b7, 0x500061af, 0x1e39f62e, 0x97244546, 0x14214f74, 0xbf8b8840,\n            0x4d95fc1d, 0x96b591af, 0x70f4ddd3, 0x66a02f45, 0xbfbc09ec, 0x03bd9785, 0x7fac6dd0, 0x31cb8504, 0x96eb27b3,\n            0x55fd3941, 0xda2547e6, 0xabca0a9a, 0x28507825, 0x530429f4, 0x0a2c86da, 0xe9b66dfb, 0x68dc1462, 0xd7486900,\n            0x680ec0a4, 0x27a18dee, 0x4f3ffea2, 0xe887ad8c, 0xb58ce006, 0x7af4d6b6, 0xaace1e7c, 0xd3375fec, 0xce78a399,\n            0x406b2a42, 0x20fe9e35, 0xd9f385b9, 0xee39d7ab, 0x3b124e8b, 0x1dc9faf7, 0x4b6d1856, 0x26a36631, 0xeae397b2,\n            0x3a6efa74, 0xdd5b4332, 0x6841e7f7, 0xca7820fb, 0xfb0af54e, 0xd8feb397, 0x454056ac, 0xba489527, 0x55533a3a,\n            0x20838d87, 0xfe6ba9b7, 0xd096954b, 0x55a867bc, 0xa1159a58, 0xcca92963, 0x99e1db33, 0xa62a4a56, 0x3f3125f9,\n            0x5ef47e1c, 0x9029317c, 0xfdf8e802, 0x04272f70, 0x80bb155c, 0x05282ce3, 0x95c11548, 0xe4c66d22, 0x48c1133f,\n            0xc70f86dc, 0x07f9c9ee, 0x41041f0f, 0x404779a4, 0x5d886e17, 0x325f51eb, 0xd59bc0d1, 0xf2bcc18f, 0x41113564,\n            0x257b7834, 0x602a9c60, 0xdff8e8a3, 0x1f636c1b, 0x0e12b4c2, 0x02e1329e, 0xaf664fd1, 0xcad18115, 0x6b2395e0,\n            0x333e92e1, 0x3b240b62, 0xeebeb922, 0x85b2a20e, 0xe6ba0d99, 0xde720c8c, 0x2da2f728, 0xd0127845, 0x95b794fd,\n            0x647d0862, 0xe7ccf5f0, 0x5449a36f, 0x877d48fa, 0xc39dfd27, 0xf33e8d1e, 0x0a476341, 0x992eff74, 0x3a6f6eab,\n            0xf4f8fd37, 0xa812dc60, 0xa1ebddf8, 0x991be14c, 0xdb6e6b0d, 0xc67b5510, 0x6d672c37, 0x2765d43b, 0xdcd0e804,\n            0xf1290dc7, 0xcc00ffa3, 0xb5390f92, 0x690fed0b, 0x667b9ffb, 0xcedb7d9c, 0xa091cf0b, 0xd9155ea3, 0xbb132f88,\n            0x515bad24, 0x7b9479bf, 0x763bd6eb, 0x37392eb3, 0xcc115979, 0x8026e297, 0xf42e312d, 0x6842ada7, 0xc66a2b3b,\n            0x12754ccc, 0x782ef11c, 0x6a124237, 0xb79251e7, 0x06a1bbe6, 0x4bfb6350, 0x1a6b1018, 0x11caedfa, 0x3d25bdd8,\n            0xe2e1c3c9, 0x44421659, 0x0a121386, 0xd90cec6e, 0xd5abea2a, 0x64af674e, 0xda86a85f, 0xbebfe988, 0x64e4c3fe,\n            0x9dbc8057, 0xf0f7c086, 0x60787bf8, 0x6003604d, 0xd1fd8346, 0xf6381fb0, 0x7745ae04, 0xd736fccc, 0x83426b33,\n            0xf01eab71, 0xb0804187, 0x3c005e5f, 0x77a057be, 0xbde8ae24, 0x55464299, 0xbf582e61, 0x4e58f48f, 0xf2ddfda2,\n            0xf474ef38, 0x8789bdc2, 0x5366f9c3, 0xc8b38e74, 0xb475f255, 0x46fcd9b9, 0x7aeb2661, 0x8b1ddf84, 0x846a0e79,\n            0x915f95e2, 0x466e598e, 0x20b45770, 0x8cd55591, 0xc902de4c, 0xb90bace1, 0xbb8205d0, 0x11a86248, 0x7574a99e,\n            0xb77f19b6, 0xe0a9dc09, 0x662d09a1, 0xc4324633, 0xe85a1f02, 0x09f0be8c, 0x4a99a025, 0x1d6efe10, 0x1ab93d1d,\n            0x0ba5a4df, 0xa186f20f, 0x2868f169, 0xdcb7da83, 0x573906fe, 0xa1e2ce9b, 0x4fcd7f52, 0x50115e01, 0xa70683fa,\n            0xa002b5c4, 0x0de6d027, 0x9af88c27, 0x773f8641, 0xc3604c06, 0x61a806b5, 0xf0177a28, 0xc0f586e0, 0x006058aa,\n            0x30dc7d62, 0x11e69ed7, 0x2338ea63, 0x53c2dd94, 0xc2c21634, 0xbbcbee56, 0x90bcb6de, 0xebfc7da1, 0xce591d76,\n            0x6f05e409, 0x4b7c0188, 0x39720a3d, 0x7c927c24, 0x86e3725f, 0x724d9db9, 0x1ac15bb4, 0xd39eb8fc, 0xed545578,\n            0x08fca5b5, 0xd83d7cd3, 0x4dad0fc4, 0x1e50ef5e, 0xb161e6f8, 0xa28514d9, 0x6c51133c, 0x6fd5c7e7, 0x56e14ec4,\n            0x362abfce, 0xddc6c837, 0xd79a3234, 0x92638212, 0x670efa8e, 0x406000e0, 0x3a39ce37, 0xd3faf5cf, 0xabc27737,\n            0x5ac52d1b, 0x5cb0679e, 0x4fa33742, 0xd3822740, 0x99bc9bbe, 0xd5118e9d, 0xbf0f7315, 0xd62d1c7e, 0xc700c47b,\n            0xb78c1b6b, 0x21a19045, 0xb26eb1be, 0x6a366eb4, 0x5748ab2f, 0xbc946e79, 0xc6a376d2, 0x6549c2c8, 0x530ff8ee,\n            0x468dde7d, 0xd5730a1d, 0x4cd04dc6, 0x2939bbdb, 0xa9ba4650, 0xac9526e8, 0xbe5ee304, 0xa1fad5f0, 0x6a2d519a,\n            0x63ef8ce2, 0x9a86ee22, 0xc089c2b8, 0x43242ef6, 0xa51e03aa, 0x9cf2d0a4, 0x83c061ba, 0x9be96a4d, 0x8fe51550,\n            0xba645bd6, 0x2826a2f9, 0xa73a3ae1, 0x4ba99586, 0xef5562e9, 0xc72fefd3, 0xf752f7da, 0x3f046f69, 0x77fa0a59,\n            0x80e4a915, 0x87b08601, 0x9b09e6ad, 0x3b3ee593, 0xe990fd5a, 0x9e34d797, 0x2cf0b7d9, 0x022b8b51, 0x96d5ac3a,\n            0x017da67d, 0xd1cf3ed6, 0x7c7d2d28, 0x1f9f25cf, 0xadf2b89b, 0x5ad6b472, 0x5a88f54c, 0xe029ac71, 0xe019a5e6,\n            0x47b0acfd, 0xed93fa9b, 0xe8d3c48d, 0x283b57cc, 0xf8d56629, 0x79132e28, 0x785f0191, 0xed756055, 0xf7960e44,\n            0xe3d35e8c, 0x15056dd4, 0x88f46dba, 0x03a16125, 0x0564f0bd, 0xc3eb9e15, 0x3c9057a2, 0x97271aec, 0xa93a072a,\n            0x1b3f6d9b, 0x1e6321f5, 0xf59c66fb, 0x26dcf319, 0x7533d928, 0xb155fdf5, 0x03563482, 0x8aba3cbb, 0x28517711,\n            0xc20ad9f8, 0xabcc5167, 0xccad925f, 0x4de81751, 0x3830dc8e, 0x379d5862, 0x9320f991, 0xea7a90c2, 0xfb3e7bce,\n            0x5121ce64, 0x774fbe32, 0xa8b6e37e, 0xc3293d46, 0x48de5369, 0x6413e680, 0xa2ae0810, 0xdd6db224, 0x69852dfd,\n            0x09072166, 0xb39a460a, 0x6445c0dd, 0x586cdecf, 0x1c20c8ae, 0x5bbef7dd, 0x1b588d40, 0xccd2017f, 0x6bb4e3bb,\n            0xdda26a7e, 0x3a59ff45, 0x3e350a44, 0xbcb4cdd5, 0x72eacea8, 0xfa6484bb, 0x8d6612ae, 0xbf3c6f47, 0xd29be463,\n            0x542f5d9e, 0xaec2771b, 0xf64e6370, 0x740e0d8d, 0xe75b1357, 0xf8721671, 0xaf537d5d, 0x4040cb08, 0x4eb4e2cc,\n            0x34d2466a, 0x0115af84, 0xe1b00428, 0x95983a1d, 0x06b89fb4, 0xce6ea048, 0x6f3f3b82, 0x3520ab82, 0x011a1d4b,\n            0x277227f8, 0x611560b1, 0xe7933fdc, 0xbb3a792b, 0x344525bd, 0xa08839e1, 0x51ce794b, 0x2f32c9b7, 0xa01fbac9,\n            0xe01cc87e, 0xbcc7d1f6, 0xcf0111c3, 0xa1e8aac7, 0x1a908749, 0xd44fbd9a, 0xd0dadecb, 0xd50ada38, 0x0339c32a,\n            0xc6913667, 0x8df9317c, 0xe0b12b4f, 0xf79e59b7, 0x43f5bb3a, 0xf2d519ff, 0x27d9459c, 0xbf97222c, 0x15e6fc2a,\n            0x0f91fc71, 0x9b941525, 0xfae59361, 0xceb69ceb, 0xc2a86459, 0x12baa8d1, 0xb6c1075e, 0xe3056a0c, 0x10d25065,\n            0xcb03a442, 0xe0ec6e0e, 0x1698db3b, 0x4c98a0be, 0x3278e964, 0x9f1f9532, 0xe0d392df, 0xd3a0342b, 0x8971f21e,\n            0x1b0a7441, 0x4ba3348c, 0xc5be7120, 0xc37632d8, 0xdf359f8d, 0x9b992f2e, 0xe60b6f47, 0x0fe3f11d, 0xe54cda54,\n            0x1edad891, 0xce6279cf, 0xcd3e7e6f, 0x1618b166, 0xfd2c1d05, 0x848fd2c5, 0xf6fb2299, 0xf523f357, 0xa6327623,\n            0x93a83531, 0x56cccd02, 0xacf08162, 0x5a75ebb5, 0x6e163697, 0x88d273cc, 0xde966292, 0x81b949d0, 0x4c50901b,\n            0x71c65614, 0xe6c6c7bd, 0x327a140a, 0x45e1d006, 0xc3f27b9a, 0xc9aa53fd, 0x62a80f00, 0xbb25bfe2, 0x35bdd2f6,\n            0x71126905, 0xb2040222, 0xb6cbcf7c, 0xcd769c2b, 0x53113ec0, 0x1640e3d3, 0x38abbd60, 0x2547adf0, 0xba38209c,\n            0xf746ce76, 0x77afa1c5, 0x20756060, 0x85cbfe4e, 0x8ae88dd8, 0x7aaaf9b0, 0x4cf9aa7e, 0x1948c25c, 0x02fb8a8c,\n            0x01c36ae4, 0xd6ebe1f9, 0x90d4f869, 0xa65cdea0, 0x3f09252d, 0xc208e69f, 0xb74e6132, 0xce77e25b, 0x578fdfe3,\n            0x3ac372e6};\n    // bcrypt IV: \"OrpheanBeholderScryDoubt\"\n    static private final int bf_crypt_ciphertext[] = {0x4f727068, 0x65616e42, 0x65686f6c, 0x64657253, 0x63727944,\n            0x6f756274};\n    // Table for Base64 encoding\n    static private final char base64_code[] = {'.', '/', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L',\n            'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h',\n            'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '0', '1', '2', '3',\n            '4', '5', '6', '7', '8', '9'};\n    // Table for Base64 decoding\n    static private final byte index_64[] = {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,\n            -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0,\n            1, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, -1, -1, -1, -1, -1, -1, -1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,\n            14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, -1, -1, -1, -1, -1, -1, 28, 29, 30, 31, 32, 33, 34, 35,\n            36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, -1, -1, -1, -1, -1};\n    static final int MIN_LOG_ROUNDS = 4;\n    static final int MAX_LOG_ROUNDS = 31;\n    // Expanded Blowfish key\n    private int P[];\n    private int S[];\n\n    /**\n     * Encode a byte array using bcrypt's slightly-modified base64 encoding scheme. Note\n     * that this is <strong>not</strong> compatible with the standard MIME-base64\n     * encoding.\n     *\n     * @param d   the byte array to encode\n     * @param len the number of bytes to encode\n     * @param rs  the destination buffer for the base64-encoded string\n     * @throws IllegalArgumentException if the length is invalid\n     */\n    static void encode_base64(byte d[], int len, StringBuilder rs) throws IllegalArgumentException {\n        int off = 0;\n        int c1, c2;\n\n        if (len <= 0 || len > d.length) {\n            throw new IllegalArgumentException(\"Invalid len\");\n        }\n\n        while (off < len) {\n            c1 = d[off++] & 0xff;\n            rs.append(base64_code[(c1 >> 2) & 0x3f]);\n            c1 = (c1 & 0x03) << 4;\n            if (off >= len) {\n                rs.append(base64_code[c1 & 0x3f]);\n                break;\n            }\n            c2 = d[off++] & 0xff;\n            c1 |= (c2 >> 4) & 0x0f;\n            rs.append(base64_code[c1 & 0x3f]);\n            c1 = (c2 & 0x0f) << 2;\n            if (off >= len) {\n                rs.append(base64_code[c1 & 0x3f]);\n                break;\n            }\n            c2 = d[off++] & 0xff;\n            c1 |= (c2 >> 6) & 0x03;\n            rs.append(base64_code[c1 & 0x3f]);\n            rs.append(base64_code[c2 & 0x3f]);\n        }\n    }\n\n    /**\n     * Look up the 3 bits base64-encoded by the specified character, range-checking\n     * against conversion table\n     *\n     * @param x the base64-encoded value\n     * @return the decoded value of x\n     */\n    private static byte char64(char x) {\n        if (x > index_64.length) {\n            return -1;\n        }\n        return index_64[x];\n    }\n\n    /**\n     * Decode a string encoded using bcrypt's base64 scheme to a byte array. Note that\n     * this is *not* compatible with the standard MIME-base64 encoding.\n     *\n     * @param s       the string to decode\n     * @param maxolen the maximum number of bytes to decode\n     * @return an array containing the decoded bytes\n     * @throws IllegalArgumentException if maxolen is invalid\n     */\n    static byte[] decode_base64(String s, int maxolen) throws IllegalArgumentException {\n        ByteArrayOutputStream out = new ByteArrayOutputStream(maxolen);\n        int off = 0, slen = s.length(), olen = 0;\n        byte c1, c2, c3, c4, o;\n\n        if (maxolen <= 0) {\n            throw new IllegalArgumentException(\"Invalid maxolen\");\n        }\n\n        while (off < slen - 1 && olen < maxolen) {\n            c1 = char64(s.charAt(off++));\n            c2 = char64(s.charAt(off++));\n            if (c1 == -1 || c2 == -1) {\n                break;\n            }\n            o = (byte) (c1 << 2);\n            o |= (c2 & 0x30) >> 4;\n            out.write(o);\n            if (++olen >= maxolen || off >= slen) {\n                break;\n            }\n            c3 = char64(s.charAt(off++));\n            if (c3 == -1) {\n                break;\n            }\n            o = (byte) ((c2 & 0x0f) << 4);\n            o |= (c3 & 0x3c) >> 2;\n            out.write(o);\n            if (++olen >= maxolen || off >= slen) {\n                break;\n            }\n            c4 = char64(s.charAt(off++));\n            o = (byte) ((c3 & 0x03) << 6);\n            o |= c4;\n            out.write(o);\n            ++olen;\n        }\n\n        return out.toByteArray();\n    }\n\n    /**\n     * Blowfish encipher a single 64-bit block encoded as two 32-bit halves\n     *\n     * @param lr  an array containing the two 32-bit half blocks\n     * @param off the position in the array of the blocks\n     */\n    private final void encipher(int lr[], int off) {\n        int i, n, l = lr[off], r = lr[off + 1];\n\n        l ^= P[0];\n        for (i = 0; i <= BLOWFISH_NUM_ROUNDS - 2; ) {\n            // Feistel substitution on left word\n            n = S[(l >> 24) & 0xff];\n            n += S[0x100 | ((l >> 16) & 0xff)];\n            n ^= S[0x200 | ((l >> 8) & 0xff)];\n            n += S[0x300 | (l & 0xff)];\n            r ^= n ^ P[++i];\n\n            // Feistel substitution on right word\n            n = S[(r >> 24) & 0xff];\n            n += S[0x100 | ((r >> 16) & 0xff)];\n            n ^= S[0x200 | ((r >> 8) & 0xff)];\n            n += S[0x300 | (r & 0xff)];\n            l ^= n ^ P[++i];\n        }\n        lr[off] = r ^ P[BLOWFISH_NUM_ROUNDS + 1];\n        lr[off + 1] = l;\n    }\n\n    /**\n     * Cycically extract a word of key material\n     *\n     * @param data the string to extract the data from\n     * @param offp a \"pointer\" (as a one-entry array) to the current offset into data\n     * @return the next word of material from data\n     */\n    private static int streamtoword(byte data[], int offp[]) {\n        int i;\n        int word = 0;\n        int off = offp[0];\n\n        for (i = 0; i < 4; i++) {\n            word = (word << 8) | (data[off] & 0xff);\n            off = (off + 1) % data.length;\n        }\n\n        offp[0] = off;\n        return word;\n    }\n\n    /**\n     * Initialise the Blowfish key schedule\n     */\n    private void init_key() {\n        P = (int[]) P_orig.clone();\n        S = (int[]) S_orig.clone();\n    }\n\n    /**\n     * Key the Blowfish cipher\n     *\n     * @param key an array containing the key\n     */\n    private void key(byte key[]) {\n        int i;\n        int koffp[] = {0};\n        int lr[] = {0, 0};\n        int plen = P.length, slen = S.length;\n\n        for (i = 0; i < plen; i++) {\n            P[i] = P[i] ^ streamtoword(key, koffp);\n        }\n\n        for (i = 0; i < plen; i += 2) {\n            encipher(lr, 0);\n            P[i] = lr[0];\n            P[i + 1] = lr[1];\n        }\n\n        for (i = 0; i < slen; i += 2) {\n            encipher(lr, 0);\n            S[i] = lr[0];\n            S[i + 1] = lr[1];\n        }\n    }\n\n    /**\n     * Perform the \"enhanced key schedule\" step described by Provos and Mazieres in\n     * \"A Future-Adaptable Password Scheme\" http://www.openbsd.org/papers/bcrypt-paper.ps\n     *\n     * @param data salt information\n     * @param key  password information\n     */\n    private void ekskey(byte data[], byte key[]) {\n        int i;\n        int koffp[] = {0}, doffp[] = {0};\n        int lr[] = {0, 0};\n        int plen = P.length, slen = S.length;\n\n        for (i = 0; i < plen; i++) {\n            P[i] = P[i] ^ streamtoword(key, koffp);\n        }\n\n        for (i = 0; i < plen; i += 2) {\n            lr[0] ^= streamtoword(data, doffp);\n            lr[1] ^= streamtoword(data, doffp);\n            encipher(lr, 0);\n            P[i] = lr[0];\n            P[i + 1] = lr[1];\n        }\n\n        for (i = 0; i < slen; i += 2) {\n            lr[0] ^= streamtoword(data, doffp);\n            lr[1] ^= streamtoword(data, doffp);\n            encipher(lr, 0);\n            S[i] = lr[0];\n            S[i + 1] = lr[1];\n        }\n    }\n\n    static long roundsForLogRounds(int log_rounds) {\n        if (log_rounds < 4 || log_rounds > 31) {\n            throw new IllegalArgumentException(\"Bad number of rounds\");\n        }\n        return 1L << log_rounds;\n    }\n\n    /**\n     * Perform the central password hashing step in the bcrypt scheme\n     *\n     * @param password   the password to hash\n     * @param salt       the binary salt to hash with the password\n     * @param log_rounds the binary logarithm of the number of rounds of hashing to apply\n     * @return an array containing the binary hashed password\n     */\n    private byte[] crypt_raw(byte password[], byte salt[], int log_rounds) {\n        int cdata[] = (int[]) bf_crypt_ciphertext.clone();\n        int clen = cdata.length;\n        byte ret[];\n\n        long rounds = roundsForLogRounds(log_rounds);\n\n        init_key();\n        ekskey(salt, password);\n        for (long i = 0; i < rounds; i++) {\n            key(password);\n            key(salt);\n        }\n\n        for (int i = 0; i < 64; i++) {\n            for (int j = 0; j < (clen >> 1); j++) {\n                encipher(cdata, j << 1);\n            }\n        }\n\n        ret = new byte[clen * 4];\n        for (int i = 0, j = 0; i < clen; i++) {\n            ret[j++] = (byte) ((cdata[i] >> 24) & 0xff);\n            ret[j++] = (byte) ((cdata[i] >> 16) & 0xff);\n            ret[j++] = (byte) ((cdata[i] >> 8) & 0xff);\n            ret[j++] = (byte) (cdata[i] & 0xff);\n        }\n        return ret;\n    }\n\n    /**\n     * Hash a password using the OpenBSD bcrypt scheme\n     *\n     * @param password the password to hash\n     * @param salt     the salt to hash with (perhaps generated using BCrypt.gensalt)\n     * @return the hashed password\n     * @throws IllegalArgumentException if invalid salt is passed\n     */\n    public static String hashpw(String password, String salt) throws IllegalArgumentException {\n        BCrypt B;\n        String real_salt;\n        byte passwordb[], saltb[], hashed[];\n        char minor = (char) 0;\n        int rounds, off = 0;\n        StringBuilder rs = new StringBuilder();\n\n        if (salt == null) {\n            throw new IllegalArgumentException(\"salt cannot be null\");\n        }\n\n        int saltLength = salt.length();\n\n        if (saltLength < 28) {\n            throw new IllegalArgumentException(\"Invalid salt\");\n        }\n\n        if (salt.charAt(0) != '$' || salt.charAt(1) != '2') {\n            throw new IllegalArgumentException(\"Invalid salt version\");\n        }\n        if (salt.charAt(2) == '$') {\n            off = 3;\n        } else {\n            minor = salt.charAt(2);\n            if (minor != 'a' || salt.charAt(3) != '$') {\n                throw new IllegalArgumentException(\"Invalid salt revision\");\n            }\n            off = 4;\n        }\n\n        if (saltLength - off < 25) {\n            throw new IllegalArgumentException(\"Invalid salt\");\n        }\n\n        // Extract number of rounds\n        if (salt.charAt(off + 2) > '$') {\n            throw new IllegalArgumentException(\"Missing salt rounds\");\n        }\n        rounds = Integer.parseInt(salt.substring(off, off + 2));\n\n        real_salt = salt.substring(off + 3, off + 25);\n        try {\n            passwordb = (password + (minor >= 'a' ? \"\\000\" : \"\")).getBytes(\"UTF-8\");\n        } catch (UnsupportedEncodingException uee) {\n            throw new AssertionError(\"UTF-8 is not supported\");\n        }\n\n        saltb = decode_base64(real_salt, BCRYPT_SALT_LEN);\n\n        B = new BCrypt();\n        hashed = B.crypt_raw(passwordb, saltb, rounds);\n\n        rs.append(\"$2\");\n        if (minor >= 'a') {\n            rs.append(minor);\n        }\n        rs.append(\"$\");\n        if (rounds < 10) {\n            rs.append(\"0\");\n        }\n        rs.append(rounds);\n        rs.append(\"$\");\n        encode_base64(saltb, saltb.length, rs);\n        encode_base64(hashed, bf_crypt_ciphertext.length * 4 - 1, rs);\n        return rs.toString();\n    }\n\n    /**\n     * Generate a salt for use with the BCrypt.hashpw() method\n     *\n     * @param log_rounds the log2 of the number of rounds of hashing to apply - the work\n     *                   factor therefore increases as 2**log_rounds. Minimum 4, maximum 31.\n     * @param random     an instance of SecureRandom to use\n     * @return an encoded salt value\n     */\n    public static String gensalt(int log_rounds, SecureRandom random) {\n        if (log_rounds < MIN_LOG_ROUNDS || log_rounds > MAX_LOG_ROUNDS) {\n            throw new IllegalArgumentException(\"Bad number of rounds\");\n        }\n        StringBuilder rs = new StringBuilder();\n        byte rnd[] = new byte[BCRYPT_SALT_LEN];\n\n        random.nextBytes(rnd);\n\n        rs.append(\"$2a$\");\n        if (log_rounds < 10) {\n            rs.append(\"0\");\n        }\n        rs.append(log_rounds);\n        rs.append(\"$\");\n        encode_base64(rnd, rnd.length, rs);\n        return rs.toString();\n    }\n\n    /**\n     * Generate a salt for use with the BCrypt.hashpw() method\n     *\n     * @param log_rounds the log2 of the number of rounds of hashing to apply - the work\n     *                   factor therefore increases as 2**log_rounds. Minimum 4, maximum 31.\n     * @return an encoded salt value\n     */\n    public static String gensalt(int log_rounds) {\n        return gensalt(log_rounds, new SecureRandom());\n    }\n\n    /**\n     * Generate a salt for use with the BCrypt.hashpw() method, selecting a reasonable\n     * default for the number of hashing rounds to apply\n     *\n     * @return an encoded salt value\n     */\n    public static String gensalt() {\n        return gensalt(GENSALT_DEFAULT_LOG2_ROUNDS);\n    }\n\n    /**\n     * Check that a plaintext password matches a previously hashed one\n     *\n     * @param plaintext the plaintext password to verify\n     * @param hashed    the previously-hashed password\n     * @return true if the passwords match, false otherwise\n     */\n    public static boolean checkpw(String plaintext, String hashed) {\n        return equalsNoEarlyReturn(hashed, hashpw(plaintext, hashed));\n    }\n\n    static boolean equalsNoEarlyReturn(String a, String b) {\n        char[] caa = a.toCharArray();\n        char[] cab = b.toCharArray();\n\n        if (caa.length != cab.length) {\n            return false;\n        }\n\n        byte ret = 0;\n        for (int i = 0; i < caa.length; i++) {\n            ret |= caa[i] ^ cab[i];\n        }\n        return ret == 0;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/CodeMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 159
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Code;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface CodeMapper extends BaseMapper<Code> {\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/vo/UserWithWebSocketVO.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 160
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model.vo;\n\n\nimport java.io.Serializable;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class UserWithWebSocketVO implements Serializable {\n\n    private static final long serialVersionUID = -8327007303087296114L;\n    private String username;\n    private Integer userId;\n\n    public UserWithWebSocketVO() {\n    }\n\n    public UserWithWebSocketVO(String username, Integer userId) {\n        this.username = username;\n        this.userId = userId;\n    }\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public Integer getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Integer userId) {\n        this.userId = userId;\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Role.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 161
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Role implements Serializable {\n    private static final long serialVersionUID = 7824693669858106664L;\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private String name;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/service/IIndexedService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 162
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.service;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface IIndexedService {\n\n    // \n    void indexAllTopic();\n\n    // \n    void indexTopic(String id, String title, String content);\n\n    // \n    void deleteTopicIndex(String id);\n\n    // \n    void batchDeleteIndex();\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Notification.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 163
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport com.baomidou.mybatisplus.annotation.IdType;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.baomidou.mybatisplus.annotation.TableId;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Notification implements Serializable {\n    private static final long serialVersionUID = 3235461023789820336L;\n\n    @TableId(type = IdType.AUTO)\n    private Integer id;\n    private Integer topicId;\n    private Integer userId;\n    // ID\n    private Integer targetUserId;\n    // : REPLY, COMMENT, COLLECT, TOPIC_UP, COMMENT_UP\n    private String action;\n    private Date inTime;\n    private String content;\n    // \n    @TableField(\"`read`\")\n    private Boolean read;\n\n    public String getContent() {\n        return content;\n    }\n\n    public void setContent(String content) {\n        this.content = content;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public Integer getTopicId() {\n        return topicId;\n    }\n\n    public void setTopicId(Integer topicId) {\n        this.topicId = topicId;\n    }\n\n    public Integer getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Integer userId) {\n        this.userId = userId;\n    }\n\n    public Integer getTargetUserId() {\n        return targetUserId;\n    }\n\n    public void setTargetUserId(Integer targetUserId) {\n        this.targetUserId = targetUserId;\n    }\n\n    public String getAction() {\n        return action;\n    }\n\n    public void setAction(String action) {\n        this.action = action;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n\n    public Boolean getRead() {\n        return read;\n    }\n\n    public void setRead(Boolean read) {\n        this.read = read;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/controller/api/SettingsApiController.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 164
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.controller.api;\n\nimport co.yiiu.pybbs.exception.ApiAssert;\nimport co.yiiu.pybbs.model.Code;\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICodeService;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport co.yiiu.pybbs.service.IUserService;\nimport co.yiiu.pybbs.util.Result;\nimport co.yiiu.pybbs.util.StringUtil;\nimport co.yiiu.pybbs.util.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.bind.annotation.*;\n\nimport javax.annotation.Resource;\nimport javax.servlet.http.HttpSession;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@RestController\n@RequestMapping(\"/api/settings\")\npublic class SettingsApiController extends BaseApiController {\n\n    @Resource\n    private IUserService userService;\n    @Resource\n    private ICodeService codeService;\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    // \n    @PutMapping\n    public Result update(@RequestBody Map<String, String> body, HttpSession session) {\n        User user = getApiUser();\n        String telegramName = body.get(\"telegramName\");\n        String website = body.get(\"website\");\n        String bio = body.get(\"bio\");\n        Boolean emailNotification = Boolean.parseBoolean(body.get(\"emailNotification\"));\n        // \n        User user1 = userService.selectById(user.getId());\n        user1.setTelegramName(telegramName);\n        user1.setWebsite(website);\n        user1.setBio(bio);\n        user1.setEmailNotification(emailNotification);\n        userService.update(user1);\n\n        User user2 = getUser();\n        if (user2 != null) {\n            user2.setBio(bio);\n            session.setAttribute(\"_user\", user2);\n        }\n        return success();\n    }\n\n    // \n    @GetMapping(\"/sendActiveEmail\")\n    public Result sendActiveEmail() {\n        User user = getApiUser();\n        ApiAssert.notTrue(StringUtils.isEmpty(user.getEmail()), \"\");\n        ApiAssert.notTrue(user.getActive(), \"\");\n\n        String title = \"%s\";\n        String content = \"%s&nbsp;&nbsp;<a href='%s/active?email=%s&code=${code}'></a>\";\n\n        if (codeService.sendEmail(\n                user.getId(),\n                user.getEmail(),\n                String.format(title, systemConfigService.selectAllConfig().get(\"base_url\").toString()),\n                String.format(content, systemConfigService.selectAllConfig().get(\"name\").toString(),\n                        systemConfigService.selectAllConfig().get(\"base_url\").toString(),\n                        user.getEmail()))) {\n            return success();\n        } else {\n            return error(\"\");\n        }\n    }\n\n    // \n    @GetMapping(\"/sendEmailCode\")\n    public Result sendEmailCode(String email) {\n        User user = getApiUser();\n        ApiAssert.notEmpty(email, \" \");\n        ApiAssert.isTrue(StringUtil.check(email, StringUtil.EMAILREGEX), \"\");\n        User emailUser = userService.selectByEmail(email);\n        ApiAssert.isNull(emailUser, \"\");\n        if (codeService.sendEmail(user.getId(), email, \"\", \"<code>${code}</code><br>30\")) {\n            return success();\n        } else {\n            return error(\"\");\n        }\n    }\n\n    // \n    @PutMapping(\"/updateEmail\")\n    public Result updateEmail(@RequestBody Map<String, String> body, HttpSession session) {\n        User user = getApiUser();\n        String email = body.get(\"email\");\n        String code = body.get(\"code\");\n        ApiAssert.notEmpty(email, \" \");\n        ApiAssert.isTrue(StringUtil.check(email, StringUtil.EMAILREGEX), \"\");\n        Code code1 = codeService.validateCode(user.getId(), email, null, code);\n        if (code1 == null) return error(\"\");\n        // code\n        code1.setUsed(true);\n        codeService.update(code1);\n        // \n        User user1 = userService.selectById(user.getId());\n        user1.setEmail(email);\n        // \n        if (!user1.getActive()) user1.setActive(true);\n        userService.update(user1);\n        // session\n        User _user = getUser();\n        _user.setEmail(email);\n        session.setAttribute(\"_user\", _user);\n        return success();\n    }\n\n    // \n    @PutMapping(\"/updatePassword\")\n    public Result updatePassword(@RequestBody Map<String, String> body) {\n        User user = getApiUser();\n        user = userService.selectByIdWithoutCache(user.getId());\n\n        String oldPassword = body.get(\"oldPassword\");\n        String newPassword = body.get(\"newPassword\");\n\n        ApiAssert.notEmpty(oldPassword, \"\");\n        ApiAssert.notEmpty(newPassword, \"\");\n        ApiAssert.notTrue(oldPassword.equals(newPassword), \"\");\n        ApiAssert.isTrue(new BCryptPasswordEncoder().matches(oldPassword, user.getPassword()), \"\");\n\n        user.setPassword(new BCryptPasswordEncoder().encode(newPassword));\n        userService.update(user);\n        return success();\n    }\n\n    // token\n    @GetMapping(\"/refreshToken\")\n    public Result refreshToken(HttpSession session) {\n        User user = getApiUser();\n        String token = StringUtil.uuid();\n        user.setToken(token);\n        userService.update(user);\n        // session\n        User _user = getUser();\n        _user.setToken(token);\n        session.setAttribute(\"_user\", _user);\n        return success(token);\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/MyPage.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 165
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport com.baomidou.mybatisplus.core.toolkit.CollectionUtils;\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\n\nimport java.util.Collections;\nimport java.util.List;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class MyPage<T> extends Page<T> {\n\n    private List<T> records;\n    private long total;\n    private long size;\n    private long current;\n    private String[] ascs;\n    private String[] descs;\n    private boolean optimizeCountSql;\n    private boolean isSearchCount;\n\n    public MyPage() {\n        this.records = Collections.emptyList();\n        this.total = 0L;\n        this.size = 10L;\n        this.current = 1L;\n        this.optimizeCountSql = true;\n        this.isSearchCount = true;\n    }\n\n    public MyPage(long current, long size) {\n        this(current, size, 0L);\n    }\n\n    public MyPage(long current, long size, long total) {\n        this(current, size, total, true);\n    }\n\n    public MyPage(long current, long size, boolean isSearchCount) {\n        this(current, size, 0L, isSearchCount);\n    }\n\n    public MyPage(long current, long size, long total, boolean isSearchCount) {\n        this.records = Collections.emptyList();\n        this.total = 0L;\n        this.size = 10L;\n        this.current = 1L;\n        this.optimizeCountSql = true;\n        this.isSearchCount = true;\n        if (current > 1L) {\n            this.current = current;\n        }\n\n        this.size = size;\n        this.total = total;\n        this.isSearchCount = isSearchCount;\n    }\n\n    public long getPages() {\n        if (this.getSize() == 0L) {\n            return 0L;\n        } else {\n            long pages = this.getTotal() / this.getSize();\n            if (this.getTotal() % this.getSize() != 0L) {\n                ++pages;\n            }\n\n            return pages;\n        }\n    }\n\n    public boolean hasPrevious() {\n        return this.current > 1L;\n    }\n\n    public boolean hasNext() {\n        return this.current < this.getPages();\n    }\n\n    public List<T> getRecords() {\n        return this.records;\n    }\n\n    public Page<T> setRecords(List<T> records) {\n        this.records = records;\n        return this;\n    }\n\n    public long getTotal() {\n        return this.total;\n    }\n\n    public Page<T> setTotal(long total) {\n        this.total = total;\n        return this;\n    }\n\n    public long getSize() {\n        return this.size;\n    }\n\n    public Page<T> setSize(long size) {\n        this.size = size;\n        return this;\n    }\n\n    public long getCurrent() {\n        return this.current;\n    }\n\n    public Page<T> setCurrent(long current) {\n        this.current = current;\n        return this;\n    }\n\n    public String[] ascs() {\n        return this.ascs;\n    }\n\n    public Page<T> setAscs(List<String> ascs) {\n        if (CollectionUtils.isNotEmpty(ascs)) {\n            this.ascs = (String[]) ascs.toArray(new String[0]);\n        }\n\n        return this;\n    }\n\n    public Page<T> setAsc(String... ascs) {\n        this.ascs = ascs;\n        return this;\n    }\n\n    public String[] descs() {\n        return this.descs;\n    }\n\n    public Page<T> setDescs(List<String> descs) {\n        if (CollectionUtils.isNotEmpty(descs)) {\n            this.descs = (String[]) descs.toArray(new String[0]);\n        }\n\n        return this;\n    }\n\n    public Page<T> setDesc(String... descs) {\n        this.descs = descs;\n        return this;\n    }\n\n    public boolean optimizeCountSql() {\n        return this.optimizeCountSql;\n    }\n\n    public boolean isSearchCount() {\n        return this.total < 0L ? false : this.isSearchCount;\n    }\n\n    public Page<T> setSearchCount(boolean isSearchCount) {\n        this.isSearchCount = isSearchCount;\n        return this;\n    }\n\n    public Page<T> setOptimizeCountSql(boolean optimizeCountSql) {\n        this.optimizeCountSql = optimizeCountSql;\n        return this;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/SpecCaptcha.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 166
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\nimport javax.imageio.ImageIO;\nimport java.awt.*;\nimport java.awt.image.BufferedImage;\nimport java.io.IOException;\nimport java.io.OutputStream;\n\nimport static co.yiiu.pybbs.util.captcha.Randoms.num;\n\n/**\n * <p>png</p>\n *\n * @author: wuhongjun\n * @version:1.0\n */\npublic class SpecCaptcha extends Captcha {\n    public SpecCaptcha() {\n    }\n\n    public SpecCaptcha(int width, int height) {\n        this.width = width;\n        this.height = height;\n    }\n\n    public SpecCaptcha(int width, int height, int len) {\n        this(width, height);\n        this.len = len;\n    }\n\n    public SpecCaptcha(int width, int height, int len, Font font) {\n        this(width, height, len);\n        this.font = font;\n    }\n\n    /**\n     * \n     *\n     * @throws java.io.IOException IO\n     */\n    @Override\n    public void out(OutputStream out) {\n        graphicsImage(alphas(), out);\n    }\n\n    /**\n     * \n     *\n     * @param strs \n     * @param out  \n     */\n    private boolean graphicsImage(char[] strs, OutputStream out) {\n        boolean ok = false;\n        try {\n            BufferedImage bi = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);\n            Graphics2D g = (Graphics2D) bi.getGraphics();\n            AlphaComposite ac3;\n            Color color;\n            int len = strs.length;\n            g.setColor(Color.WHITE);\n            g.fillRect(0, 0, width, height);\n            // \n            for (int i = 0; i < 15; i++) {\n                color = color(150, 250);\n                g.setColor(color);\n                g.drawOval(num(width), num(height), 5 + num(10), 5 + num(10));// \n                color = null;\n            }\n            g.setFont(font);\n            int h = height - ((height - font.getSize()) >> 1), w = width / len, size = w - font.getSize() + 1;\n            /*  */\n            for (int i = 0; i < len; i++) {\n                ac3 = AlphaComposite.getInstance(AlphaComposite.SRC_OVER, 0.7f);// \n                g.setComposite(ac3);\n                color = new Color(20 + num(110), 20 + num(110), 20 + num(110));// \n                g.setColor(color);\n                g.drawString(strs[i] + \"\", (width - (len - i) * w) + size, h - 4);\n                color = null;\n                ac3 = null;\n            }\n            ImageIO.write(bi, \"png\", out);\n            out.flush();\n            ok = true;\n        } catch (IOException e) {\n            ok = false;\n        } finally {\n            Streams.close(out);\n        }\n        return ok;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/hook/CommentServiceHook.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 167
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.hook;\n\nimport org.aspectj.lang.annotation.Pointcut;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class CommentServiceHook {\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ICommentService.selectByTopicId(..))\")\n    public void selectByTopicId() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ICommentService.insert(..))\")\n    public void insert() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ICommentService.update(..))\")\n    public void update() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ICommentService.vote(..))\")\n    public void vote() {\n    }\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.service.ICommentService.delete(..))\")\n    public void delete() {\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/OtherTopicDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 168
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.model.Topic;\nimport co.yiiu.pybbs.service.ITopicService;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class OtherTopicDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ITopicService topicService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        Integer userId = Integer.parseInt(map.get(\"userId\").toString());\n        Integer topicId = Integer.parseInt(map.get(\"topicId\").toString());\n        Integer limit = Integer.parseInt(map.get(\"limit\").toString());\n        List<Topic> topics = topicService.selectAuthorOtherTopic(userId, topicId, limit);\n\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"topics\", builder.build().wrap(topics));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/MarkdownUtil.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 169
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util;\n\nimport org.commonmark.Extension;\nimport org.commonmark.ext.autolink.AutolinkExtension;\nimport org.commonmark.ext.gfm.tables.TableBlock;\nimport org.commonmark.ext.gfm.tables.TablesExtension;\nimport org.commonmark.node.Image;\nimport org.commonmark.node.Node;\nimport org.commonmark.parser.Parser;\nimport org.commonmark.renderer.html.AttributeProvider;\nimport org.commonmark.renderer.html.HtmlRenderer;\n\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class MarkdownUtil {\n\n    public static String render(String content) {\n        List<Extension> extensions = Arrays.asList(AutolinkExtension.create(), TablesExtension.create());\n\n        Parser parser = Parser.builder().extensions(extensions).build();\n        // \n        HtmlRenderer renderer = HtmlRenderer.builder().softbreak(\"<br/>\").attributeProviderFactory(context -> new\n                MyAttributeProvider()).extensions(extensions).build();\n        Node document = parser.parse(content == null ? \"\" : content);\n        return renderer.render(document);\n    }\n\n    static class MyAttributeProvider implements AttributeProvider {\n\n        @Override\n        public void setAttributes(Node node, String s, Map<String, String> map) {\n            // css\n            if (node instanceof Image) {\n                map.put(\"class\", \"md-image\");\n            }\n            // css\n            if (node instanceof TableBlock) {\n                map.put(\"class\", \"table table-bordered\");\n            }\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/directive/UserCollectsDirective.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 170
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.directive;\n\nimport co.yiiu.pybbs.model.User;\nimport co.yiiu.pybbs.service.ICollectService;\nimport co.yiiu.pybbs.service.IUserService;\nimport freemarker.core.Environment;\nimport freemarker.template.*;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.io.IOException;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Component\npublic class UserCollectsDirective implements TemplateDirectiveModel {\n\n    @Resource\n    private ICollectService collectService;\n    @Resource\n    private IUserService userService;\n\n    @Override\n    public void execute(Environment environment, Map map, TemplateModel[] templateModels, TemplateDirectiveBody\n            templateDirectiveBody) throws TemplateException, IOException {\n        String username = String.valueOf(map.get(\"username\"));\n        Integer pageNo = Integer.parseInt(map.get(\"pageNo\").toString());\n        User user = userService.selectByUsername(username);\n        DefaultObjectWrapperBuilder builder = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_28);\n        environment.setVariable(\"collects\", builder.build().wrap(collectService.selectByUserId(user.getId(), pageNo,\n                null)));\n        templateDirectiveBody.render(environment.getOut());\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/util/captcha/Encoder.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 171
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.util.captcha;\n\nimport java.io.IOException;\nimport java.io.OutputStream;\n\n/**\n * @author: wuhongjun\n * @version:1.0\n */\npublic class Encoder {\n    private static final int EOF = -1;\n\n    private int imgW, imgH;\n    private byte[] pixAry;\n    private int initCodeSize;\n    private int remaining;\n    private int curPixel;\n\n    // GIFCOMPR.C       - GIF Image compression routines\n    //\n    // Lempel-Ziv compression based on 'compress'.  GIF modifications by\n    // David Rowley (mgardi@watdcsu.waterloo.edu)\n\n    // General DEFINEs\n\n    static final int BITS = 12;\n\n    static final int HSIZE = 5003; // 80% occupancy\n\n    // GIF Image compression - modified 'compress'\n    //\n    // Based on: compress.c - File compression ala IEEE Computer, June 1984.\n    //\n    // By Authors:  Spencer W. Thomas      (decvax!harpo!utah-cs!utah-gr!thomas)\n    //              Jim McKie              (decvax!mcvax!jim)\n    //              Steve Davies           (decvax!vax135!petsd!peora!srd)\n    //              Ken Turkowski          (decvax!decwrl!turtlevax!ken)\n    //              James A. Woods         (decvax!ihnp4!ames!jaw)\n    //              Joe Orost              (decvax!vax135!petsd!joe)\n\n    int n_bits; // number of bits/code\n    int maxbits = BITS; // user settable max # bits/code\n    int maxcode; // maximum code, given n_bits\n    int maxmaxcode = 1 << BITS; // should NEVER generate this code\n\n    int[] htab = new int[HSIZE];\n    int[] codetab = new int[HSIZE];\n\n    int hsize = HSIZE; // for dynamic table sizing\n\n    int free_ent = 0; // first unused entry\n\n    // block compression parameters -- after all codes are used up,\n    // and compression rate changes, start over.\n    boolean clear_flg = false;\n\n    // Algorithm:  use open addressing double hashing (no chaining) on the\n    // prefix code / next character combination.  We do a variant of Knuth's\n    // algorithm D (vol. 3, sec. 6.4) along with G. Knott's relatively-prime\n    // secondary probe.  Here, the modular division first probe is gives way\n    // to a faster exclusive-or manipulation.  Also do block compression with\n    // an adaptive reset, whereby the code table is cleared when the compression\n    // ratio decreases, but after the table fills.  The variable-length output\n    // codes are re-sized at this point, and a special CLEAR code is generated\n    // for the decompressor.  Late addition:  construct the table according to\n    // file size for noticeable speed improvement on small files.  Please direct\n    // questions about this implementation to ames!jaw.\n\n    int g_init_bits;\n\n    int ClearCode;\n    int EOFCode;\n\n    // output\n    //\n    // Output the given code.\n    // Inputs:\n    //      code:   A n_bits-bit integer.  If == -1, then EOF.  This assumes\n    //              that n_bits =< wordsize - 1.\n    // Outputs:\n    //      Outputs code to the file.\n    // Assumptions:\n    //      Chars are 8 bits long.\n    // Algorithm:\n    //      Maintain a BITS character long buffer (so that 8 codes will\n    // fit in it exactly).  Use the VAX insv instruction to insert each\n    // code in turn.  When the buffer fills up empty it and start over.\n\n    int cur_accum = 0;\n    int cur_bits = 0;\n\n    int masks[] = {0x0000, 0x0001, 0x0003, 0x0007, 0x000F, 0x001F, 0x003F, 0x007F, 0x00FF, 0x01FF, 0x03FF, 0x07FF,\n            0x0FFF, 0x1FFF, 0x3FFF, 0x7FFF, 0xFFFF};\n\n    // Number of characters so far in this 'packet'\n    int a_count;\n\n    // Define the storage for the packet accumulator\n    byte[] accum = new byte[256];\n\n    //----------------------------------------------------------------------------\n    Encoder(int width, int height, byte[] pixels, int color_depth) {\n        imgW = width;\n        imgH = height;\n        pixAry = pixels;\n        initCodeSize = Math.max(2, color_depth);\n    }\n\n    // Add a character to the end of the current packet, and if it is 254\n    // characters, flush the packet to disk.\n    void char_out(byte c, OutputStream outs) throws IOException {\n        accum[a_count++] = c;\n        if (a_count >= 254) flush_char(outs);\n    }\n\n    // Clear out the hash table\n\n    // table clear for block compress\n    void cl_block(OutputStream outs) throws IOException {\n        cl_hash(hsize);\n        free_ent = ClearCode + 2;\n        clear_flg = true;\n\n        output(ClearCode, outs);\n    }\n\n    // reset code table\n    void cl_hash(int hsize) {\n        for (int i = 0; i < hsize; ++i)\n            htab[i] = -1;\n    }\n\n    void compress(int init_bits, OutputStream outs) throws IOException {\n        int fcode;\n        int i /* = 0 */;\n        int c;\n        int ent;\n        int disp;\n        int hsize_reg;\n        int hshift;\n\n        // Set up the globals:  g_init_bits - initial number of bits\n        g_init_bits = init_bits;\n\n        // Set up the necessary values\n        clear_flg = false;\n        n_bits = g_init_bits;\n        maxcode = MAXCODE(n_bits);\n\n        ClearCode = 1 << (init_bits - 1);\n        EOFCode = ClearCode + 1;\n        free_ent = ClearCode + 2;\n\n        a_count = 0; // clear packet\n\n        ent = nextPixel();\n\n        hshift = 0;\n        for (fcode = hsize; fcode < 65536; fcode *= 2)\n            ++hshift;\n        hshift = 8 - hshift; // set hash code range bound\n\n        hsize_reg = hsize;\n        cl_hash(hsize_reg); // clear hash table\n\n        output(ClearCode, outs);\n\n        outer_loop:\n        while ((c = nextPixel()) != EOF) {\n            fcode = (c << maxbits) + ent;\n            i = (c << hshift) ^ ent; // xor hashing\n\n            if (htab[i] == fcode) {\n                ent = codetab[i];\n                continue;\n            } else if (htab[i] >= 0) // non-empty slot\n            {\n                disp = hsize_reg - i; // secondary hash (after G. Knott)\n                if (i == 0) disp = 1;\n                do {\n                    if ((i -= disp) < 0) i += hsize_reg;\n\n                    if (htab[i] == fcode) {\n                        ent = codetab[i];\n                        continue outer_loop;\n                    }\n                } while (htab[i] >= 0);\n            }\n            output(ent, outs);\n            ent = c;\n            if (free_ent < maxmaxcode) {\n                codetab[i] = free_ent++; // code -> hashtable\n                htab[i] = fcode;\n            } else cl_block(outs);\n        }\n        // Put out the final code.\n        output(ent, outs);\n        output(EOFCode, outs);\n    }\n\n    //----------------------------------------------------------------------------\n    void encode(OutputStream os) throws IOException {\n        os.write(initCodeSize); // write \"initial code size\" byte\n\n        remaining = imgW * imgH; // reset navigation variables\n        curPixel = 0;\n\n        compress(initCodeSize + 1, os); // compress and write the pixel data\n\n        os.write(0); // write block terminator\n    }\n\n    // Flush the packet to disk, and reset the accumulator\n    void flush_char(OutputStream outs) throws IOException {\n        if (a_count > 0) {\n            outs.write(a_count);\n            outs.write(accum, 0, a_count);\n            a_count = 0;\n        }\n    }\n\n    final int MAXCODE(int n_bits) {\n        return (1 << n_bits) - 1;\n    }\n\n    //----------------------------------------------------------------------------\n    // Return the next pixel from the image\n    //----------------------------------------------------------------------------\n    private int nextPixel() {\n        if (remaining == 0) return EOF;\n\n        --remaining;\n\n        byte pix = pixAry[curPixel++];\n\n        return pix & 0xff;\n    }\n\n    void output(int code, OutputStream outs) throws IOException {\n        cur_accum &= masks[cur_bits];\n\n        if (cur_bits > 0) cur_accum |= (code << cur_bits);\n        else cur_accum = code;\n\n        cur_bits += n_bits;\n\n        while (cur_bits >= 8) {\n            char_out((byte) (cur_accum & 0xff), outs);\n            cur_accum >>= 8;\n            cur_bits -= 8;\n        }\n\n        // If the next entry is going to be too big for the code size,\n        // then increase it, if possible.\n        if (free_ent > maxcode || clear_flg) {\n            if (clear_flg) {\n                maxcode = MAXCODE(n_bits = g_init_bits);\n                clear_flg = false;\n            } else {\n                ++n_bits;\n                if (n_bits == maxbits) maxcode = maxmaxcode;\n                else maxcode = MAXCODE(n_bits);\n            }\n        }\n\n        if (code == EOFCode) {\n            // At EOF, write the rest of the buffer.\n            while (cur_bits > 0) {\n                char_out((byte) (cur_accum & 0xff), outs);\n                cur_accum >>= 8;\n                cur_bits -= 8;\n            }\n\n            flush_char(outs);\n        }\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/service/BaseService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 172
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config.service;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface BaseService<T> {\n\n    // \n    T instance();\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/exception/ApiException.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 173
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.exception;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class ApiException extends RuntimeException {\n\n    private static final long serialVersionUID = 1L;\n    private int code;\n    private String message;\n\n    public ApiException(String message) {\n        this.code = 201;\n        this.message = message;\n    }\n\n    public ApiException(int code, String message) {\n        this.code = code;\n        this.message = message;\n    }\n\n    public int getCode() {\n        return code;\n    }\n\n    public void setCode(int code) {\n        this.code = code;\n    }\n\n    @Override\n    public String getMessage() {\n        return message;\n    }\n\n    public void setMessage(String message) {\n        this.message = message;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/RestTemplateConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 174
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.http.client.SimpleClientHttpRequestFactory;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.client.RestTemplate;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.Resource;\nimport java.net.InetSocketAddress;\nimport java.net.Proxy;\n\n@Component\n@DependsOn(\"mybatisPlusConfig\")\npublic class RestTemplateConfig {\n\n    private String proxyHost;\n    private Integer proxyPort;\n\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    @PostConstruct\n    public void init() {\n        proxyHost = systemConfigService.selectAllConfig().get(\"http_proxy\");\n        String http_proxy_port = systemConfigService.selectAllConfig().get(\"http_proxy_port\");\n        if (!StringUtils.isEmpty(http_proxy_port)) proxyPort = Integer.parseInt(http_proxy_port);\n    }\n\n    @Bean\n    public RestTemplate restTemplate() {\n        SimpleClientHttpRequestFactory requestFactory = new SimpleClientHttpRequestFactory();\n\n        if (!StringUtils.isEmpty(proxyHost) && proxyPort != null) {\n            Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(proxyHost, proxyPort));\n            requestFactory.setProxy(proxy);\n        }\n\n        return new RestTemplate(requestFactory);\n    }\n\n}"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/hook/FileUtilHook.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 175
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.hook;\n\nimport org.aspectj.lang.annotation.Pointcut;\n\npublic class FileUtilHook {\n\n    @Pointcut(\"execution(public * co.yiiu.pybbs.util.FileUtil.upload(..))\")\n    public void upload() {\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/model/Collect.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 176
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.model;\n\nimport java.io.Serializable;\nimport java.util.Date;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic class Collect implements Serializable {\n\n    private static final long serialVersionUID = 7610730966340643542L;\n    private Integer topicId;\n    private Integer userId;\n    private Date inTime;\n\n    public Integer getTopicId() {\n        return topicId;\n    }\n\n    public void setTopicId(Integer topicId) {\n        this.topicId = topicId;\n    }\n\n    public Integer getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Integer userId) {\n        this.userId = userId;\n    }\n\n    public Date getInTime() {\n        return inTime;\n    }\n\n    public void setInTime(Date inTime) {\n        this.inTime = inTime;\n    }\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/ShiroConfig.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 177
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.config;\n\nimport co.yiiu.pybbs.config.realm.MyCredentialsMatcher;\nimport co.yiiu.pybbs.config.realm.MyShiroRealm;\nimport co.yiiu.pybbs.service.ISystemConfigService;\nimport org.apache.shiro.codec.Base64;\nimport org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor;\nimport org.apache.shiro.spring.web.ShiroFilterFactoryBean;\nimport org.apache.shiro.web.filter.authc.FormAuthenticationFilter;\nimport org.apache.shiro.web.mgt.CookieRememberMeManager;\nimport org.apache.shiro.web.mgt.DefaultWebSecurityManager;\nimport org.apache.shiro.web.servlet.SimpleCookie;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator;\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.DependsOn;\n\nimport javax.annotation.Resource;\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\n@Configuration\npublic class ShiroConfig {\n\n    private final Logger log = LoggerFactory.getLogger(ShiroConfig.class);\n\n    @Resource\n    private MyShiroRealm myShiroRealm;\n    @Resource\n    private ISystemConfigService systemConfigService;\n\n    @Bean\n    public ShiroFilterFactoryBean shiroFilterFactoryBean(DefaultWebSecurityManager defaultWebSecurityManager) {\n        log.info(\"shiroFilter...\");\n        ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean();\n        shiroFilterFactoryBean.setSecurityManager(defaultWebSecurityManager);\n\n        //.\n        Map<String, String> map = new HashMap<>();\n\n        //    \n        map.put(\"/static/**\", \"anon\");\n        // shiro\n        map.put(\"/admin/login\", \"anon\");\n        map.put(\"/admin/logout\", \"anon\");\n        map.put(\"/admin/no_auth\", \"anon\");\n\n        //<!-- /** -->:;\n\n        //<!-- authc:url; user: rememberMe anon:url {@link org.apache.shiro.web.filter.mgt.DefaultFilter}-->\n        map.put(\"/admin/permission/**\", \"perms\");\n        map.put(\"/admin/role/**\", \"perms\");\n        map.put(\"/admin/system/**\", \"perms\");\n        map.put(\"/admin/admin_user/**\", \"perms\");\n\n        map.put(\"/admin/**\", \"user\");\n//        map.put(\"/admin/comment/**\", \"user\");\n//        map.put(\"/admin/sensitive_word/**\", \"user\");\n//        map.put(\"/admin/tag/**\", \"user\");\n//        map.put(\"/admin/topic/**\", \"user\");\n//        map.put(\"/admin/user/**\", \"user\");\n\n        shiroFilterFactoryBean.setFilterChainDefinitionMap(map);\n\n        // Web\"/login.jsp\"\n        shiroFilterFactoryBean.setLoginUrl(\"/adminlogin\");\n        // \n        shiroFilterFactoryBean.setSuccessUrl(\"/admin/index\");\n\n        //;\n        shiroFilterFactoryBean.setUnauthorizedUrl(\"/admin/no_auth\");\n\n        return shiroFilterFactoryBean;\n    }\n\n    // \n    // \n    @Bean\n    public MyCredentialsMatcher myCredentialsMatcher() {\n        return new MyCredentialsMatcher();\n    }\n\n    // \n    @Bean\n    public DefaultWebSecurityManager defaultWebSecurityManager() {\n        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();\n        myShiroRealm.setCredentialsMatcher(myCredentialsMatcher());\n        securityManager.setRealm(myShiroRealm);\n        securityManager.setRememberMeManager(rememberMeManager());\n        return securityManager;\n    }\n\n    //\n    @Bean\n    public AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor(DefaultWebSecurityManager defaultWebSecurityManager) {\n        AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor = new AuthorizationAttributeSourceAdvisor();\n        authorizationAttributeSourceAdvisor.setSecurityManager(defaultWebSecurityManager);\n        return authorizationAttributeSourceAdvisor;\n    }\n\n    // \n    @Bean\n    @DependsOn(\"mybatisPlusConfig\")\n    public SimpleCookie rememberMeCookie() {\n        //cookiecheckboxname = rememberMe\n        SimpleCookie simpleCookie = new SimpleCookie(\"rememberMe\");\n        // cookie \n        int adminRememberMeMaxAge = Integer.parseInt(systemConfigService.selectAllConfig().get(\"admin_remember_me_max_age\").toString());\n        simpleCookie.setMaxAge(adminRememberMeMaxAge * 24 * 60 * 60);\n        return simpleCookie;\n    }\n\n    @Bean\n    @DependsOn(\"mybatisPlusConfig\")\n    public CookieRememberMeManager rememberMeManager() {\n        //System.out.println(\"ShiroConfiguration.rememberMeManager()\");\n        CookieRememberMeManager cookieRememberMeManager = new CookieRememberMeManager();\n        cookieRememberMeManager.setCookie(rememberMeCookie());\n        //rememberMe cookie  AES (128 256 512 )\n        cookieRememberMeManager.setCipherKey(Base64.encode(\"pybbs is the best!\".getBytes()));\n        return cookieRememberMeManager;\n    }\n\n    @Bean\n    public FormAuthenticationFilter formAuthenticationFilter() {\n        FormAuthenticationFilter formAuthenticationFilter = new FormAuthenticationFilter();\n        //checkboxname = rememberMe\n        formAuthenticationFilter.setRememberMeParam(\"rememberMe\");\n        return formAuthenticationFilter;\n    }\n\n    @Bean\n    @ConditionalOnMissingBean\n    public DefaultAdvisorAutoProxyCreator defaultAdvisorAutoProxyCreator() {\n        DefaultAdvisorAutoProxyCreator defaultAAP = new DefaultAdvisorAutoProxyCreator();\n        defaultAAP.setProxyTargetClass(true);\n        return defaultAAP;\n    }\n\n}\n"
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/mapper/CollectMapper.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 178
      },
      "contents" : {
        "text" : "package co.yiiu.pybbs.mapper;\n\nimport co.yiiu.pybbs.model.Collect;\nimport co.yiiu.pybbs.util.MyPage;\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Param;\n\nimport java.util.Map;\n\n/**\n * Created by tomoya.\n * Copyright (c) 2018, All Rights Reserved.\n * https://atjiu.github.io\n */\npublic interface CollectMapper extends BaseMapper<Collect> {\n\n    MyPage<Map<String, Object>> selectByUserId(MyPage<Map<String, Object>> iPage, @Param(\"userId\") Integer userId);\n}\n"
      }
    }, {
      "location" : {
        "uri" : "plugins/redis-cache-plugin/src/main/java/co/yiiu/pybbs/plugin/RedisCachePlugin.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 179
      }
    }, {
      "location" : {
        "uri" : "plugins/comment-layer-plugin/src/main/java/co/yiiu/pybbs/plugin/CommentLayerPlugin.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 180
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/GlobalCorsConfiguration.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 181
      }
    }, {
      "location" : {
        "uri" : "plugins/redis-cache-plugin/src/main/java/co/yiiu/pybbs/plugin/RedisService.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 182
      }
    }, {
      "location" : {
        "uri" : "src/main/java/co/yiiu/pybbs/config/realm/MyShiroFilter.java",
        "uriBaseId" : "%SRCROOT%",
        "index" : 183
      }
    }, {
      "location" : {
        "uri" : "src/main/resources/static/theme/default/js/app.js",
        "uriBaseId" : "%SRCROOT%",
        "index" : 184
      }
    } ],
    "results" : [ {
      "ruleId" : "java/insecure-cookie",
      "ruleIndex" : 1,
      "rule" : {
        "id" : "java/insecure-cookie",
        "index" : 1
      },
      "message" : {
        "text" : "Cookie is added to response without the 'secure' flag being set."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/CookieUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 0
          },
          "region" : {
            "startLine" : 34,
            "startColumn" : 9,
            "endColumn" : 35
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "f118e1b690a90c5d:1",
        "primaryLocationStartColumnFingerprint" : "0"
      }
    }, {
      "ruleId" : "java/insecure-cookie",
      "ruleIndex" : 1,
      "rule" : {
        "id" : "java/insecure-cookie",
        "index" : 1
      },
      "message" : {
        "text" : "Cookie is added to response without the 'secure' flag being set."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/CookieUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 0
          },
          "region" : {
            "startLine" : 62,
            "startColumn" : 9,
            "endColumn" : 35
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "349f4d0851059841:1",
        "primaryLocationStartColumnFingerprint" : "0"
      }
    }, {
      "ruleId" : "java/path-injection",
      "ruleIndex" : 12,
      "rule" : {
        "id" : "java/path-injection",
        "index" : 12
      },
      "message" : {
        "text" : "This path depends on a [user-provided value](1)."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 1
          },
          "region" : {
            "startLine" : 84,
            "startColumn" : 26,
            "endColumn" : 45
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "6f214dc25d0690b2:1",
        "primaryLocationStartColumnFingerprint" : "13"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 1
                },
                "region" : {
                  "startLine" : 77,
                  "startColumn" : 58,
                  "endColumn" : 79
                }
              },
              "message" : {
                "text" : "getContentType(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 1
                },
                "region" : {
                  "startLine" : 77,
                  "startColumn" : 35,
                  "endColumn" : 80
                }
              },
              "message" : {
                "text" : "requireNonNull(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 1
                },
                "region" : {
                  "startLine" : 77,
                  "startColumn" : 35,
                  "endColumn" : 91
                }
              },
              "message" : {
                "text" : "split(...) : String[]"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 1
                },
                "region" : {
                  "startLine" : 84,
                  "startColumn" : 35,
                  "endColumn" : 44
                }
              },
              "message" : {
                "text" : "localPath"
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 1
          },
          "region" : {
            "startLine" : 77,
            "startColumn" : 58,
            "endColumn" : 79
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      } ]
    }, {
      "ruleId" : "java/path-injection",
      "ruleIndex" : 12,
      "rule" : {
        "id" : "java/path-injection",
        "index" : 12
      },
      "message" : {
        "text" : "This path depends on a [user-provided value](1)."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 2
          },
          "region" : {
            "startLine" : 98,
            "startColumn" : 25,
            "endColumn" : 119
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "4bffa59a03ea6855:1",
        "primaryLocationStartColumnFingerprint" : "12"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 89,
                  "startColumn" : 28,
                  "endColumn" : 65
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 27,
                  "endColumn" : 31
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 27,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "get(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 106,
                  "startColumn" : 36,
                  "endColumn" : 44
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 4
                },
                "region" : {
                  "startLine" : 92,
                  "startColumn" : 25,
                  "endColumn" : 40
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 4
                },
                "region" : {
                  "startLine" : 100,
                  "startColumn" : 58,
                  "endColumn" : 66
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 87,
                  "startColumn" : 29,
                  "endColumn" : 44
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 91,
                  "startColumn" : 25,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 94,
                  "startColumn" : 28,
                  "endColumn" : 43
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 98,
                  "startColumn" : 34,
                  "endColumn" : 118
                }
              },
              "message" : {
                "text" : "... + ..."
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 3
          },
          "region" : {
            "startLine" : 89,
            "startColumn" : 28,
            "endColumn" : 65
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      } ]
    }, {
      "ruleId" : "java/path-injection",
      "ruleIndex" : 12,
      "rule" : {
        "id" : "java/path-injection",
        "index" : 12
      },
      "message" : {
        "text" : "This path depends on a [user-provided value](1)."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 2
          },
          "region" : {
            "startLine" : 100,
            "startColumn" : 26,
            "endColumn" : 131
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "894fd6ecf1bdc229:1",
        "primaryLocationStartColumnFingerprint" : "13"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 89,
                  "startColumn" : 28,
                  "endColumn" : 65
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 27,
                  "endColumn" : 31
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 27,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "get(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 106,
                  "startColumn" : 36,
                  "endColumn" : 44
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 4
                },
                "region" : {
                  "startLine" : 92,
                  "startColumn" : 25,
                  "endColumn" : 40
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 4
                },
                "region" : {
                  "startLine" : 100,
                  "startColumn" : 58,
                  "endColumn" : 66
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 87,
                  "startColumn" : 29,
                  "endColumn" : 44
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 91,
                  "startColumn" : 25,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 94,
                  "startColumn" : 28,
                  "endColumn" : 43
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 100,
                  "startColumn" : 35,
                  "endColumn" : 130
                }
              },
              "message" : {
                "text" : "... + ..."
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 3
          },
          "region" : {
            "startLine" : 89,
            "startColumn" : 28,
            "endColumn" : 65
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      } ]
    }, {
      "ruleId" : "java/path-injection",
      "ruleIndex" : 12,
      "rule" : {
        "id" : "java/path-injection",
        "index" : 12
      },
      "message" : {
        "text" : "This path depends on a [user-provided value](1)."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 2
          },
          "region" : {
            "startLine" : 101,
            "startColumn" : 34,
            "endColumn" : 39
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "2e57a836b37c6102:1",
        "primaryLocationStartColumnFingerprint" : "21"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 89,
                  "startColumn" : 28,
                  "endColumn" : 65
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 27,
                  "endColumn" : 31
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 27,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "get(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 3
                },
                "region" : {
                  "startLine" : 106,
                  "startColumn" : 36,
                  "endColumn" : 44
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 4
                },
                "region" : {
                  "startLine" : 92,
                  "startColumn" : 25,
                  "endColumn" : 40
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 4
                },
                "region" : {
                  "startLine" : 100,
                  "startColumn" : 58,
                  "endColumn" : 66
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 87,
                  "startColumn" : 29,
                  "endColumn" : 44
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 91,
                  "startColumn" : 25,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 94,
                  "startColumn" : 28,
                  "endColumn" : 43
                }
              },
              "message" : {
                "text" : "username : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 100,
                  "startColumn" : 35,
                  "endColumn" : 130
                }
              },
              "message" : {
                "text" : "... + ... : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 100,
                  "startColumn" : 26,
                  "endColumn" : 131
                }
              },
              "message" : {
                "text" : "new File(...) : File"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/identicon/Identicon.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 2
                },
                "region" : {
                  "startLine" : 101,
                  "startColumn" : 34,
                  "endColumn" : 39
                }
              },
              "message" : {
                "text" : "file1"
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/controller/api/IndexApiController.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 3
          },
          "region" : {
            "startLine" : 89,
            "startColumn" : 28,
            "endColumn" : 65
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      } ]
    }, {
      "ruleId" : "java/weak-cryptographic-algorithm",
      "ruleIndex" : 21,
      "rule" : {
        "id" : "java/weak-cryptographic-algorithm",
        "index" : 21
      },
      "message" : {
        "text" : "Cryptographic algorithm [MD5](1) is weak and should not be used."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 1
          },
          "region" : {
            "startLine" : 44,
            "startColumn" : 22,
            "endColumn" : 54
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "e90360e3826b5fbc:1",
        "primaryLocationStartColumnFingerprint" : "9"
      },
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/FileUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 1
          },
          "region" : {
            "startLine" : 44,
            "startColumn" : 48,
            "endColumn" : 53
          }
        },
        "message" : {
          "text" : "MD5"
        }
      } ]
    }, {
      "ruleId" : "java/weak-cryptographic-algorithm",
      "ruleIndex" : 21,
      "rule" : {
        "id" : "java/weak-cryptographic-algorithm",
        "index" : 21
      },
      "message" : {
        "text" : "Cryptographic algorithm [MD5](1) is weak and should not be used."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 5
          },
          "region" : {
            "startLine" : 39,
            "startColumn" : 32,
            "endColumn" : 68
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "80309bd255f1f10e:1",
        "primaryLocationStartColumnFingerprint" : "19"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 18,
                  "startColumn" : 21,
                  "endColumn" : 26
                }
              },
              "message" : {
                "text" : "\"MD5\" : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 37,
                  "startColumn" : 31,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "algorithm : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 39,
                  "startColumn" : 58,
                  "endColumn" : 67
                }
              },
              "message" : {
                "text" : "algorithm"
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 5
          },
          "region" : {
            "startLine" : 18,
            "startColumn" : 21,
            "endColumn" : 26
          }
        },
        "message" : {
          "text" : "MD5"
        }
      } ]
    }, {
      "ruleId" : "java/weak-cryptographic-algorithm",
      "ruleIndex" : 21,
      "rule" : {
        "id" : "java/weak-cryptographic-algorithm",
        "index" : 21
      },
      "message" : {
        "text" : "Cryptographic algorithm [MD5](1) is weak and should not be used."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/MD5Util.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 6
          },
          "region" : {
            "startLine" : 29,
            "startColumn" : 29,
            "endColumn" : 61
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "cf7fcad703c8a03e:1",
        "primaryLocationStartColumnFingerprint" : "16"
      },
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/MD5Util.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 6
          },
          "region" : {
            "startLine" : 29,
            "startColumn" : 55,
            "endColumn" : 60
          }
        },
        "message" : {
          "text" : "MD5"
        }
      } ]
    }, {
      "ruleId" : "java/weak-cryptographic-algorithm",
      "ruleIndex" : 21,
      "rule" : {
        "id" : "java/weak-cryptographic-algorithm",
        "index" : 21
      },
      "message" : {
        "text" : "Cryptographic algorithm [MD5](1) is weak and should not be used."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/MD5Util.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 6
          },
          "region" : {
            "startLine" : 119,
            "startColumn" : 48,
            "endColumn" : 80
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "a254a2528e6d2e69:1",
        "primaryLocationStartColumnFingerprint" : "35"
      },
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/MD5Util.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 6
          },
          "region" : {
            "startLine" : 119,
            "startColumn" : 74,
            "endColumn" : 79
          }
        },
        "message" : {
          "text" : "MD5"
        }
      } ]
    }, {
      "ruleId" : "java/regex-injection",
      "ruleIndex" : 30,
      "rule" : {
        "id" : "java/regex-injection",
        "index" : 30
      },
      "message" : {
        "text" : "This regular expression is constructed from a [user-provided value](1).\nThis regular expression is constructed from a [user-provided value](2).\nThis regular expression is constructed from a [user-provided value](3).\nThis regular expression is constructed from a [user-provided value](4)."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 7
          },
          "region" : {
            "startLine" : 193,
            "startColumn" : 46,
            "endColumn" : 50
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "5040f5ab76e4555f:1",
        "primaryLocationStartColumnFingerprint" : "33"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 64,
                  "startColumn" : 52,
                  "endColumn" : 89
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 66,
                  "startColumn" : 26,
                  "endColumn" : 30
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 66,
                  "startColumn" : 26,
                  "endColumn" : 45
                }
              },
              "message" : {
                "text" : "get(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 72,
                  "startColumn" : 28,
                  "endColumn" : 35
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 75,
                  "startColumn" : 28,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 76,
                  "startColumn" : 24,
                  "endColumn" : 31
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 76,
                  "startColumn" : 9,
                  "endColumn" : 13
                }
              },
              "message" : {
                "text" : "this [post update] : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 72,
                  "startColumn" : 9,
                  "endColumn" : 16
                }
              },
              "message" : {
                "text" : "comment [post update] : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 74,
                  "startColumn" : 67,
                  "endColumn" : 74
                }
              },
              "message" : {
                "text" : "comment : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 71,
                  "startColumn" : 19,
                  "endColumn" : 29
                }
              },
              "message" : {
                "text" : "parameter this : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 72,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "this <.field> : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 72,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 74,
                  "startColumn" : 67,
                  "endColumn" : 87
                }
              },
              "message" : {
                "text" : "getContent(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 184,
                  "startColumn" : 47,
                  "endColumn" : 57
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 44,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 116,
                  "startColumn" : 48,
                  "endColumn" : 58
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 67
                }
              },
              "message" : {
                "text" : "substring(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 17,
                  "endColumn" : 34
                }
              },
              "message" : {
                "text" : "sensitiveWordList [post update] : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 128,
                  "startColumn" : 16,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "sensitiveWordList : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 27,
                  "endColumn" : 59
                }
              },
              "message" : {
                "text" : "getSensitiveWord(...) : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 40
                }
              },
              "message" : {
                "text" : "set : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 51
                }
              },
              "message" : {
                "text" : "iterator(...) : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 28
                }
              },
              "message" : {
                "text" : "iterator : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 35
                }
              },
              "message" : {
                "text" : "next(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 193,
                  "startColumn" : 46,
                  "endColumn" : 50
                }
              },
              "message" : {
                "text" : "word"
              }
            }
          } ]
        } ]
      }, {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 37,
                  "startColumn" : 26,
                  "endColumn" : 63
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 40,
                  "startColumn" : 26,
                  "endColumn" : 30
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 40,
                  "startColumn" : 26,
                  "endColumn" : 45
                }
              },
              "message" : {
                "text" : "get(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 51,
                  "startColumn" : 28,
                  "endColumn" : 35
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 75,
                  "startColumn" : 28,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 76,
                  "startColumn" : 24,
                  "endColumn" : 31
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 76,
                  "startColumn" : 9,
                  "endColumn" : 13
                }
              },
              "message" : {
                "text" : "this [post update] : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 51,
                  "startColumn" : 9,
                  "endColumn" : 16
                }
              },
              "message" : {
                "text" : "comment [post update] : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 55,
                  "startColumn" : 41,
                  "endColumn" : 48
                }
              },
              "message" : {
                "text" : "comment : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CommentService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 10
                },
                "region" : {
                  "startLine" : 87,
                  "startColumn" : 27,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "comment : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/CommentService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 10
                },
                "region" : {
                  "startLine" : 168,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "comment : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 55,
                  "startColumn" : 19,
                  "endColumn" : 62
                }
              },
              "message" : {
                "text" : "insert(...) : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 57,
                  "startColumn" : 67,
                  "endColumn" : 74
                }
              },
              "message" : {
                "text" : "comment : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 71,
                  "startColumn" : 19,
                  "endColumn" : 29
                }
              },
              "message" : {
                "text" : "parameter this : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 72,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "this <.field> : Comment [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Comment.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 9
                },
                "region" : {
                  "startLine" : 72,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 8
                },
                "region" : {
                  "startLine" : 57,
                  "startColumn" : 67,
                  "endColumn" : 87
                }
              },
              "message" : {
                "text" : "getContent(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 184,
                  "startColumn" : 47,
                  "endColumn" : 57
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 44,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 116,
                  "startColumn" : 48,
                  "endColumn" : 58
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 67
                }
              },
              "message" : {
                "text" : "substring(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 17,
                  "endColumn" : 34
                }
              },
              "message" : {
                "text" : "sensitiveWordList [post update] : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 128,
                  "startColumn" : 16,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "sensitiveWordList : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 27,
                  "endColumn" : 59
                }
              },
              "message" : {
                "text" : "getSensitiveWord(...) : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 40
                }
              },
              "message" : {
                "text" : "set : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 51
                }
              },
              "message" : {
                "text" : "iterator(...) : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 28
                }
              },
              "message" : {
                "text" : "iterator : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 35
                }
              },
              "message" : {
                "text" : "next(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 193,
                  "startColumn" : 46,
                  "endColumn" : 50
                }
              },
              "message" : {
                "text" : "word"
              }
            }
          } ]
        } ]
      }, {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 103,
                  "startColumn" : 50,
                  "endColumn" : 87
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 106,
                  "startColumn" : 26,
                  "endColumn" : 30
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 106,
                  "startColumn" : 26,
                  "endColumn" : 45
                }
              },
              "message" : {
                "text" : "get(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 112,
                  "startColumn" : 26,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 83,
                  "startColumn" : 28,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 84,
                  "startColumn" : 24,
                  "endColumn" : 31
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 84,
                  "startColumn" : 9,
                  "endColumn" : 13
                }
              },
              "message" : {
                "text" : "this [post update] : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 112,
                  "startColumn" : 9,
                  "endColumn" : 14
                }
              },
              "message" : {
                "text" : "topic [post update] : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 115,
                  "startColumn" : 65,
                  "endColumn" : 70
                }
              },
              "message" : {
                "text" : "topic : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 79,
                  "startColumn" : 19,
                  "endColumn" : 29
                }
              },
              "message" : {
                "text" : "parameter this : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "this <.field> : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 115,
                  "startColumn" : 65,
                  "endColumn" : 83
                }
              },
              "message" : {
                "text" : "getContent(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 184,
                  "startColumn" : 47,
                  "endColumn" : 57
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 44,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 116,
                  "startColumn" : 48,
                  "endColumn" : 58
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 67
                }
              },
              "message" : {
                "text" : "substring(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 17,
                  "endColumn" : 34
                }
              },
              "message" : {
                "text" : "sensitiveWordList [post update] : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 128,
                  "startColumn" : 16,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "sensitiveWordList : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 27,
                  "endColumn" : 59
                }
              },
              "message" : {
                "text" : "getSensitiveWord(...) : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 40
                }
              },
              "message" : {
                "text" : "set : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 51
                }
              },
              "message" : {
                "text" : "iterator(...) : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 28
                }
              },
              "message" : {
                "text" : "iterator : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 35
                }
              },
              "message" : {
                "text" : "next(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 193,
                  "startColumn" : 46,
                  "endColumn" : 50
                }
              },
              "message" : {
                "text" : "word"
              }
            }
          } ]
        } ]
      }, {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 26,
                  "endColumn" : 63
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 84,
                  "startColumn" : 26,
                  "endColumn" : 30
                }
              },
              "message" : {
                "text" : "body : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 84,
                  "startColumn" : 26,
                  "endColumn" : 45
                }
              },
              "message" : {
                "text" : "get(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 96,
                  "startColumn" : 50,
                  "endColumn" : 57
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 13
                },
                "region" : {
                  "startLine" : 101,
                  "startColumn" : 39,
                  "endColumn" : 53
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 13
                },
                "region" : {
                  "startLine" : 105,
                  "startColumn" : 26,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 83,
                  "startColumn" : 28,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 84,
                  "startColumn" : 24,
                  "endColumn" : 31
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 84,
                  "startColumn" : 9,
                  "endColumn" : 13
                }
              },
              "message" : {
                "text" : "this [post update] : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 13
                },
                "region" : {
                  "startLine" : 105,
                  "startColumn" : 9,
                  "endColumn" : 14
                }
              },
              "message" : {
                "text" : "topic [post update] : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/service/impl/TopicService.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 13
                },
                "region" : {
                  "startLine" : 125,
                  "startColumn" : 16,
                  "endColumn" : 21
                }
              },
              "message" : {
                "text" : "topic : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 96,
                  "startColumn" : 23,
                  "endColumn" : 69
                }
              },
              "message" : {
                "text" : "insert(...) : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 97,
                  "startColumn" : 65,
                  "endColumn" : 70
                }
              },
              "message" : {
                "text" : "topic : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 79,
                  "startColumn" : 19,
                  "endColumn" : 29
                }
              },
              "message" : {
                "text" : "parameter this : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "this <.field> : Topic [content] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/model/Topic.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 12
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 16,
                  "endColumn" : 23
                }
              },
              "message" : {
                "text" : "content : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 11
                },
                "region" : {
                  "startLine" : 97,
                  "startColumn" : 65,
                  "endColumn" : 83
                }
              },
              "message" : {
                "text" : "getContent(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 184,
                  "startColumn" : 47,
                  "endColumn" : 57
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 44,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 116,
                  "startColumn" : 48,
                  "endColumn" : 58
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 42
                }
              },
              "message" : {
                "text" : "txt : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 39,
                  "endColumn" : 67
                }
              },
              "message" : {
                "text" : "substring(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 123,
                  "startColumn" : 17,
                  "endColumn" : 34
                }
              },
              "message" : {
                "text" : "sensitiveWordList [post update] : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 128,
                  "startColumn" : 16,
                  "endColumn" : 33
                }
              },
              "message" : {
                "text" : "sensitiveWordList : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 188,
                  "startColumn" : 27,
                  "endColumn" : 59
                }
              },
              "message" : {
                "text" : "getSensitiveWord(...) : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 40
                }
              },
              "message" : {
                "text" : "set : HashSet [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 189,
                  "startColumn" : 37,
                  "endColumn" : 51
                }
              },
              "message" : {
                "text" : "iterator(...) : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 28
                }
              },
              "message" : {
                "text" : "iterator : Iterator [<element>] : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 192,
                  "startColumn" : 20,
                  "endColumn" : 35
                }
              },
              "message" : {
                "text" : "next(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/SensitiveWordUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 7
                },
                "region" : {
                  "startLine" : 193,
                  "startColumn" : 46,
                  "endColumn" : 50
                }
              },
              "message" : {
                "text" : "word"
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 8
          },
          "region" : {
            "startLine" : 64,
            "startColumn" : 52,
            "endColumn" : 89
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      }, {
        "id" : 2,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/controller/api/CommentApiController.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 8
          },
          "region" : {
            "startLine" : 37,
            "startColumn" : 26,
            "endColumn" : 63
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      }, {
        "id" : 3,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 11
          },
          "region" : {
            "startLine" : 103,
            "startColumn" : 50,
            "endColumn" : 87
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      }, {
        "id" : 4,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/controller/api/TopicApiController.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 11
          },
          "region" : {
            "startLine" : 80,
            "startColumn" : 26,
            "endColumn" : 63
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      } ]
    }, {
      "ruleId" : "java/uncontrolled-arithmetic",
      "ruleIndex" : 61,
      "rule" : {
        "id" : "java/uncontrolled-arithmetic",
        "index" : 61
      },
      "message" : {
        "text" : "This arithmetic expression depends on an [uncontrolled value](1), potentially causing an overflow."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 5
          },
          "region" : {
            "startLine" : 48,
            "startColumn" : 47,
            "endColumn" : 63
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "3861af2ed9b76d58:1",
        "primaryLocationStartColumnFingerprint" : "38"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 65,
                  "startColumn" : 26,
                  "endColumn" : 30
                }
              },
              "message" : {
                "text" : "salt : byte[]"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 66,
                  "startColumn" : 22,
                  "endColumn" : 26
                }
              },
              "message" : {
                "text" : "salt : byte[]"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 47,
                  "startColumn" : 33,
                  "endColumn" : 45
                }
              },
              "message" : {
                "text" : "bytes : byte[]"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 48,
                  "startColumn" : 47,
                  "endColumn" : 59
                }
              },
              "message" : {
                "text" : "bytes.length"
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 5
          },
          "region" : {
            "startLine" : 65,
            "startColumn" : 26,
            "endColumn" : 30
          }
        },
        "message" : {
          "text" : "uncontrolled value"
        }
      } ]
    }, {
      "ruleId" : "java/potentially-weak-cryptographic-algorithm",
      "ruleIndex" : 77,
      "rule" : {
        "id" : "java/potentially-weak-cryptographic-algorithm",
        "index" : 77
      },
      "message" : {
        "text" : "Cryptographic algorithm [SHA-1](1) may not be secure, consider using a different algorithm.\nCryptographic algorithm [SHA-384](2) may not be secure, consider using a different algorithm."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 5
          },
          "region" : {
            "startLine" : 39,
            "startColumn" : 32,
            "endColumn" : 68
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "80309bd255f1f10e:1",
        "primaryLocationStartColumnFingerprint" : "19"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 22,
                  "startColumn" : 21,
                  "endColumn" : 28
                }
              },
              "message" : {
                "text" : "\"SHA-1\" : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 37,
                  "startColumn" : 31,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "algorithm : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 39,
                  "startColumn" : 58,
                  "endColumn" : 67
                }
              },
              "message" : {
                "text" : "algorithm"
              }
            }
          } ]
        } ]
      }, {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 30,
                  "startColumn" : 21,
                  "endColumn" : 30
                }
              },
              "message" : {
                "text" : "\"SHA-384\" : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 37,
                  "startColumn" : 31,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "algorithm : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 5
                },
                "region" : {
                  "startLine" : 39,
                  "startColumn" : 58,
                  "endColumn" : 67
                }
              },
              "message" : {
                "text" : "algorithm"
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 5
          },
          "region" : {
            "startLine" : 22,
            "startColumn" : 21,
            "endColumn" : 28
          }
        },
        "message" : {
          "text" : "SHA-1"
        }
      }, {
        "id" : 2,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/HashUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 5
          },
          "region" : {
            "startLine" : 30,
            "startColumn" : 21,
            "endColumn" : 30
          }
        },
        "message" : {
          "text" : "SHA-384"
        }
      } ]
    }, {
      "ruleId" : "java/trust-boundary-violation",
      "ruleIndex" : 83,
      "rule" : {
        "id" : "java/trust-boundary-violation",
        "index" : 83
      },
      "message" : {
        "text" : "This servlet reads data from a remote source and writes it to a session variable."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/service/impl/UserService.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 4
          },
          "region" : {
            "startLine" : 206,
            "startColumn" : 39,
            "endColumn" : 43
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "9a3825a701d525f1:1",
        "primaryLocationStartColumnFingerprint" : "30"
      }
    }, {
      "ruleId" : "java/log-injection",
      "ruleIndex" : 87,
      "rule" : {
        "id" : "java/log-injection",
        "index" : 87
      },
      "message" : {
        "text" : "This log entry depends on a [user-provided value](1).\nThis log entry depends on a [user-provided value](2).\nThis log entry depends on a [user-provided value](3).\nThis log entry depends on a [user-provided value](4).\nThis log entry depends on a [user-provided value](5)."
      },
      "locations" : [ {
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 14
          },
          "region" : {
            "startLine" : 90,
            "startColumn" : 18,
            "endColumn" : 38
          }
        }
      } ],
      "partialFingerprints" : {
        "primaryLocationLineHash" : "a0b32f79942981c1:1",
        "primaryLocationStartColumnFingerprint" : "9"
      },
      "codeFlows" : [ {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 75,
                  "startColumn" : 29,
                  "endColumn" : 52
                }
              },
              "message" : {
                "text" : "getRequestURI(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 78,
                  "startColumn" : 55,
                  "endColumn" : 65
                }
              },
              "message" : {
                "text" : "actionName : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 78,
                  "startColumn" : 9,
                  "endColumn" : 47
                }
              },
              "message" : {
                "text" : "append(...) [post update] : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 27
                }
              },
              "message" : {
                "text" : "logString : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 38
                }
              },
              "message" : {
                "text" : "toString(...)"
              }
            }
          } ]
        } ]
      }, {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 79,
                  "startColumn" : 40,
                  "endColumn" : 65
                }
              },
              "message" : {
                "text" : "getParameterMap(...) : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 9,
                  "endColumn" : 15
                }
              },
              "message" : {
                "text" : "params : Map"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 24,
                  "endLine" : 87,
                  "endColumn" : 10
                }
              },
              "message" : {
                "text" : "...->... [post update] : new BiConsumer<String,String[]>(...) { ... } [StringBuilder logString] : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 80,
                  "startColumn" : 24,
                  "endLine" : 87,
                  "endColumn" : 10
                }
              },
              "message" : {
                "text" : "StringBuilder logString : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 27
                }
              },
              "message" : {
                "text" : "logString : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 38
                }
              },
              "message" : {
                "text" : "toString(...)"
              }
            }
          } ]
        } ]
      }, {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 15
                },
                "region" : {
                  "startLine" : 10,
                  "startColumn" : 21,
                  "endColumn" : 57
                }
              },
              "message" : {
                "text" : "getHeader(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 15
                },
                "region" : {
                  "startLine" : 23,
                  "startColumn" : 16,
                  "endColumn" : 18
                }
              },
              "message" : {
                "text" : "ip : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 76,
                  "startColumn" : 27,
                  "endColumn" : 52
                }
              },
              "message" : {
                "text" : "getIpAddr(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 78,
                  "startColumn" : 26,
                  "endColumn" : 34
                }
              },
              "message" : {
                "text" : "clientIp : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 78,
                  "startColumn" : 9,
                  "endColumn" : 18
                }
              },
              "message" : {
                "text" : "logString [post update] : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 27
                }
              },
              "message" : {
                "text" : "logString : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 38
                }
              },
              "message" : {
                "text" : "toString(...)"
              }
            }
          } ]
        } ]
      }, {
        "threadFlows" : [ {
          "locations" : [ {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 15
                },
                "region" : {
                  "startLine" : 12,
                  "startColumn" : 18,
                  "endColumn" : 54
                }
              },
              "message" : {
                "text" : "getHeader(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 15
                },
                "region" : {
                  "startLine" : 23,
                  "startColumn" : 16,
                  "endColumn" : 18
                }
              },
              "message" : {
                "text" : "ip : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 76,
                  "startColumn" : 27,
                  "endColumn" : 52
                }
              },
              "message" : {
                "text" : "getIpAddr(...) : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 78,
                  "startColumn" : 26,
                  "endColumn" : 34
                }
              },
              "message" : {
                "text" : "clientIp : String"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 78,
                  "startColumn" : 9,
                  "endColumn" : 18
                }
              },
              "message" : {
                "text" : "logString [post update] : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 27
                }
              },
              "message" : {
                "text" : "logString : StringBuilder"
              }
            }
          }, {
            "location" : {
              "physicalLocation" : {
                "artifactLocation" : {
                  "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
                  "uriBaseId" : "%SRCROOT%",
                  "index" : 14
                },
                "region" : {
                  "startLine" : 90,
                  "startColumn" : 18,
                  "endColumn" : 38
                }
              },
              "message" : {
                "text" : "toString(...)"
              }
            }
          } ]
        } ]
      } ],
      "relatedLocations" : [ {
        "id" : 1,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 14
          },
          "region" : {
            "startLine" : 75,
            "startColumn" : 29,
            "endColumn" : 52
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      }, {
        "id" : 2,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/interceptor/CommonInterceptor.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 14
          },
          "region" : {
            "startLine" : 79,
            "startColumn" : 40,
            "endColumn" : 65
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      }, {
        "id" : 3,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 15
          },
          "region" : {
            "startLine" : 10,
            "startColumn" : 21,
            "endColumn" : 57
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      }, {
        "id" : 4,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 15
          },
          "region" : {
            "startLine" : 12,
            "startColumn" : 18,
            "endColumn" : 54
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      }, {
        "id" : 5,
        "physicalLocation" : {
          "artifactLocation" : {
            "uri" : "src/main/java/co/yiiu/pybbs/util/IpUtil.java",
            "uriBaseId" : "%SRCROOT%",
            "index" : 15
          },
          "region" : {
            "startLine" : 16,
            "startColumn" : 18,
            "endColumn" : 57
          }
        },
        "message" : {
          "text" : "user-provided value"
        }
      } ]
    } ],
    "columnKind" : "utf16CodeUnits",
    "properties" : {
      "metricResults" : [ {
        "rule" : {
          "id" : "java/summary/lines-of-code-kotlin",
          "index" : 99
        },
        "ruleId" : "java/summary/lines-of-code-kotlin",
        "ruleIndex" : 99,
        "value" : 0
      }, {
        "rule" : {
          "id" : "java/summary/lines-of-code",
          "index" : 100
        },
        "ruleId" : "java/summary/lines-of-code",
        "ruleIndex" : 100,
        "value" : 9709,
        "baseline" : 10021
      }, {
        "rule" : {
          "id" : "java/summary/lines-of-code-java",
          "index" : 101
        },
        "ruleId" : "java/summary/lines-of-code-java",
        "ruleIndex" : 101,
        "value" : 9709
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 1136,
        "message" : {
          "text" : "rt.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 212,
        "message" : {
          "text" : "mybatis-plus-core-3.0.7.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 117,
        "message" : {
          "text" : "spring-core-5.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 80,
        "message" : {
          "text" : "freemarker-2.3.29.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 74,
        "message" : {
          "text" : "spring-context-5.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 70,
        "message" : {
          "text" : "slf4j-api-1.7.29.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 66,
        "message" : {
          "text" : "jakarta.servlet-api-4.0.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 40,
        "message" : {
          "text" : "jsoup-1.11.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 39,
        "message" : {
          "text" : "aspectjweaver-1.9.5.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 39,
        "message" : {
          "text" : "elasticsearch-6.5.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 39,
        "message" : {
          "text" : "spring-web-5.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 33,
        "message" : {
          "text" : "shiro-core-1.4.0.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 27,
        "message" : {
          "text" : "JustAuth-1.15.5.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 25,
        "message" : {
          "text" : "spring-webmvc-5.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 15,
        "message" : {
          "text" : "aliyun-java-sdk-core-4.0.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 15,
        "message" : {
          "text" : "elasticsearch-rest-high-level-client-6.5.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 15,
        "message" : {
          "text" : "elasticsearch-x-content-6.5.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 12,
        "message" : {
          "text" : "HikariCP-3.4.1.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 11,
        "message" : {
          "text" : "jedis-3.0.0.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 10,
        "message" : {
          "text" : "commonmark-0.12.1.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 10,
        "message" : {
          "text" : "javax.mail-1.6.2.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 7,
        "message" : {
          "text" : "shiro-web-1.4.0.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 7,
        "message" : {
          "text" : "aliyun-sdk-oss-2.8.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 6,
        "message" : {
          "text" : "spring-beans-5.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 6,
        "message" : {
          "text" : "jboss-websocket-api_1.1_spec-1.1.4.Final.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 6,
        "message" : {
          "text" : "qiniu-java-sdk-7.4.0.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 6,
        "message" : {
          "text" : "poi-4.1.0.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 6,
        "message" : {
          "text" : "shiro-spring-1.4.0.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 6,
        "message" : {
          "text" : "flyway-core-5.2.1.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 5,
        "message" : {
          "text" : "jackson-databind-2.10.1.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 5,
        "message" : {
          "text" : "mybatis-plus-extension-3.0.7.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 4,
        "message" : {
          "text" : "commons-pool2-2.7.0.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 4,
        "message" : {
          "text" : "guava-27.0-jre.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 3,
        "message" : {
          "text" : "commons-text-1.9.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 3,
        "message" : {
          "text" : "spring-jcl-5.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 3,
        "message" : {
          "text" : "jackson-core-2.10.1.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 3,
        "message" : {
          "text" : "fastjson-1.2.71.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 2,
        "message" : {
          "text" : "mybatis-3.4.6.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 1,
        "message" : {
          "text" : "commonmark-ext-autolink-0.12.1.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 1,
        "message" : {
          "text" : "spring-boot-2.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 1,
        "message" : {
          "text" : "commonmark-ext-gfm-tables-0.12.1.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 1,
        "message" : {
          "text" : "elasticsearch-rest-client-6.5.3.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 1,
        "message" : {
          "text" : "spring-aop-5.2.2.RELEASE.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/external-libs",
          "index" : 102
        },
        "ruleId" : "java/telemetry/external-libs",
        "ruleIndex" : 102,
        "value" : 1,
        "message" : {
          "text" : "httpcore-4.4.12.jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 179,
        "message" : {
          "text" : "java.util.Map#get(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 72,
        "message" : {
          "text" : "org.springframework.ui.Model#addAttribute(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 66,
        "message" : {
          "text" : "java.util.Map#put(Object,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 50,
        "message" : {
          "text" : "java.lang.Integer#parseInt(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 44,
        "message" : {
          "text" : "java.lang.String#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 38,
        "message" : {
          "text" : "java.lang.String#format(String,Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 28,
        "message" : {
          "text" : "java.lang.String#equals(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 27,
        "message" : {
          "text" : "java.lang.Throwable#getMessage()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 26,
        "message" : {
          "text" : "java.io.OutputStream#write(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 25,
        "message" : {
          "text" : "java.lang.Object#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 23,
        "message" : {
          "text" : "java.lang.String#replace(CharSequence,CharSequence)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 23,
        "message" : {
          "text" : "org.slf4j.Logger#error(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 21,
        "message" : {
          "text" : "java.lang.StringBuilder#append(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 18,
        "message" : {
          "text" : "java.lang.String#length()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 16,
        "message" : {
          "text" : "java.util.Collection#stream()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 16,
        "message" : {
          "text" : "java.lang.Integer#equals(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 15,
        "message" : {
          "text" : "java.lang.IllegalArgumentException#IllegalArgumentException(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 14,
        "message" : {
          "text" : "java.lang.String#charAt(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 14,
        "message" : {
          "text" : "java.util.List#add(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 13,
        "message" : {
          "text" : "java.lang.String#equalsIgnoreCase(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 12,
        "message" : {
          "text" : "java.lang.StringBuilder#append(char)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 12,
        "message" : {
          "text" : "java.util.stream.Collectors#toList()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 12,
        "message" : {
          "text" : "javax.servlet.http.HttpSession#setAttribute(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 11,
        "message" : {
          "text" : "java.util.stream.Stream#map(Function)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 11,
        "message" : {
          "text" : "org.slf4j.Logger#info(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 10,
        "message" : {
          "text" : "java.util.Objects#requireNonNull(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 10,
        "message" : {
          "text" : "java.util.Random#nextInt(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 9,
        "message" : {
          "text" : "java.lang.Iterable#forEach(Consumer)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 9,
        "message" : {
          "text" : "java.util.List#get(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 8,
        "message" : {
          "text" : "javax.servlet.http.HttpServletRequest#getHeader(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 8,
        "message" : {
          "text" : "org.slf4j.Logger#error(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 8,
        "message" : {
          "text" : "java.lang.StringBuilder#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 7,
        "message" : {
          "text" : "java.util.stream.Stream#filter(Predicate)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 7,
        "message" : {
          "text" : "java.lang.String#split(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 6,
        "message" : {
          "text" : "java.util.Calendar#getTime()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 6,
        "message" : {
          "text" : "java.lang.Thread#start()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 6,
        "message" : {
          "text" : "java.util.Calendar#setTime(Date)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 6,
        "message" : {
          "text" : "java.util.List#size()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 6,
        "message" : {
          "text" : "java.lang.Thread#Thread(Runnable)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 6,
        "message" : {
          "text" : "java.util.Calendar#getInstance()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 5,
        "message" : {
          "text" : "org.springframework.util.StringUtils#collectionToCommaDelimitedString(Collection)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 5,
        "message" : {
          "text" : "java.lang.String#contains(CharSequence)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 5,
        "message" : {
          "text" : "java.util.Set#add(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "org.springframework.web.multipart.MultipartFile#getContentType()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.lang.String#replaceAll(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.lang.String#substring(int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.util.List#isEmpty()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.util.Iterator#next()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.util.Iterator#hasNext()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.util.Set#iterator()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.util.Calendar#add(int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.io.File#exists()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.io.File#File(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.io.OutputStream#flush()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.net.URL#getPath()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.net.URL#URL(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.util.regex.Pattern#matcher(CharSequence)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "java.util.regex.Pattern#compile(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 4,
        "message" : {
          "text" : "org.slf4j.Logger#info(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.util.Set#size()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.web.multipart.MultipartFile#getInputStream()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.lang.Enum#name()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.util.Collections#emptyList()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.lang.String#toCharArray()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "com.fasterxml.jackson.core.JsonProcessingException#getMessage()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.util.Map$Entry#getValue()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.util.stream.Collectors#toMap(Function,Function)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.io.ByteArrayOutputStream#toByteArray()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.io.ByteArrayOutputStream#write(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.util.StringUtils#commaDelimitedListToSet(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.lang.System#currentTimeMillis()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 3,
        "message" : {
          "text" : "java.util.Map#entrySet()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.io.OutputStream#write(byte\\[\\],int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#String(char\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.io.PrintWriter#write(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.Long#parseLong(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.text.SimpleDateFormat#SimpleDateFormat(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.CharSequence#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#getBytes(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Set#remove(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#getBytes()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Set#contains(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Arrays#asList(Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#lastIndexOf(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Calendar#set(int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Calendar#get(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.ArrayList#forEach(Consumer)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.List#contains(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Date#getTime()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Map$Entry#getKey()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.List#toArray(Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Optional#orElse(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.Properties#setProperty(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.util.List#clear()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.StringBuilder#append(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.StringBuffer#append(char)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.awt.Graphics2D#setComposite(Composite)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.io.File#mkdirs()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#toUpperCase()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api",
          "index" : 103
        },
        "ruleId" : "java/telemetry/supported-external-api",
        "ruleIndex" : 103,
        "value" : 2,
        "message" : {
          "text" : "java.io.InputStream#close()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 2,
        "message" : {
          "text" : "Number of diagnostics from CodeQL Java extractor with severity 2"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 24,
        "message" : {
          "text" : "Number of files with extension xml"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 71,
        "message" : {
          "text" : "Number of files with extension jar"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 6450,
        "message" : {
          "text" : "Number of files with extension class"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 181,
        "message" : {
          "text" : "Number of files with extension java"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 1,
        "message" : {
          "text" : "Annotation processors enabled: true"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 1,
        "message" : {
          "text" : "Used annotation processor: lombok.launch.AnnotationProcessorHider$AnnotationProcessor"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 1,
        "message" : {
          "text" : "Used annotation processor: lombok.launch.AnnotationProcessorHider$ClaimingProcessor"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 2,
        "message" : {
          "text" : "Total number of diagnostics from CodeQL Java extractor"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 1205,
        "message" : {
          "text" : "Number of lines of code with extension xml"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 9709,
        "message" : {
          "text" : "Number of lines of code with extension java"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 1205,
        "message" : {
          "text" : "Total number of lines with extension xml"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 14177,
        "message" : {
          "text" : "Total number of lines with extension java"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 6727,
        "message" : {
          "text" : "Number of files"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 15382,
        "message" : {
          "text" : "Total number of lines"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/extraction-information",
          "index" : 104
        },
        "ruleId" : "java/telemetry/extraction-information",
        "ruleIndex" : 104,
        "value" : 10914,
        "message" : {
          "text" : "Number of lines of code"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 179,
        "message" : {
          "text" : "java.util.Map#get(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 72,
        "message" : {
          "text" : "org.springframework.ui.Model#addAttribute(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 66,
        "message" : {
          "text" : "java.util.Map#put(Object,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 50,
        "message" : {
          "text" : "java.lang.Integer#parseInt(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 44,
        "message" : {
          "text" : "java.lang.String#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 38,
        "message" : {
          "text" : "java.lang.String#format(String,Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 28,
        "message" : {
          "text" : "java.lang.String#equals(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 27,
        "message" : {
          "text" : "java.lang.Throwable#getMessage()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 26,
        "message" : {
          "text" : "java.io.OutputStream#write(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 23,
        "message" : {
          "text" : "java.lang.String#replace(CharSequence,CharSequence)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 21,
        "message" : {
          "text" : "java.lang.StringBuilder#append(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 16,
        "message" : {
          "text" : "java.util.Collection#stream()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 15,
        "message" : {
          "text" : "java.lang.IllegalArgumentException#IllegalArgumentException(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 14,
        "message" : {
          "text" : "java.lang.String#charAt(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 14,
        "message" : {
          "text" : "java.util.List#add(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 12,
        "message" : {
          "text" : "java.lang.StringBuilder#append(char)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 11,
        "message" : {
          "text" : "java.util.stream.Stream#map(Function)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 10,
        "message" : {
          "text" : "java.util.Objects#requireNonNull(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 9,
        "message" : {
          "text" : "java.lang.Iterable#forEach(Consumer)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 9,
        "message" : {
          "text" : "java.util.List#get(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 8,
        "message" : {
          "text" : "java.lang.StringBuilder#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 7,
        "message" : {
          "text" : "java.util.stream.Stream#filter(Predicate)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 7,
        "message" : {
          "text" : "java.lang.String#split(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 6,
        "message" : {
          "text" : "java.lang.Thread#Thread(Runnable)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 5,
        "message" : {
          "text" : "org.springframework.util.StringUtils#collectionToCommaDelimitedString(Collection)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 5,
        "message" : {
          "text" : "java.util.Set#add(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.io.File#File(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.net.URL#getPath()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.net.URL#URL(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.util.regex.Pattern#matcher(CharSequence)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.lang.String#replaceAll(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.lang.String#substring(int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.util.Set#iterator()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.util.regex.Pattern#compile(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 4,
        "message" : {
          "text" : "java.util.Iterator#next()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.web.multipart.MultipartFile#getInputStream()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "java.lang.String#toCharArray()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "java.util.Map#entrySet()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "java.util.Map$Entry#getValue()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "java.util.stream.Collectors#toMap(Function,Function)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "com.fasterxml.jackson.core.JsonProcessingException#getMessage()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "java.io.ByteArrayOutputStream#toByteArray()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "java.io.ByteArrayOutputStream#write(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.util.StringUtils#commaDelimitedListToSet(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.StringBuffer#append(char)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.http.Cookie#Cookie(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#String(char\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.util.ArrayList#forEach(Consumer)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#getBytes(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#getBytes()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.util.Arrays#asList(Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "org.springframework.http.HttpEntity#HttpEntity(Object,MultiValueMap)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.util.Map$Entry#getKey()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.util.Optional#orElse(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.util.Properties#setProperty(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "org.springframework.util.MultiValueMap#add(Object,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.String#toUpperCase()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.awt.Graphics2D#setComposite(Composite)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.CharSequence#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.io.OutputStream#write(byte\\[\\],int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.io.PrintWriter#write(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.Long#parseLong(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.lang.StringBuilder#append(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.util.List#clear()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 2,
        "message" : {
          "text" : "java.util.List#toArray(Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.util.Map#keySet()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor#setSqlParser(ISqlParser)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.Integer#parseInt(String,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "com.fasterxml.jackson.databind.ObjectMapper#writeValueAsString(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "com.fasterxml.jackson.databind.ObjectMapper#readValue(String,JavaType)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "com.fasterxml.jackson.databind.ObjectMapper#readValue(String,Class)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.awt.Graphics#drawImage(Image,int,int,ImageObserver)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.Integer#toHexString(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.io.BufferedReader#readLine()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.io.BufferedReader#BufferedReader(Reader)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.AssertionError#AssertionError(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.Throwable#getLocalizedMessage()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.String#valueOf(char\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.io.InputStream#read(byte\\[\\],int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.io.InputStreamReader#InputStreamReader(InputStream,Charset)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.util.Map#forEach(BiConsumer)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.StringBuilder#StringBuilder(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "com.aliyuncs.exceptions.ClientException#getMessage()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.StringBuffer#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.String#valueOf(char)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.StringBuilder#append(long)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.io.UncheckedIOException#UncheckedIOException(IOException)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.math.BigInteger#toString(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.String#substring(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.util.Arrays#stream(Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.math.BigInteger#BigInteger(int,byte\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.util.Base64$Encoder#encodeToString(byte\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.net.InetSocketAddress#InetSocketAddress(String,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.net.URI#URI(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.String#toLowerCase()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.net.URL#toString()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.RuntimeException#RuntimeException(Throwable)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.Object#equals(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.util.List#add(int,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-taint",
          "index" : 105
        },
        "ruleId" : "java/telemetry/supported-external-api-taint",
        "ruleIndex" : 105,
        "value" : 1,
        "message" : {
          "text" : "java.lang.String#trim()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 23,
        "message" : {
          "text" : "org.slf4j.Logger#error(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 12,
        "message" : {
          "text" : "javax.servlet.http.HttpSession#setAttribute(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 11,
        "message" : {
          "text" : "org.slf4j.Logger#info(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 8,
        "message" : {
          "text" : "org.slf4j.Logger#error(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 7,
        "message" : {
          "text" : "java.lang.String#split(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 4,
        "message" : {
          "text" : "java.io.File#File(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 4,
        "message" : {
          "text" : "org.slf4j.Logger#info(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 4,
        "message" : {
          "text" : "java.util.regex.Pattern#matcher(CharSequence)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 4,
        "message" : {
          "text" : "java.util.regex.Pattern#compile(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 4,
        "message" : {
          "text" : "java.lang.String#replaceAll(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 2,
        "message" : {
          "text" : "java.util.regex.Matcher#matches()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 2,
        "message" : {
          "text" : "java.io.PrintWriter#write(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.http.HttpServletResponse#addCookie(Cookie)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 2,
        "message" : {
          "text" : "org.apache.commons.logging.Log#warn(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 2,
        "message" : {
          "text" : "org.springframework.web.client.RestTemplate#exchange(String,HttpMethod,HttpEntity,Class,Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "org.slf4j.Logger#error(String,Object,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "java.io.PrintStream#println(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "com.zaxxer.hikari.HikariConfig#setJdbcUrl(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "org.apache.shiro.mgt.AbstractRememberMeManager#setCipherKey(byte\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "java.io.File#createNewFile()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "java.io.FileOutputStream#FileOutputStream(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "java.io.FileInputStream#FileInputStream(File)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "java.sql.Statement#executeUpdate(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "java.sql.DriverManager#getConnection(String,String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sinks",
          "index" : 106
        },
        "ruleId" : "java/telemetry/supported-external-api-sinks",
        "ruleIndex" : 106,
        "value" : 1,
        "message" : {
          "text" : "java.io.PrintStream#println(boolean)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 97,
        "message" : {
          "text" : "org.springframework.util.StringUtils#isEmpty(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 52,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.conditions.interfaces.Compare#eq(Object,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 44,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.conditions.query.QueryWrapper#lambda()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 28,
        "message" : {
          "text" : "org.aspectj.lang.JoinPoint#getArgs()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 24,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#selectList(Wrapper)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 23,
        "message" : {
          "text" : "org.slf4j.LoggerFactory#getLogger(Class)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 19,
        "message" : {
          "text" : "java.lang.String#valueOf(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 15,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#insert(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 15,
        "message" : {
          "text" : "java.util.stream.Stream#collect(Collector)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 14,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#updateById(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 12,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#selectOne(Wrapper)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 12,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#delete(Wrapper)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "freemarker.template.TemplateDirectiveBody#render(Writer)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "freemarker.template.DefaultObjectWrapperBuilder#build()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "freemarker.template.DefaultObjectWrapper#wrap(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "org.aspectj.lang.ProceedingJoinPoint#proceed(Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "freemarker.template.DefaultObjectWrapperBuilder#DefaultObjectWrapperBuilder(Version)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "freemarker.template.Configuration#setSharedVariable(String,TemplateModel)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "freemarker.core.Environment#getOut()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 11,
        "message" : {
          "text" : "freemarker.core.Environment#setVariable(String,TemplateModel)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 10,
        "message" : {
          "text" : "org.apache.shiro.SecurityUtils#getSubject()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 9,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#deleteById(Serializable)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 9,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#selectById(Serializable)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 8,
        "message" : {
          "text" : "org.springframework.web.servlet.mvc.support.RedirectAttributes#addFlashAttribute(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 8,
        "message" : {
          "text" : "javax.servlet.http.HttpSession#getAttribute(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 8,
        "message" : {
          "text" : "org.jsoup.Jsoup#clean(String,Whitelist)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 7,
        "message" : {
          "text" : "java.awt.Graphics#setColor(Color)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 7,
        "message" : {
          "text" : "java.awt.Color#Color(int,int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 6,
        "message" : {
          "text" : "org.springframework.util.Assert#notNull(Object,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 6,
        "message" : {
          "text" : "org.springframework.web.context.request.RequestContextHolder#getRequestAttributes()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 6,
        "message" : {
          "text" : "org.elasticsearch.common.xcontent.XContentBuilder#field(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 6,
        "message" : {
          "text" : "java.lang.Throwable#printStackTrace()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 5,
        "message" : {
          "text" : "com.aliyuncs.CommonRequest#putQueryParameter(String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 5,
        "message" : {
          "text" : "org.jsoup.nodes.Element#addClass(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "java.security.MessageDigest#digest()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "org.jsoup.nodes.Element#append(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "org.springframework.web.context.request.ServletRequestAttributes#getRequest()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "java.awt.Font#getSize()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "java.security.MessageDigest#getInstance(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "java.awt.Graphics#fillRect(int,int,int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "java.awt.image.BufferedImage#BufferedImage(int,int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "javax.servlet.http.HttpServletRequest#getSession()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "org.elasticsearch.client.RestHighLevelClient#bulk(BulkRequest,RequestOptions)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "org.jsoup.nodes.Element#text(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 4,
        "message" : {
          "text" : "org.elasticsearch.common.xcontent.XContentBuilder#endObject()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "redis.clients.jedis.JedisPool#getResource()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "java.util.Random#nextBoolean()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "javax.websocket.RemoteEndpoint$Basic#sendObject(Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "javax.websocket.Session#getBasicRemote()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#selectPage(IPage,Wrapper)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.conditions.interfaces.Func#orderByDesc(Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.conditions.interfaces.Func#in(Object,Collection)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "com.zaxxer.hikari.HikariConfig#addDataSourceProperty(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "freemarker.template.Configuration#setSharedVariable(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "java.awt.image.BufferedImage#getGraphics()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "java.awt.image.BufferedImage#getHeight()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "java.awt.image.BufferedImage#getWidth()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "javax.servlet.ServletResponse#setContentType(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "javax.servlet.http.HttpServletResponse#sendRedirect(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "me.zhyd.oauth.model.AuthUser#getUsername()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.elasticsearch.common.xcontent.XContentBuilder#startObject(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.elasticsearch.client.RestHighLevelClient#indices()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.jsoup.safety.Whitelist#addAttributes(String,String\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.jsoup.safety.Whitelist#basic()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.jsoup.safety.Whitelist#none()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.http.ResponseEntity#getStatusCodeValue()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.util.Assert#isTrue(boolean,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.web.servlet.ModelAndView#addObject(String,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 3,
        "message" : {
          "text" : "redis.clients.jedis.Jedis#close()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.awt.Graphics#drawOval(int,int,int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.mail.internet.InternetAddress#InternetAddress(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.imageio.ImageIO#write(RenderedImage,String,OutputStream)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.security.SecureRandom#nextBytes(byte\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.security.MessageDigest#update(byte\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.toolkit.CollectionUtils#isNotEmpty(Collection)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.elasticsearch.action.bulk.BulkRequest#numberOfActions()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.elasticsearch.action.bulk.BulkRequest#requests()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.elasticsearch.action.delete.DeleteRequest#DeleteRequest(String,String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.elasticsearch.action.index.IndexRequest#source(Map)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.elasticsearch.action.index.IndexRequest#IndexRequest(String,String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.io.OutputStream#close()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.mapper.BaseMapper#update(Object,Wrapper)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.awt.Graphics2D#drawString(String,int,int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.awt.Graphics#setFont(Font)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.apache.shiro.web.util.WebUtils#getSavedRequest(ServletRequest)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.awt.AlphaComposite#getInstance(int,float)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.conditions.interfaces.Join#last(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "com.baomidou.mybatisplus.core.conditions.interfaces.Compare#gt(Object,Object)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "com.aliyun.oss.OSSClient#OSSClient(String,String,String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.http.Cookie#setPath(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.http.Cookie#setMaxAge(int)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.http.Cookie#setDomain(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.http.Cookie#setHttpOnly(boolean)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "java.lang.Math#round(float)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.http.HttpSession#removeAttribute(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.ServletResponse#getWriter()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "com.sun.management.OperatingSystemMXBean#getTotalPhysicalMemorySize()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "javax.servlet.ServletRequest#getAttribute(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.apache.shiro.subject.Subject#isPermitted(String\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/unsupported-external-api",
          "index" : 107
        },
        "ruleId" : "java/telemetry/unsupported-external-api",
        "ruleIndex" : 107,
        "value" : 2,
        "message" : {
          "text" : "org.apache.shiro.subject.Subject#getPrincipal()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 8,
        "message" : {
          "text" : "javax.servlet.http.HttpServletRequest#getHeader(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 4,
        "message" : {
          "text" : "org.springframework.web.multipart.MultipartFile#getContentType()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 3,
        "message" : {
          "text" : "org.springframework.web.multipart.MultipartFile#getInputStream()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 2,
        "message" : {
          "text" : "org.springframework.web.client.RestTemplate#exchange(String,HttpMethod,HttpEntity,Class,Object\\[\\])"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 1,
        "message" : {
          "text" : "javax.servlet.http.Cookie#getValue()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 1,
        "message" : {
          "text" : "javax.servlet.http.Cookie#getName()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 1,
        "message" : {
          "text" : "javax.servlet.http.HttpServletRequest#getRequestURI()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 1,
        "message" : {
          "text" : "java.lang.System#getProperty(String)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 1,
        "message" : {
          "text" : "java.io.FileInputStream#FileInputStream(File)"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 1,
        "message" : {
          "text" : "javax.servlet.ServletRequest#getParameterMap()"
        }
      }, {
        "rule" : {
          "id" : "java/telemetry/supported-external-api-sources",
          "index" : 108
        },
        "ruleId" : "java/telemetry/supported-external-api-sources",
        "ruleIndex" : 108,
        "value" : 1,
        "message" : {
          "text" : "javax.servlet.ServletRequest#getInputStream()"
        }
      } ],
      "semmle.formatSpecifier" : "sarifv2.1.0"
    }
  } ]
}